<!doctype html><html lang=en dir=ltr><head><script>(function(){const e=localStorage.getItem("theme");e&&document.documentElement.setAttribute("data-theme",e)})()</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Problem 1: Finite-Difference Solution
  #

We wish to discretize and solve the boundary-value problem
$$-\mu\frac{d^2u}{dx^2} + \beta\frac{du}{dx} = f(x),\quad x\in(0,1),\quad u(0)=u(1)=0$$
Or equivalently:
$$\begin{cases}
-\mu u&rsquo;&rsquo;(x) + \beta u&rsquo;(x) = f(x), & 0<x<1,\
u(0)=0,; u(1)=0.
\end{cases}$$
Where $\mu>0$ and $\beta$ is a constant (possibly negative), and $f\in C^0(0,1)$.

  1. Finite-Difference Discretization
  #

Divide $[0,1]$ into $N$ equal subintervals so that $\Delta x = \frac{1}{N}$. Let
$$x_j = j\Delta x,\quad j=0,1,2,\dots,N,$$"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://erisehe.github.io/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E4%B9%9D%E7%AB%A0/Exercise/"><meta property="og:site_name" content="学习笔记"><meta property="og:title" content="习题"><meta property="og:description" content="Problem 1: Finite-Difference Solution # We wish to discretize and solve the boundary-value problem
$$-\mu\frac{d^2u}{dx^2} + \beta\frac{du}{dx} = f(x),\quad x\in(0,1),\quad u(0)=u(1)=0$$
Or equivalently:
$$\begin{cases} -\mu u’’(x) + \beta u’(x) = f(x), & 0<x<1,\ u(0)=0,; u(1)=0. \end{cases}$$
Where $\mu>0$ and $\beta$ is a constant (possibly negative), and $f\in C^0(0,1)$.
1. Finite-Difference Discretization # Divide $[0,1]$ into $N$ equal subintervals so that $\Delta x = \frac{1}{N}$. Let
$$x_j = j\Delta x,\quad j=0,1,2,\dots,N,$$"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>习题 | 学习笔记</title>
<link rel=icon href=/notebook/topo.png><link rel=manifest href=/notebook/manifest.json><link rel=canonical href=https://erisehe.github.io/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E4%B9%9D%E7%AB%A0/Exercise/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/computer-modern-font@1.0.1/index.min.css><link rel=stylesheet href=/notebook/book.min.b3dea21ef7167d137d5c3d91df2df1ae008874baa457a6eb3fa1217af8da3509.css integrity="sha256-s96iHvcWfRN9XD2R3y3xrgCIdLqkV6brP6EhevjaNQk=" crossorigin=anonymous><script defer src=/notebook/fuse.min.js></script><script defer src=/notebook/en.search.min.c8deb4b664c5dc76fcfab3ab32f6540e98d42e4cc0f8adaa83e0d13af569ed59.js integrity="sha256-yN60tmTF3Hb8+rOrMvZUDpjULkzA+K2qg+DROvVp7Vk=" crossorigin=anonymous></script><script defer src=/notebook/sw.min.6d6d6cd5980f9f82f4b196d40b720c7ccec378cd7fb657b73ecdcb888b1dfac7.js integrity="sha256-bW1s1ZgPn4L0sZbUC3IMfM7DeM1/tle3Ps3LiIsd+sc=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class=container><div class=book-layout><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center justify-center" href=https://erisehe.github.io/notebook/><span>学习笔记</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><nav class=subject-menu><div class=subject-tabs><button class="subject-tab active" data-subject=数学>数学</button>
<button class=subject-tab data-subject=物理>物理</button></div><div class=subject-content><div class=subject-panel data-subject=数学><ul><li class=book-section-flat><span>点集拓扑学基础</span><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/%E6%8B%93%E6%89%91%E5%AD%A6/T-n%E5%88%86%E7%A6%BB%E5%85%AC%E7%90%86/>T N分离公理</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-2626c0c7c40e5ba289bbf96779ed7be9 class=toggle>
<label for=section-2626c0c7c40e5ba289bbf96779ed7be9 class="flex justify-between"><a role=button>微分几何</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/Differential-Geometry/1.-Overview-of-Differential-Geometry/>1. Overview of Differential Geometry</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/Differential-Geometry/2.-Lecture-2-ACTUAL/>2. Lecture 2 ( Actual)</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/Differential-Geometry/2.-Parametrized-Curves-and-Surfaces/>2. Parametrized Curves and Surfaces</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/Differential-Geometry/Tangent-Vectors-on-a-Surface/>Tangent Vectors on a Surface</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-6e5f2db787427bb8bccbb3c3eafa6cb6 class=toggle>
<label for=section-6e5f2db787427bb8bccbb3c3eafa6cb6 class="flex justify-between"><a role=button>概率机器学习</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/Probabilistic-Machine-Learning/2.-Autoregressive%E6%A8%A1%E5%9E%8B/>2. Autoregressive模型</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/Probabilistic-Machine-Learning/3.-Autoregressive%E6%A8%A1%E5%9E%8B-2/>3. Autoregressive模型 2</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-e9a29b9c49921437d6f50841fa0b7a2c class=toggle>
<label for=section-e9a29b9c49921437d6f50841fa0b7a2c class="flex justify-between"><a role=button>实分析 II</a></label><ul><li><input type=checkbox id=section-e63b59f3907b6b5c0ca40a1419c50fbe class=toggle>
<label for=section-e63b59f3907b6b5c0ca40a1419c50fbe class="flex justify-between"><a role=button>第六章 可微映射</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%85%AD%E7%AB%A0/6.4-Sufficient-Conditions-for-Differentiability/>6.4 可微分性的必要条件</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%85%AD%E7%AB%A0/6.6-Product-Rule-and-Gradients/>6.6 乘积法则与梯度</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%85%AD%E7%AB%A0/6.9-Taylor-Higher-Dimentions/>6.9 泰勒公式的高维形式</a></li></ul></li><li><input type=checkbox id=section-516b62a4eda22b0c44d32f044080ba6a class=toggle>
<label for=section-516b62a4eda22b0c44d32f044080ba6a class="flex justify-between"><a role=button>第七章 逆函数和隐函数定理</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E4%B8%83%E7%AB%A0/7.1-Inverse-Function-Theorem/>7.1 反函数定理</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E4%B8%83%E7%AB%A0/7.1.1-Inverse-FT-Proof/>7.1.1 反函数定理（证明）</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E4%B8%83%E7%AB%A0/7.2-Implicit-Function-Theorem/>7.2 隐函数定理</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E4%B8%83%E7%AB%A0/7.6-Morse-Lemma/>7.6 莫尔斯引理</a></li></ul></li><li><input type=checkbox id=section-7be78291145a12f96f25aeffb3b16554 class=toggle>
<label for=section-7be78291145a12f96f25aeffb3b16554 class="flex justify-between"><a role=button>第八章 度量理论</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%85%AB%E7%AB%A0/8.1-%E5%BA%A6%E9%87%8F%E7%90%86%E8%AE%BA/>8.1 度量理论</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%85%AB%E7%AB%A0/8.2-Criterion-for-Integrability/>8.2 Criterion for Integrability</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%85%AB%E7%AB%A0/8.3-Proof-of-Lebesgues-Theorem/>8.3 Proof of Lebesgue's Theorem</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%85%AB%E7%AB%A0/8.5-Improper-Integral/>8.5 不定积分</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%85%AB%E7%AB%A0/8.6-Lebesgue-Convergence-Theorem/>8.6 勒贝格收敛定理</a></li></ul></li><li><input type=checkbox id=section-56e664b694094194eea41293621edc8e class=toggle>
<label for=section-56e664b694094194eea41293621edc8e class="flex justify-between"><a role=button>第九章</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E4%B9%9D%E7%AB%A0/9.1-Computing-Integrals/>积分计算</a></li></ul></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-412-Real-Analysis-II/%E7%AC%AC%E5%8D%81%E7%AB%A0/10.1-Fourier-Analysis/>10.1 Fourier Analysis</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-358a11d2cd962ab8fdb9c9ba7faf532a class=toggle checked>
<label for=section-358a11d2cd962ab8fdb9c9ba7faf532a class="flex justify-between"><a role=button>偏微分方程</a></label><ul><li><input type=checkbox id=section-7097c8722aa477fcc3c6ccc5730510d5 class=toggle checked>
<label for=section-7097c8722aa477fcc3c6ccc5730510d5 class="flex justify-between"><a role=button>数值方法</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/01-Mid-Point-Method/>01 Mid Point Method</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/02-Three-Point-Backward-Differentiation-Formula/>02 Three Point Backward Differentiation Formula</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/03-Numerical-Solution-of-Ordinary-Differential-Equations/>常微分方程的数值解</a></li><li><input type=checkbox id=section-039c2604ef8d15d0cdd62911e85f20cb class=toggle>
<label for=section-039c2604ef8d15d0cdd62911e85f20cb class="flex justify-between"><a role=button>第四章 有限元分析</a></label><ul></ul></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E5%8D%81%E7%AB%A0/Finite-Element-Method/>Finite Element Method</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E5%8D%81%E7%AB%A0/Quiz-4/>Quiz 4</a></li><li><input type=checkbox id=section-24cf0d34881526d98bfa6ff3655d07cb class=toggle checked>
<label for=section-24cf0d34881526d98bfa6ff3655d07cb class="flex justify-between"><a role=button>第九章</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E4%B9%9D%E7%AB%A0/9.1-Boundary-Value-Problems/>9.1 边值问题的近似</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E4%B9%9D%E7%AB%A0/9.2-Finite-Difference/>9.2 有限差分法</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E4%B9%9D%E7%AB%A0/9.3-Advection-Diffusion-Equation/>9.3 对流-扩散方程</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E4%B9%9D%E7%AB%A0/9.4-2D-Problem/>9.4 4.1 二维（2D）偏微分方程问题</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/%E7%AC%AC%E4%B9%9D%E7%AB%A0/Exercise/ class=active>习题</a></li></ul></li></ul></li><li><input type=checkbox id=section-2e9d41360137a1ae6194db40069654e3 class=toggle>
<label for=section-2e9d41360137a1ae6194db40069654e3 class="flex justify-between"><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/Heat-Equation/>热方程</a></label><ul><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/Heat-Equation/Heat-Equation-Solution/>Heat Equation Solution</a></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/Heat-Equation/The-Fourier-Series/>傅立叶级数</a></li></ul></li><li><input type=checkbox id=section-7f42ebdf414be775241761c5b3262618 class=toggle>
<label for=section-7f42ebdf414be775241761c5b3262618 class="flex justify-between"><a role=button>波方程</a></label><ul></ul></li><li><input type=checkbox id=section-3cdad47fb9156c74a9aac21d7840334d class=toggle>
<label for=section-3cdad47fb9156c74a9aac21d7840334d class="flex justify-between"><a role=button>拉普拉斯方程</a></label><ul></ul></li></ul></li><li><a href=/notebook/docs/%E6%95%B0%E5%AD%A6/PS/>Ps</a></li></ul></div><div class="subject-panel hidden" data-subject=物理><ul></ul></div></div></nav><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".subject-tab"),s=document.querySelectorAll(".subject-panel");function t(t){e.forEach(e=>e.classList.remove("active")),s.forEach(e=>e.classList.add("hidden"));const n=document.querySelector(`.subject-tab[data-subject="${t}"]`);n&&n.classList.add("active");const o=document.querySelector(`.subject-panel[data-subject="${t}"]`);o&&o.classList.remove("hidden"),localStorage.setItem("activeSubjectTab",t)}const n=localStorage.getItem("activeSubjectTab");n&&t(n),e.forEach(e=>{e.addEventListener("click",function(){const n=e.getAttribute("data-subject");t(n)})})})</script><div class=after-menu-offset><ul><li><a href=/notebook/posts/>Blog</a></li><li><a href=https://github.com/EriseHe/notebook target=_blank rel=noopener>Github</a></li><li><a href=https://themes.gohugo.io/themes/hugo-book/ target=_blank rel=noopener>Hugo Themes</a></li></ul></div></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/notebook/svg/menu.svg class=book-icon alt=Menu></label><h3>习题</h3><label for=toc-control><img src=/notebook/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#problem-1-finite-difference-solution>Problem 1: Finite-Difference Solution</a><ul><li><a href=#1-finite-difference-discretization>1. Finite-Difference Discretization</a><ul><li><a href=#11-central-difference-scheme-for-the-interior-points>1.1 Central Difference Scheme (for the interior points)</a></li></ul></li><li><a href=#2-local-truncation-error>2. Local Truncation Error</a></li><li><a href=#3-matrix-form>3. Matrix Form</a></li></ul></li><li><a href=#endpmatrix>$$\begin{pmatrix}
2\alpha & -\alpha+\gamma & 0 & \cdots & 0\
-\alpha-\gamma & 2\alpha & -\alpha+\gamma & \cdots & 0\
0 & \ddots & \ddots & \ddots & \vdots\
\vdots & & -\alpha-\gamma & 2\alpha & -\alpha+\gamma\
0 & \cdots & 0 & -\alpha-\gamma & 2\alpha
\end{pmatrix}
\begin{pmatrix}
u_1\ u_2\ \vdots \ u_{N-2}\ u_{N-1}
\end{pmatrix}</a><ul><li><a href=#4-quality-of-the-solution-vs-betamu>4. Quality of the Solution vs. $\beta/\mu$</a></li><li><a href=#5-upwind-method-first-order-for-beta0>5. Upwind Method (First Order) for $\beta&lt;0$</a><ul><li><a href=#51-no-spurious-oscillations>5.1 No Spurious Oscillations</a></li></ul></li><li><a href=#6-summary>6. Summary</a></li></ul></li><li><a href=#problem-2>Problem 2</a><ul><li><a href=#1-derivation-of-the-laxwendroff-scheme>1) Derivation of the Lax–Wendroff Scheme</a><ul><li><a href=#discretizing-the-spatial-derivatives>Discretizing the spatial derivatives</a></li></ul></li><li><a href=#2-the-cfl-stability-condition>2) The CFL Stability Condition</a></li><li><a href=#3-motivation>3) Motivation</a></li></ul></li><li><a href=#u_in1>Lax–Wendroff has the form
$$u_{i}^{n+1}</a><ul><li><a href=#u_in>u_{i}^{n}</a></li></ul></li><li><a href=#problem-3>Problem 3</a><ul><li><a href=#1-the-cranknicolson-discretization>1. The Crank–Nicolson Discretization</a><ul><li><a href=#boundary-conditions>Boundary Conditions</a></li><li><a href=#summary-of-the-cn-update>Summary of the CN Update</a></li></ul></li><li><a href=#2-properties-stability--accuracy>2. Properties: Stability & Accuracy</a></li><li><a href=#3-bonus-discontinuous-initial-condition>3. BONUS: Discontinuous Initial Condition</a></li></ul></li><li><a href=#problem-4-求解二维拉普拉斯方程的五点差分格式>Problem 4 求解二维拉普拉斯方程的五点差分格式</a><ul><li><a href=#1-建立网格>1. 建立网格</a></li><li><a href=#2-五点差分格式>2. 五点差分格式</a></li><li><a href=#3-精度阶次>3. 精度阶次</a></li><li><a href=#4-最终形成的线性方程组>4. 最终形成的线性方程组</a></li><li><a href=#5-总结>5. 总结</a></li></ul></li></ul></nav></aside></header><article class=book-article><h1 style="text-align:center;font-family:computer modern,cmu serif,serif">习题</h1><div class="markdown posts" x-data><h1 id=problem-1-finite-difference-solution>Problem 1: Finite-Difference Solution
<a class=anchor href=#problem-1-finite-difference-solution>#</a></h1><p data-raw='We wish to discretize and solve the boundary-value problem'>We wish to discretize and solve the boundary-value problem</p><p data-raw='$$-\mu\frac{d^2u}{dx^2} + \beta\frac{du}{dx} = f(x),\quad x\in(0,1),\quad u(0)=u(1)=0$$'>$$-\mu\frac{d^2u}{dx^2} + \beta\frac{du}{dx} = f(x),\quad x\in(0,1),\quad u(0)=u(1)=0$$</p><p data-raw='Or equivalently:'>Or equivalently:</p><p data-raw='$$\begin{cases}
-\mu u&rsquo;&rsquo;(x) + \beta u&rsquo;(x) = f(x), & 0<x<1,\
u(0)=0,; u(1)=0.
\end{cases}$$'>$$\begin{cases}
-\mu u&rsquo;&rsquo;(x) + \beta u&rsquo;(x) = f(x), & 0&lt;x&lt;1,\
u(0)=0,; u(1)=0.
\end{cases}$$</p><p data-raw='Where $\mu>0$ and $\beta$ is a constant (possibly negative), and $f\in C^0(0,1)$.'>Where $\mu>0$ and $\beta$ is a constant (possibly negative), and $f\in C^0(0,1)$.</p><h2 id=1-finite-difference-discretization>1. Finite-Difference Discretization
<a class=anchor href=#1-finite-difference-discretization>#</a></h2><p data-raw='Divide $[0,1]$ into $N$ equal subintervals so that $\Delta x = \frac{1}{N}$. Let'>Divide $[0,1]$ into $N$ equal subintervals so that $\Delta x = \frac{1}{N}$. Let</p><p data-raw='$$x_j = j\Delta x,\quad j=0,1,2,\dots,N,$$'>$$x_j = j\Delta x,\quad j=0,1,2,\dots,N,$$</p><p data-raw='so that $x_0=0$ and $x_N=1$. We approximate $u(x_j)\approx u_j$. The boundary conditions become $u_0=0$ and $u_N=0$.'>so that $x_0=0$ and $x_N=1$. We approximate $u(x_j)\approx u_j$. The boundary conditions become $u_0=0$ and $u_N=0$.</p><h3 id=11-central-difference-scheme-for-the-interior-points>1.1 Central Difference Scheme (for the interior points)
<a class=anchor href=#11-central-difference-scheme-for-the-interior-points>#</a></h3><p data-raw='A standard <strong>centered second-difference</strong> for $u&rsquo;&rsquo;(x)$ at $x_j$ is:'>A standard <strong>centered second-difference</strong> for $u&rsquo;&rsquo;(x)$ at $x_j$ is:</p><p data-raw='$$u&rsquo;&rsquo;(x_j) \approx \frac{u_{j+1} - 2u_j + u_{j-1}}{(\Delta x)^2}.$$'>$$u&rsquo;&rsquo;(x_j) \approx \frac{u_{j+1} - 2u_j + u_{j-1}}{(\Delta x)^2}.$$</p><p data-raw='A standard <strong>centered first-difference</strong> for $u&rsquo;(x)$ at $x_j$ is:'>A standard <strong>centered first-difference</strong> for $u&rsquo;(x)$ at $x_j$ is:</p><p data-raw='$$u&rsquo;(x_j) \approx \frac{u_{j+1} - u_{j-1}}{2\Delta x}.$$'>$$u&rsquo;(x_j) \approx \frac{u_{j+1} - u_{j-1}}{2\Delta x}.$$</p><p data-raw='Hence, the PDE $-\mu u&rsquo;&rsquo;(x) + \beta u&rsquo;(x)=f(x)$ becomes for $j=1,\dots,N-1$:'>Hence, the PDE $-\mu u&rsquo;&rsquo;(x) + \beta u&rsquo;(x)=f(x)$ becomes for $j=1,\dots,N-1$:</p><p data-raw='$$-\mu\frac{u_{j+1} - 2u_j + u_{j-1}}{(\Delta x)^2} + \beta\frac{u_{j+1} - u_{j-1}}{2\Delta x} = f(x_j).$$'>$$-\mu\frac{u_{j+1} - 2u_j + u_{j-1}}{(\Delta x)^2} + \beta\frac{u_{j+1} - u_{j-1}}{2\Delta x} = f(x_j).$$</p><p data-raw='We impose $u_0 = 0$ and $u_N=0$.'>We impose $u_0 = 0$ and $u_N=0$.</p><h2 id=2-local-truncation-error>2. Local Truncation Error
<a class=anchor href=#2-local-truncation-error>#</a></h2><ul><li>The second-order central difference for $u&rsquo;&rsquo;$ is $O((\Delta x)^2)$ accurate.</li><li>The central difference for $u&rsquo;$ is also $O((\Delta x)^2)$ accurate.</li></ul><p data-raw='Hence the <strong>local truncation error</strong> of the combined scheme is $O((\Delta x)^2)$.'>Hence the <strong>local truncation error</strong> of the combined scheme is $O((\Delta x)^2)$.</p><h2 id=3-matrix-form>3. Matrix Form
<a class=anchor href=#3-matrix-form>#</a></h2><p data-raw='Collect unknowns $u_1,u_2,\dots,u_{N-1}$ into a vector $\mathbf{u}=(u_1,\dots,u_{N-1})^T$. The boundary values $u_0=0$ and $u_N=0$ are known.'>Collect unknowns $u_1,u_2,\dots,u_{N-1}$ into a vector $\mathbf{u}=(u_1,\dots,u_{N-1})^T$. The boundary values $u_0=0$ and $u_N=0$ are known.</p><p data-raw='Rewrite the finite-difference equation for an interior index $j$:'>Rewrite the finite-difference equation for an interior index $j$:</p><p data-raw='$$-\mu\frac{u_{j+1} - 2u_j + u_{j-1}}{(\Delta x)^2} + \beta\frac{u_{j+1} - u_{j-1}}{2\Delta x} = f(x_j).$$'>$$-\mu\frac{u_{j+1} - 2u_j + u_{j-1}}{(\Delta x)^2} + \beta\frac{u_{j+1} - u_{j-1}}{2\Delta x} = f(x_j).$$</p><p data-raw='We can factor out coefficients:'>We can factor out coefficients:</p><ul><li>Let $\alpha \equiv \frac{\mu}{(\Delta x)^2}$.</li><li>Let $\gamma \equiv \frac{\beta}{2\Delta x}$.</li></ul><p data-raw='Then the coefficient of $u_j$ is $2\alpha$, the coefficient of $u_{j+1}$ is $-\alpha + \gamma$, and the coefficient of $u_{j-1}$ is $-\alpha - \gamma$. Thus, in matrix form:'>Then the coefficient of $u_j$ is $2\alpha$, the coefficient of $u_{j+1}$ is $-\alpha + \gamma$, and the coefficient of $u_{j-1}$ is $-\alpha - \gamma$. Thus, in matrix form:</p><h1 id=endpmatrix>$$\begin{pmatrix}
2\alpha & -\alpha+\gamma & 0 & \cdots & 0\
-\alpha-\gamma & 2\alpha & -\alpha+\gamma & \cdots & 0\
0 & \ddots & \ddots & \ddots & \vdots\
\vdots & & -\alpha-\gamma & 2\alpha & -\alpha+\gamma\
0 & \cdots & 0 & -\alpha-\gamma & 2\alpha
\end{pmatrix}
\begin{pmatrix}
u_1\ u_2\ \vdots \ u_{N-2}\ u_{N-1}
\end{pmatrix}
<a class=anchor href=#endpmatrix>#</a></h1><p data-raw='\begin{pmatrix}
f(x_1)\ f(x_2)\ \vdots \ f(x_{N-2})\ f(x_{N-1})
\end{pmatrix}.$$'>\begin{pmatrix}
f(x_1)\ f(x_2)\ \vdots \ f(x_{N-2})\ f(x_{N-1})
\end{pmatrix}.$$</p><p data-raw='This is a tridiagonal linear system, solvable by standard methods (e.g., Thomas algorithm).'>This is a tridiagonal linear system, solvable by standard methods (e.g., Thomas algorithm).</p><h2 id=4-quality-of-the-solution-vs-betamu>4. Quality of the Solution vs. $\beta/\mu$
<a class=anchor href=#4-quality-of-the-solution-vs-betamu>#</a></h2><p data-raw='The ratio $\frac{\beta}{\mu}$ often plays the role of a <strong>Péclet-type number</strong> in advection-diffusion problems.'>The ratio $\frac{\beta}{\mu}$ often plays the role of a <strong>Péclet-type number</strong> in advection-diffusion problems.</p><ul><li>If $\frac{\beta}{\mu}$ is small (diffusion-dominated), the solution is usually smooth and well-behaved under central differencing.</li><li>If $\frac{\beta}{\mu}$ is large (advection-dominated), pure central differences may produce <strong>spurious oscillations</strong> unless $\Delta x$ is refined or <strong>upwinding</strong> techniques are used to stabilize the discrete solution.</li></ul><h2 id=5-upwind-method-first-order-for-beta0>5. Upwind Method (First Order) for $\beta&lt;0$
<a class=anchor href=#5-upwind-method-first-order-for-beta0>#</a></h2><p data-raw='When $\beta<0$, the &ldquo;flow&rdquo; is from right to left, so an <strong>upwind difference</strong> for the first derivative $\beta u&rsquo;(x)$ uses values on the &ldquo;right&rdquo; side at each $j$. Concretely, for $\beta<0$, we replace:'>When $\beta&lt;0$, the &ldquo;flow&rdquo; is from right to left, so an <strong>upwind difference</strong> for the first derivative $\beta u&rsquo;(x)$ uses values on the &ldquo;right&rdquo; side at each $j$. Concretely, for $\beta&lt;0$, we replace:</p><p data-raw='$$u&rsquo;(x_j) \approx \frac{u_{j+1} - u_j}{\Delta x} \quad \text{(a &ldquo;backward&rdquo; upwind if flow is leftward)}.$$'>$$u&rsquo;(x_j) \approx \frac{u_{j+1} - u_j}{\Delta x} \quad \text{(a &ldquo;backward&rdquo; upwind if flow is leftward)}.$$</p><p data-raw='Hence, the difference equation becomes:'>Hence, the difference equation becomes:</p><p data-raw='$$-\mu\frac{u_{j+1} - 2u_j + u_{j-1}}{(\Delta x)^2} + \beta\frac{u_{j+1} - u_j}{\Delta x} = f(x_j), \quad j=1,\dots,N-1.$$'>$$-\mu\frac{u_{j+1} - 2u_j + u_{j-1}}{(\Delta x)^2} + \beta\frac{u_{j+1} - u_j}{\Delta x} = f(x_j), \quad j=1,\dots,N-1.$$</p><p data-raw='(This replaces the central difference in the advective term by a one-sided upwind difference.)'>(This replaces the central difference in the advective term by a one-sided upwind difference.)</p><h3 id=51-no-spurious-oscillations>5.1 No Spurious Oscillations
<a class=anchor href=#51-no-spurious-oscillations>#</a></h3><p data-raw='The first-order upwind scheme for linear advection-diffusion is known to be <strong>monotone</strong> for any $\Delta x>0$ when $\beta<0$ (or, more generally, for any sign of $\beta$ if we choose the correct upwind direction). Monotonicity prevents nonphysical oscillations. In short:'>The first-order upwind scheme for linear advection-diffusion is known to be <strong>monotone</strong> for any $\Delta x>0$ when $\beta&lt;0$ (or, more generally, for any sign of $\beta$ if we choose the correct upwind direction). Monotonicity prevents nonphysical oscillations. In short:</p><ul><li>Central difference can oscillate if $|\beta|$ is large relative to $\mu$.</li><li>Upwind difference sacrifices some accuracy (only first order in $\Delta x$ for the advective term) but <strong>remains stable</strong> and <strong>nonoscillatory</strong> for any step size $\Delta x$.</li></ul><p data-raw='Thus, with $\beta<0$, the upwind approach $u&rsquo;(x_j)\approx (u_{j+1}-u_j)/\Delta x$ ensures a stable, physically plausible solution without oscillations.'>Thus, with $\beta&lt;0$, the upwind approach $u&rsquo;(x_j)\approx (u_{j+1}-u_j)/\Delta x$ ensures a stable, physically plausible solution without oscillations.</p><h2 id=6-summary>6. Summary
<a class=anchor href=#6-summary>#</a></h2><ol><li><p data-raw='<strong>Equation & Discretization</strong><br>
$$-\mu u&rsquo;&rsquo; + \beta u&rsquo; = f(x), \quad u(0)=u(1)=0 \longrightarrow \begin{cases}
-\mu\frac{u_{j+1}-2u_j+u_{j-1}}{(\Delta x)^2} +\beta\frac{u_{j+1}-u_{j-1}}{2\Delta x} = f(x_j),\
u_0=0,;u_N=0.
\end{cases}$$'><strong>Equation & Discretization</strong><br>$$-\mu u&rsquo;&rsquo; + \beta u&rsquo; = f(x), \quad u(0)=u(1)=0 \longrightarrow \begin{cases}
-\mu\frac{u_{j+1}-2u_j+u_{j-1}}{(\Delta x)^2} +\beta\frac{u_{j+1}-u_{j-1}}{2\Delta x} = f(x_j),\
u_0=0,;u_N=0.
\end{cases}$$</p></li><li><p data-raw='<strong>Local Truncation Error</strong> is $O((\Delta x)^2)$ for the centered scheme.'><strong>Local Truncation Error</strong> is $O((\Delta x)^2)$ for the centered scheme.</p></li><li><p data-raw='<strong>Matrix Form</strong>: A standard tridiagonal system with bands $-\alpha\mp \gamma$, $2\alpha$, $-\alpha\pm \gamma$.'><strong>Matrix Form</strong>: A standard tridiagonal system with bands $-\alpha\mp \gamma$, $2\alpha$, $-\alpha\pm \gamma$.</p></li><li><p data-raw='<strong>Effect of $\beta/\mu$</strong>: If $|\beta|$ is large relative to $\mu$, central differences can produce oscillatory solutions; upwind methods help.'><strong>Effect of $\beta/\mu$</strong>: If $|\beta|$ is large relative to $\mu$, central differences can produce oscillatory solutions; upwind methods help.</p></li><li><p data-raw='<strong>Upwind Method</strong> (for $\beta<0$):
$$-\mu\frac{u_{j+1}-2u_j+u_{j-1}}{(\Delta x)^2} + \beta\frac{u_{j+1}-u_j}{\Delta x} = f(x_j)$$
prevents oscillations for any $\Delta x$.'><strong>Upwind Method</strong> (for $\beta&lt;0$):
$$-\mu\frac{u_{j+1}-2u_j+u_{j-1}}{(\Delta x)^2} + \beta\frac{u_{j+1}-u_j}{\Delta x} = f(x_j)$$
prevents oscillations for any $\Delta x$.</p></li></ol><h1 id=problem-2>Problem 2
<a class=anchor href=#problem-2>#</a></h1><p data-raw='<strong>Solution Outline</strong>'><strong>Solution Outline</strong></p><p data-raw='We have the linear advection equation'>We have the linear advection equation</p><p data-raw='$$\frac{\partial u}{\partial t} ;+; a,\frac{\partial u}{\partial x} ;=; 0,\quad x\in \mathbb{R},;t>0,$$
with initial condition $u(x,0) = u_0(x)$. We wish to:'>$$\frac{\partial u}{\partial t} ;+; a,\frac{\partial u}{\partial x} ;=; 0,\quad x\in \mathbb{R},;t>0,$$
with initial condition $u(x,0) = u_0(x)$. We wish to:</p><ol><li><strong>Derive the Lax–Wendroff scheme</strong> for this PDE.</li><li><strong>Determine the CFL condition</strong> for stability, i.e.\ find the condition on
$\displaystyle \frac{|a|\Delta t}{\Delta x}$.</li></ol><hr><h2 id=1-derivation-of-the-laxwendroff-scheme>1) Derivation of the Lax–Wendroff Scheme
<a class=anchor href=#1-derivation-of-the-laxwendroff-scheme>#</a></h2><p data-raw='A succinct way to derive Lax–Wendroff is via a <strong>second-order Taylor expansion</strong> in time about $t^n$:'>A succinct way to derive Lax–Wendroff is via a <strong>second-order Taylor expansion</strong> in time about $t^n$:</p><p data-raw='$$u^{n+1}<em>i ;\approx; u(x_i,,t_n + \Delta t)
;=;
u(x_i,t_n)
;+;\Delta t,\frac{\partial u}{\partial t}
;+;\tfrac{(\Delta t)^2}{2},\frac{\partial^2 u}{\partial t^2};\bigg|</em>{(x_i,t_n)}.$$'>$$u^{n+1}<em>i ;\approx; u(x_i,,t_n + \Delta t)
;=;
u(x_i,t_n)
;+;\Delta t,\frac{\partial u}{\partial t}
;+;\tfrac{(\Delta t)^2}{2},\frac{\partial^2 u}{\partial t^2};\bigg|</em>{(x_i,t_n)}.$$</p><p data-raw='From the PDE $\partial_t u = -,a,\partial_x u$, we can replace time-derivatives by spatial derivatives:'>From the PDE $\partial_t u = -,a,\partial_x u$, we can replace time-derivatives by spatial derivatives:</p><ul><li><p data-raw='First derivative in time:
$$\frac{\partial u}{\partial t}
;=;
-,a,\frac{\partial u}{\partial x}.$$'>First derivative in time:
$$\frac{\partial u}{\partial t}
;=;
-,a,\frac{\partial u}{\partial x}.$$</p></li><li><p data-raw='Second derivative in time:
$$\frac{\partial^2 u}{\partial t^2}
;=;
\frac{\partial}{\partial t}\Bigl(-,a,\frac{\partial u}{\partial x}\Bigr)
;=;
-,a,\frac{\partial}{\partial x}\Bigl(\frac{\partial u}{\partial t}\Bigr)
;=;
-,a,\frac{\partial}{\partial x}\Bigl(-,a,\frac{\partial u}{\partial x}\Bigr)
;=;
a^2,\frac{\partial^2 u}{\partial x^2}.$$'>Second derivative in time:
$$\frac{\partial^2 u}{\partial t^2}
;=;
\frac{\partial}{\partial t}\Bigl(-,a,\frac{\partial u}{\partial x}\Bigr)
;=;
-,a,\frac{\partial}{\partial x}\Bigl(\frac{\partial u}{\partial t}\Bigr)
;=;
-,a,\frac{\partial}{\partial x}\Bigl(-,a,\frac{\partial u}{\partial x}\Bigr)
;=;
a^2,\frac{\partial^2 u}{\partial x^2}.$$</p></li></ul><p data-raw=Hence,>Hence,</p><p data-raw='$$u^{n+1}_i
;\approx;
u^{n}<em>i
;-;
a,\Delta t ,\frac{\partial u}{\partial x}
;+;
\frac{a^2(\Delta t)^2}{2},\frac{\partial^2 u}{\partial x^2}
;\Bigg|</em>{(x_i,t_n)}.$$'>$$u^{n+1}_i
;\approx;
u^{n}<em>i
;-;
a,\Delta t ,\frac{\partial u}{\partial x}
;+;
\frac{a^2(\Delta t)^2}{2},\frac{\partial^2 u}{\partial x^2}
;\Bigg|</em>{(x_i,t_n)}.$$</p><h3 id=discretizing-the-spatial-derivatives>Discretizing the spatial derivatives
<a class=anchor href=#discretizing-the-spatial-derivatives>#</a></h3><p data-raw='We replace the first and second spatial derivatives by standard centered finite differences:'>We replace the first and second spatial derivatives by standard centered finite differences:</p><p data-raw='$$\frac{\partial u}{\partial x}\bigg|<em>{x_i}
\approx
\frac{u</em>{i+1}^n - u_{i-1}^n}{2,\Delta x},
\qquad
\frac{\partial^2 u}{\partial x^2}\bigg|<em>{x_i}
\approx
\frac{u</em>{i+1}^n - 2,u_i^n + u_{i-1}^n}{(\Delta x)^2}.$$'>$$\frac{\partial u}{\partial x}\bigg|<em>{x_i}
\approx
\frac{u</em>{i+1}^n - u_{i-1}^n}{2,\Delta x},
\qquad
\frac{\partial^2 u}{\partial x^2}\bigg|<em>{x_i}
\approx
\frac{u</em>{i+1}^n - 2,u_i^n + u_{i-1}^n}{(\Delta x)^2}.$$</p><p data-raw='Putting this all together:'>Putting this all together:</p><p data-raw='$$u_{i}^{n+1}
;=;
u_{i}^{n}
;-;
a,\Delta t ,\frac{u_{i+1}^{n} - u_{i-1}^{n}}{2,\Delta x}
;+;
\frac{a^2,(\Delta t)^2}{2},
\frac{u_{i+1}^{n} - 2,u_{i}^{n} + u_{i-1}^{n}}{(\Delta x)^2}.$$'>$$u_{i}^{n+1}
;=;
u_{i}^{n}
;-;
a,\Delta t ,\frac{u_{i+1}^{n} - u_{i-1}^{n}}{2,\Delta x}
;+;
\frac{a^2,(\Delta t)^2}{2},
\frac{u_{i+1}^{n} - 2,u_{i}^{n} + u_{i-1}^{n}}{(\Delta x)^2}.$$</p><p data-raw='It is common to set
$\displaystyle \nu ;=;\frac{a,\Delta t}{\Delta x}$. Then the scheme reads'>It is common to set
$\displaystyle \nu ;=;\frac{a,\Delta t}{\Delta x}$. Then the scheme reads</p><p data-raw='$$\boxed{
u_{i}^{n+1}
;=;
u_{i}^{n}
;-;\frac{\nu}{2},\bigl(u_{i+1}^{n} - u_{i-1}^{n}\bigr)
;+;\frac{\nu^{2}}{2},
\bigl(u_{i+1}^{n} ;-;2,u_{i}^{n} ;+;u_{i-1}^{n}\bigr).
}$$'>$$\boxed{
u_{i}^{n+1}
;=;
u_{i}^{n}
;-;\frac{\nu}{2},\bigl(u_{i+1}^{n} - u_{i-1}^{n}\bigr)
;+;\frac{\nu^{2}}{2},
\bigl(u_{i+1}^{n} ;-;2,u_{i}^{n} ;+;u_{i-1}^{n}\bigr).
}$$</p><p data-raw='This is the <strong>Lax–Wendroff scheme</strong> for the linear advection equation.'>This is the <strong>Lax–Wendroff scheme</strong> for the linear advection equation.</p><hr><h2 id=2-the-cfl-stability-condition>2) The CFL Stability Condition
<a class=anchor href=#2-the-cfl-stability-condition>#</a></h2><p data-raw='A standard von Neumann (Fourier) stability analysis, or the usual Lax–Richtmyer theory for hyperbolic PDEs, shows that <strong>Lax–Wendroff is stable if and only if</strong> the Courant number satisfies'>A standard von Neumann (Fourier) stability analysis, or the usual Lax–Richtmyer theory for hyperbolic PDEs, shows that <strong>Lax–Wendroff is stable if and only if</strong> the Courant number satisfies</p><p data-raw='$$\bigl|,\nu,\bigr|
;=;
\biggl|\frac{a,\Delta t}{\Delta x}\biggr|
;\le;
1.$$'>$$\bigl|,\nu,\bigr|
;=;
\biggl|\frac{a,\Delta t}{\Delta x}\biggr|
;\le;
1.$$</p><p data-raw='Therefore among the multiple-choice options, the correct condition is'>Therefore among the multiple-choice options, the correct condition is</p><p data-raw='$$\boxed{;; \bigl|\tfrac{a,\Delta t}{\Delta x}\bigr| ;\le; 1.}$$'>$$\boxed{;; \bigl|\tfrac{a,\Delta t}{\Delta x}\bigr| ;\le; 1.}$$</p><hr><h2 id=3-motivation>3) Motivation
<a class=anchor href=#3-motivation>#</a></h2><ul><li><p data-raw='<strong>Domain of dependence argument.</strong> For the PDE
$\partial_t u + a,\partial_x u = 0,$
characteristics travel with speed $a$. Numerically, we must ensure that information from these characteristics is captured on the grid from one time step to the next; that is the essence of the CFL condition. If $|a|\Delta t > \Delta x$, the method “jumps over” grid cells and fails to remain stable.'><strong>Domain of dependence argument.</strong> For the PDE
$\partial_t u + a,\partial_x u = 0,$
characteristics travel with speed $a$. Numerically, we must ensure that information from these characteristics is captured on the grid from one time step to the next; that is the essence of the CFL condition. If $|a|\Delta t > \Delta x$, the method “jumps over” grid cells and fails to remain stable.</p></li><li><p data-raw='<strong>Von Neumann analysis.</strong> Substituting $u_i^n = \lambda^n e^{ikx_i}$ into the scheme shows that the amplification factor $|\lambda|$ is $\le 1$ if and only if $\bigl|\frac{a\Delta t}{\Delta x}\bigr|\le 1.$'><strong>Von Neumann analysis.</strong> Substituting $u_i^n = \lambda^n e^{ikx_i}$ into the scheme shows that the amplification factor $|\lambda|$ is $\le 1$ if and only if $\bigl|\frac{a\Delta t}{\Delta x}\bigr|\le 1.$</p></li></ul><p data-raw='Hence the short answer is:'>Hence the short answer is:</p><ol><li><h1 id=u_in1>Lax–Wendroff has the form
$$u_{i}^{n+1}
<a class=anchor href=#u_in1>#</a></h1><h2 id=u_in>u_{i}^{n}
<a class=anchor href=#u_in>#</a></h2>\frac{\nu}{2},(u_{i+1}^{n} - u_{i-1}^{n})
+
\frac{\nu^{2}}{2},(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}),$$</li><li>The method is stable <strong>if and only if</strong> $\displaystyle \bigl|\frac{a\Delta t}{\Delta x}\bigr|\le 1.$</li><li>This condition is exactly the usual CFL requirement ensuring the numerical domain of dependence covers the PDE’s domain of dependence.</li></ol><h1 id=problem-3>Problem 3
<a class=anchor href=#problem-3>#</a></h1><p data-raw='Below is a fairly detailed derivation and discussion of the Crank–Nicolson (CN) method (the $\theta$-method with $\theta = \tfrac12$) for the heat equation'>Below is a fairly detailed derivation and discussion of the Crank–Nicolson (CN) method (the $\theta$-method with $\theta = \tfrac12$) for the heat equation</p><p data-raw='$$\frac{\partial u}{\partial t};-;\frac{\partial^2 u}{\partial x^2};=;f,
\quad x\in(0,1),;t>0,
\quad
u(0,t) ;=;u(1,t);=;0,
\quad
u(x,0);=;u_0(x).$$'>$$\frac{\partial u}{\partial t};-;\frac{\partial^2 u}{\partial x^2};=;f,
\quad x\in(0,1),;t>0,
\quad
u(0,t) ;=;u(1,t);=;0,
\quad
u(x,0);=;u_0(x).$$</p><p data-raw='Since the PDE can be written as
$$u_t ;=; u_{xx} + f,$$
we will discretize in both space and time.'>Since the PDE can be written as
$$u_t ;=; u_{xx} + f,$$
we will discretize in both space and time.</p><hr><h2 id=1-the-cranknicolson-discretization>1. The Crank–Nicolson Discretization
<a class=anchor href=#1-the-cranknicolson-discretization>#</a></h2><p data-raw='Let $\Delta x = \frac{1}{M}$ partition $[0,1]$ into $M+1$ grid points $x_i = i,\Delta x$, $i=0,\dots,M$, and let $\Delta t$ be a time step, so $t^n = n,\Delta t$. We write $u_i^n\approx u(x_i,t^n)$. The standard second‐order central difference for $u_{xx}$ is'>Let $\Delta x = \frac{1}{M}$ partition $[0,1]$ into $M+1$ grid points $x_i = i,\Delta x$, $i=0,\dots,M$, and let $\Delta t$ be a time step, so $t^n = n,\Delta t$. We write $u_i^n\approx u(x_i,t^n)$. The standard second‐order central difference for $u_{xx}$ is</p><p data-raw='$$u_{xx}(x_i,t^n)
;\approx;
\frac{u_{i+1}^n - 2,u_i^n + u_{i-1}^n}{(\Delta x)^2}.$$'>$$u_{xx}(x_i,t^n)
;\approx;
\frac{u_{i+1}^n - 2,u_i^n + u_{i-1}^n}{(\Delta x)^2}.$$</p><p data-raw='A $\theta$‐method (also called the $\theta$-scheme) for $u_t = u_{xx} + f$ in time is:'>A $\theta$‐method (also called the $\theta$-scheme) for $u_t = u_{xx} + f$ in time is:</p><p data-raw='$$\frac{u_i^{n+1} - u_i^n}{\Delta t}
;=;
\theta\Bigl[\underbrace{\tfrac{u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}}{(\Delta x)^2} ;+; f_i^{n+1}}<em>{\text{“implicit” part}}\Bigr]
;+;
\bigl(1-\theta\bigr)\Bigl[\underbrace{\tfrac{u</em>{i+1}^{n} - 2u_i^{n} + u_{i-1}^{n}}{(\Delta x)^2};+; f_i^{n}}_{\text{“explicit” part}}\Bigr].$$'>$$\frac{u_i^{n+1} - u_i^n}{\Delta t}
;=;
\theta\Bigl[\underbrace{\tfrac{u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}}{(\Delta x)^2} ;+; f_i^{n+1}}<em>{\text{“implicit” part}}\Bigr]
;+;
\bigl(1-\theta\bigr)\Bigl[\underbrace{\tfrac{u</em>{i+1}^{n} - 2u_i^{n} + u_{i-1}^{n}}{(\Delta x)^2};+; f_i^{n}}_{\text{“explicit” part}}\Bigr].$$</p><p data-raw='<strong>Crank–Nicolson</strong> is the special case $\theta = \tfrac12$.  Substituting $\theta=\tfrac12$, we get'><strong>Crank–Nicolson</strong> is the special case $\theta = \tfrac12$. Substituting $\theta=\tfrac12$, we get</p><p data-raw='$$\frac{u_i^{n+1} - u_i^n}{\Delta t}
;=;
\tfrac12\Bigl[\tfrac{u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}}{(\Delta x)^2} + f_i^{n+1}\Bigr]
;+;
\tfrac12\Bigl[\tfrac{u_{i+1}^{n} - 2u_i^{n} + u_{i-1}^{n}}{(\Delta x)^2} + f_i^n\Bigr].$$'>$$\frac{u_i^{n+1} - u_i^n}{\Delta t}
;=;
\tfrac12\Bigl[\tfrac{u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}}{(\Delta x)^2} + f_i^{n+1}\Bigr]
;+;
\tfrac12\Bigl[\tfrac{u_{i+1}^{n} - 2u_i^{n} + u_{i-1}^{n}}{(\Delta x)^2} + f_i^n\Bigr].$$</p><p data-raw='Rearranging terms gives
$$u_i^{n+1}
;-;
\frac{\Delta t}{2,(\Delta x)^2},\bigl(u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}\bigr)
;=;
u_i^{n}
;+;
\frac{\Delta t}{2,(\Delta x)^2},\bigl(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n}\bigr)
;+;
\frac{\Delta t}{2},\bigl(f_i^{n+1} + f_i^n\bigr).$$
One may think of this as the linear system
$$\bigl[I + \tfrac{\Delta t}{2,(\Delta x)^2},A\bigr],\mathbf{u}^{n+1}
;=;
\bigl[I - \tfrac{\Delta t}{2,(\Delta x)^2},A\bigr],\mathbf{u}^{n}
;+;\frac{\Delta t}{2},\bigl(\mathbf{f}^{n+1} + \mathbf{f}^n\bigr),$$
where $A$ is the usual tridiagonal matrix corresponding to the second‐difference operator (and where $\mathbf{u}^n$ is the vector of $u_i^n$). After applying boundary conditions $u_0^n = u_M^n = 0$, one solves this tridiagonal system at each time step.'>Rearranging terms gives
$$u_i^{n+1}
;-;
\frac{\Delta t}{2,(\Delta x)^2},\bigl(u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}\bigr)
;=;
u_i^{n}
;+;
\frac{\Delta t}{2,(\Delta x)^2},\bigl(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n}\bigr)
;+;
\frac{\Delta t}{2},\bigl(f_i^{n+1} + f_i^n\bigr).$$
One may think of this as the linear system
$$\bigl[I + \tfrac{\Delta t}{2,(\Delta x)^2},A\bigr],\mathbf{u}^{n+1}
;=;
\bigl[I - \tfrac{\Delta t}{2,(\Delta x)^2},A\bigr],\mathbf{u}^{n}
;+;\frac{\Delta t}{2},\bigl(\mathbf{f}^{n+1} + \mathbf{f}^n\bigr),$$
where $A$ is the usual tridiagonal matrix corresponding to the second‐difference operator (and where $\mathbf{u}^n$ is the vector of $u_i^n$). After applying boundary conditions $u_0^n = u_M^n = 0$, one solves this tridiagonal system at each time step.</p><h3 id=boundary-conditions>Boundary Conditions
<a class=anchor href=#boundary-conditions>#</a></h3><p data-raw='Because $u(0,t)=u(1,t)=0$, we set $u_0^n=0$ and $u_M^n=0$ for all $n$.  The updates are applied only for $i=1,\dots,M-1$.'>Because $u(0,t)=u(1,t)=0$, we set $u_0^n=0$ and $u_M^n=0$ for all $n$. The updates are applied only for $i=1,\dots,M-1$.</p><h3 id=summary-of-the-cn-update>Summary of the CN Update
<a class=anchor href=#summary-of-the-cn-update>#</a></h3><p data-raw='In “index form,” the Crank–Nicolson scheme is:
$$\boxed{
\begin{aligned}
&\text{For }i=1,\dots,M-1:\quad
u_i^{n+1}
;-;
\tfrac{\Delta t}{2,(\Delta x)^2},\bigl(u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}\bigr)
\
&\qquad\quad;=;
u_i^{n}
;+;
\tfrac{\Delta t}{2,(\Delta x)^2},\bigl(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n}\bigr)
;+;\frac{\Delta t}{2},\bigl(f_i^{n+1} + f_i^n\bigr).
\end{aligned}
}$$
This is solved simultaneously for all $i$, respecting $u_0^{n+1}=u_M^{n+1}=0$.'>In “index form,” the Crank–Nicolson scheme is:
$$\boxed{
\begin{aligned}
&\text{For }i=1,\dots,M-1:\quad
u_i^{n+1}
;-;
\tfrac{\Delta t}{2,(\Delta x)^2},\bigl(u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}\bigr)
\
&\qquad\quad;=;
u_i^{n}
;+;
\tfrac{\Delta t}{2,(\Delta x)^2},\bigl(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n}\bigr)
;+;\frac{\Delta t}{2},\bigl(f_i^{n+1} + f_i^n\bigr).
\end{aligned}
}$$
This is solved simultaneously for all $i$, respecting $u_0^{n+1}=u_M^{n+1}=0$.</p><hr><h2 id=2-properties-stability--accuracy>2. Properties: Stability & Accuracy
<a class=anchor href=#2-properties-stability--accuracy>#</a></h2><ol><li><p data-raw='<strong>Stability</strong>:'><strong>Stability</strong>:</p><ul><li><strong>Unconditional stability</strong> for the heat equation. In other words, there is no restriction on $\Delta t$ relative to $\Delta x$ needed <em>solely</em> for stability (unlike the explicit forward‐Euler method, which requires $\Delta t \le \tfrac12 (\Delta x)^2$).</li><li>More precisely, CN is <strong>A‐stable</strong> as an ODE solver applied to the linear diffusion operator. One can show by a von Neumann analysis or standard Lax–Richtmyer theory that errors do not grow unboundedly for any $\Delta t>0$.</li></ul></li><li><p data-raw='<strong>Accuracy</strong>:'><strong>Accuracy</strong>:</p><ul><li>In <strong>time</strong>, Crank–Nicolson is <strong>second‐order accurate</strong>, because it is essentially the trapezoidal rule in time (it uses $\frac12$ of the “new” time‐level’s spatial derivative plus $\frac12$ of the “old” time‐level’s spatial derivative).</li><li>In <strong>space</strong>, if we use the standard second‐difference approximation, the scheme is also <strong>second‐order</strong> in $\Delta x$.</li><li>Overall, we often say “CN is second‐order in both space and time (for sufficiently smooth solutions).”</li></ul></li></ol><hr><h2 id=3-bonus-discontinuous-initial-condition>3. BONUS: Discontinuous Initial Condition
<a class=anchor href=#3-bonus-discontinuous-initial-condition>#</a></h2><p data-raw='Even if $u_0(x)$ is not continuous, the <strong>heat equation</strong> itself is <em>smoothing</em>: for $t>0$, the exact solution becomes infinitely differentiable in $x$.  Numerically:'>Even if $u_0(x)$ is not continuous, the <strong>heat equation</strong> itself is <em>smoothing</em>: for $t>0$, the exact solution becomes infinitely differentiable in $x$. Numerically:</p><ul><li>The scheme remains stable and convergent.</li><li>Because it is a diffusion‐type PDE, any jump discontinuity in the initial data gets smoothed out instantly as $t$ increases.</li><li>Crank–Nicolson will faithfully capture that smoothing. You may see large gradients at early time steps near the discontinuity, but the method will not become unstable.</li></ul><p data-raw='Hence <strong>having a discontinuous initial condition does not cause instability</strong> for the heat equation with Crank–Nicolson.  The scheme still converges (second‐order in both space and time) to the <em>unique smooth</em> solution that the parabolic PDE defines for $t>0$.'>Hence <strong>having a discontinuous initial condition does not cause instability</strong> for the heat equation with Crank–Nicolson. The scheme still converges (second‐order in both space and time) to the <em>unique smooth</em> solution that the parabolic PDE defines for $t>0$.</p><h1 id=problem-4-求解二维拉普拉斯方程的五点差分格式>Problem 4 求解二维拉普拉斯方程的五点差分格式
<a class=anchor href=#problem-4-%e6%b1%82%e8%a7%a3%e4%ba%8c%e7%bb%b4%e6%8b%89%e6%99%ae%e6%8b%89%e6%96%af%e6%96%b9%e7%a8%8b%e7%9a%84%e4%ba%94%e7%82%b9%e5%b7%ae%e5%88%86%e6%a0%bc%e5%bc%8f>#</a></h1><p data-raw='我们考虑如下的椭圆方程（Poisson 型）：
$$-,\Delta u ;=; f,
\quad (x,y)\in [0,1] \times [0,1].$$'>我们考虑如下的椭圆方程（Poisson 型）：
$$-,\Delta u ;=; f,
\quad (x,y)\in [0,1] \times [0,1].$$</p><p data-raw='其中
$$\Delta ;=;\frac{\partial^2}{\partial x^2} ;+;\frac{\partial^2}{\partial y^2}$$
是二维拉普拉斯算子，$f$ 是已知的函数。'>其中
$$\Delta ;=;\frac{\partial^2}{\partial x^2} ;+;\frac{\partial^2}{\partial y^2}$$
是二维拉普拉斯算子，$f$ 是已知的函数。</p><h2 id=1-建立网格>1. 建立网格
<a class=anchor href=#1-%e5%bb%ba%e7%ab%8b%e7%bd%91%e6%a0%bc>#</a></h2><p data-raw='令 $N_x$ 和 $N_y$ 分别表示在 $x$ 和 $y$ 方向上的网格划分数目（仅指内部节点数，不含边界），则步长为
$$\delta x ;=;\frac{1}{N_x+1},
\quad
\delta y ;=;\frac{1}{N_y+1}.$$
我们在区间 $[0,1]\times[0,1]$ 内取离散网格点
$$x_i ;=; i,\delta x,
\quad
y_j ;=; j,\delta y,$$
其中 $i=0,1,2,\dots,N_x+1$, $j=0,1,2,\dots,N_y+1$。'>令 $N_x$ 和 $N_y$ 分别表示在 $x$ 和 $y$ 方向上的网格划分数目（仅指内部节点数，不含边界），则步长为
$$\delta x ;=;\frac{1}{N_x+1},
\quad
\delta y ;=;\frac{1}{N_y+1}.$$
我们在区间 $[0,1]\times[0,1]$ 内取离散网格点
$$x_i ;=; i,\delta x,
\quad
y_j ;=; j,\delta y,$$
其中 $i=0,1,2,\dots,N_x+1$, $j=0,1,2,\dots,N_y+1$。</p><p data-raw='在内部节点 $(x_i,y_j)$ 上，我们用 $u_{i,j}$ 表示对真解 $u(x_i,y_j)$ 的数值近似。'>在内部节点 $(x_i,y_j)$ 上，我们用 $u_{i,j}$ 表示对真解 $u(x_i,y_j)$ 的数值近似。</p><hr><h2 id=2-五点差分格式>2. 五点差分格式
<a class=anchor href=#2-%e4%ba%94%e7%82%b9%e5%b7%ae%e5%88%86%e6%a0%bc%e5%bc%8f>#</a></h2><p data-raw='方程 $-\Delta u = f$ 可写成
$$-\left(
\frac{\partial^2 u}{\partial x^2}
;+;
\frac{\partial^2 u}{\partial y^2}
\right)
;=;
f,$$
即
$$\frac{\partial^2 u}{\partial x^2}
;+;
\frac{\partial^2 u}{\partial y^2}
;=;
-,f.$$'>方程 $-\Delta u = f$ 可写成
$$-\left(
\frac{\partial^2 u}{\partial x^2}
;+;
\frac{\partial^2 u}{\partial y^2}
\right)
;=;
f,$$
即
$$\frac{\partial^2 u}{\partial x^2}
;+;
\frac{\partial^2 u}{\partial y^2}
;=;
-,f.$$</p><p data-raw='在网格上，二阶导数的<strong>中心差分</strong>近似分别为：'>在网格上，二阶导数的<strong>中心差分</strong>近似分别为：</p><ul><li>在 $x$ 方向：
$$\frac{\partial^2 u}{\partial x^2}\bigg|<em>{(x_i,y_j)}
;\approx;
\frac{u</em>{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2},$$</li><li>在 $y$ 方向：
$$\frac{\partial^2 u}{\partial y^2}\bigg|<em>{(x_i,y_j)}
;\approx;
\frac{u</em>{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2}.$$</li></ul><p data-raw='因此，$\Delta u$ 在离散化后可写为
$$\Delta u_{i,j}
;=;
\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2}
;+;
\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2}.$$'>因此，$\Delta u$ 在离散化后可写为
$$\Delta u_{i,j}
;=;
\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2}
;+;
\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2}.$$</p><p data-raw='由于方程是 $-\Delta u = f$，则对应的五点差分格式为'>由于方程是 $-\Delta u = f$，则对应的五点差分格式为</p><p data-raw='$$-\left[,
\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2}
;+;
\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2}
\right]
;=;
f_{i,j},$$
或等价地写成
$$\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2}
;+;
\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2}
;=;
-,f_{i,j}.$$'>$$-\left[,
\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2}
;+;
\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2}
\right]
;=;
f_{i,j},$$
或等价地写成
$$\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2}
;+;
\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2}
;=;
-,f_{i,j}.$$</p><p data-raw='这里 $f_{i,j} = f(x_i,y_j)$ 表示在网格点处的函数取值。'>这里 $f_{i,j} = f(x_i,y_j)$ 表示在网格点处的函数取值。</p><hr><h2 id=3-精度阶次>3. 精度阶次
<a class=anchor href=#3-%e7%b2%be%e5%ba%a6%e9%98%b6%e6%ac%a1>#</a></h2><p data-raw='上述中心差分格式对二阶导数在空间步长上具有 <strong>二阶精度</strong>。也就是说，如果我们将 $\delta x$ 和 $\delta y$ 同步缩小（假设网格等距），则离散解相对于真解的误差在 $\delta x, \delta y \to 0$ 时满足
$$\mathcal{O}\bigl((\delta x)^2 + (\delta y)^2\bigr).$$'>上述中心差分格式对二阶导数在空间步长上具有 <strong>二阶精度</strong>。也就是说，如果我们将 $\delta x$ 和 $\delta y$ 同步缩小（假设网格等距），则离散解相对于真解的误差在 $\delta x, \delta y \to 0$ 时满足
$$\mathcal{O}\bigl((\delta x)^2 + (\delta y)^2\bigr).$$</p><p data-raw='简而言之，对拉普拉斯方程采用这种五点中心差分格式，<strong>在均匀网格下是二阶精度</strong>。'>简而言之，对拉普拉斯方程采用这种五点中心差分格式，<strong>在均匀网格下是二阶精度</strong>。</p><hr><h2 id=4-最终形成的线性方程组>4. 最终形成的线性方程组
<a class=anchor href=#4-%e6%9c%80%e7%bb%88%e5%bd%a2%e6%88%90%e7%9a%84%e7%ba%bf%e6%80%a7%e6%96%b9%e7%a8%8b%e7%bb%84>#</a></h2><p data-raw='对所有内部节点 $(i,j)$（即 $1\le i\le N_x$, $1\le j\le N_y$）应用上述离散方程，我们便得到一个关于所有未知量 ${u_{i,j}}$ 的线性方程组。若再结合边界条件（例如已知边界上的 $u_{0,j},u_{N_x+1,j},u_{i,0},u_{i,N_y+1}$），即可完全求解。'>对所有内部节点 $(i,j)$（即 $1\le i\le N_x$, $1\le j\le N_y$）应用上述离散方程，我们便得到一个关于所有未知量 ${u_{i,j}}$ 的线性方程组。若再结合边界条件（例如已知边界上的 $u_{0,j},u_{N_x+1,j},u_{i,0},u_{i,N_y+1}$），即可完全求解。</p><p data-raw='在实际应用中，可以用各种<strong>迭代法</strong>（如 Jacobi、Gauss-Seidel、SOR 等）或<strong>直接法</strong>（如 LU 分解等）来求解这个离散方程组。'>在实际应用中，可以用各种<strong>迭代法</strong>（如 Jacobi、Gauss-Seidel、SOR 等）或<strong>直接法</strong>（如 LU 分解等）来求解这个离散方程组。</p><hr><h2 id=5-总结>5. 总结
<a class=anchor href=#5-%e6%80%bb%e7%bb%93>#</a></h2><ol><li><strong>五点差分格式</strong>的离散方程（在二维情况下）是：
$$\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2}
;+;
\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2}
;=;
-,f_{i,j}.$$</li><li>在标准的（均匀）网格下，该方法的<strong>空间离散精度是二阶</strong>。</li></ol><hr></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/EriseHe/notebook/edit/main//content.en/docs/%e6%95%b0%e5%ad%a6/MATH%20351%20&amp;amp;%20352/MATH%20352%20PDE%20in%20Action/%e7%ac%ac%e4%b9%9d%e7%ab%a0/Exercise.md target=_blank rel=noopener><img src=/notebook/svg/edit.svg class=book-icon alt>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside id=book-toc class="book-toc hidden"><div class=book-toc-content><div class=button-prev><a class=btn-prev href=/notebook/docs/%E6%95%B0%E5%AD%A6/MATH-351-352/MATH-352-PDE-in-Action/03-Numerical-Solution-of-Ordinary-Differential-Equations/><strong>Previous:</strong> 常微分方程的数值解</a></div><div class=toc-entries><nav id=TableOfContents><ul><li><a href=#problem-1-finite-difference-solution>Problem 1: Finite-Difference Solution</a><ul><li><a href=#1-finite-difference-discretization>1. Finite-Difference Discretization</a><ul><li><a href=#11-central-difference-scheme-for-the-interior-points>1.1 Central Difference Scheme (for the interior points)</a></li></ul></li><li><a href=#2-local-truncation-error>2. Local Truncation Error</a></li><li><a href=#3-matrix-form>3. Matrix Form</a></li></ul></li><li><a href=#endpmatrix>$$\begin{pmatrix}
2\alpha & -\alpha+\gamma & 0 & \cdots & 0\
-\alpha-\gamma & 2\alpha & -\alpha+\gamma & \cdots & 0\
0 & \ddots & \ddots & \ddots & \vdots\
\vdots & & -\alpha-\gamma & 2\alpha & -\alpha+\gamma\
0 & \cdots & 0 & -\alpha-\gamma & 2\alpha
\end{pmatrix}
\begin{pmatrix}
u_1\ u_2\ \vdots \ u_{N-2}\ u_{N-1}
\end{pmatrix}</a><ul><li><a href=#4-quality-of-the-solution-vs-betamu>4. Quality of the Solution vs. $\beta/\mu$</a></li><li><a href=#5-upwind-method-first-order-for-beta0>5. Upwind Method (First Order) for $\beta&lt;0$</a><ul><li><a href=#51-no-spurious-oscillations>5.1 No Spurious Oscillations</a></li></ul></li><li><a href=#6-summary>6. Summary</a></li></ul></li><li><a href=#problem-2>Problem 2</a><ul><li><a href=#1-derivation-of-the-laxwendroff-scheme>1) Derivation of the Lax–Wendroff Scheme</a><ul><li><a href=#discretizing-the-spatial-derivatives>Discretizing the spatial derivatives</a></li></ul></li><li><a href=#2-the-cfl-stability-condition>2) The CFL Stability Condition</a></li><li><a href=#3-motivation>3) Motivation</a></li></ul></li><li><a href=#u_in1>Lax–Wendroff has the form
$$u_{i}^{n+1}</a><ul><li><a href=#u_in>u_{i}^{n}</a></li></ul></li><li><a href=#problem-3>Problem 3</a><ul><li><a href=#1-the-cranknicolson-discretization>1. The Crank–Nicolson Discretization</a><ul><li><a href=#boundary-conditions>Boundary Conditions</a></li><li><a href=#summary-of-the-cn-update>Summary of the CN Update</a></li></ul></li><li><a href=#2-properties-stability--accuracy>2. Properties: Stability & Accuracy</a></li><li><a href=#3-bonus-discontinuous-initial-condition>3. BONUS: Discontinuous Initial Condition</a></li></ul></li><li><a href=#problem-4-求解二维拉普拉斯方程的五点差分格式>Problem 4 求解二维拉普拉斯方程的五点差分格式</a><ul><li><a href=#1-建立网格>1. 建立网格</a></li><li><a href=#2-五点差分格式>2. 五点差分格式</a></li><li><a href=#3-精度阶次>3. 精度阶次</a></li><li><a href=#4-最终形成的线性方程组>4. 最终形成的线性方程组</a></li><li><a href=#5-总结>5. 总结</a></li></ul></li></ul></nav></div><div class=button-next><a class=btn-next href=/notebook/posts/creating-a-new-theme/><strong>Next:</strong> Creating a New Theme</a></div></div></aside></div><div class=toolbar-trigger></div><aside class=toolbar><button id=theme-toggle class=theme-toggle-btn>
<img src=/notebook/blackhole2.png alt="Switch Theme">
</button>
<button id=toc-toggle class=toc-toggle-btn>
<img src=/notebook/toc-icon.svg alt="Toggle TOC"></button><div class=font-size-control><button id=font-toggle class=font-size-btn>
A</button><div class=font-size-buttons><button id=font-increase class=font-control-btn>+</button>
<button id=font-reset class=font-control-btn>A</button>
<button id=font-decrease class=font-control-btn>−</button></div></div></aside><script>document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("book-toc"),t=!0;t?e.classList.remove("hidden"):e.classList.add("hidden"),document.getElementById("toc-toggle").addEventListener("click",function(){e.classList.toggle("hidden")})})</script><script src=/notebook/font-size.min.js></script><script src=/notebook/toolbar.min.js></script><script src=/notebook/toc-animation.min.js></script><script src=/notebook/menu-autohide.min.js></script></main><script>document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("theme-toggle");if(!e)return;e.onclick=()=>{const s=e.getBoundingClientRect(),o=s.left+s.width/2,i=s.top+s.height/2,l=document.documentElement.getAttribute("data-theme"),r=l||"auto";let n;r==="auto"?n=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n=r;const a=n==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",a),localStorage.setItem("theme",a);const c=n==="dark"?"#0b031c":"white",t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100vw",t.style.height="100vh",t.style.zIndex="9999",t.style.pointerEvents="none",t.style.setProperty("--cx",`${o}px`),t.style.setProperty("--cy",`${i}px`),t.style.setProperty("--r","0px"),t.style.backgroundImage=`radial-gradient(circle at var(--cx) var(--cy), transparent 0%, transparent var(--r), ${c} calc(var(--r) + 1px))`,document.body.appendChild(t);const u=window.innerWidth,h=window.innerHeight,m=Math.hypot(Math.max(o,u-o),Math.max(i,h-i)),f=600,p=performance.now();function d(e){const o=e-p,s=Math.min(o/f,1),n=s*m;if(t.style.setProperty("--r",`${n}px`),t.style.backgroundImage=`radial-gradient(circle at var(--cx) var(--cy), transparent 0%, transparent ${n}px, ${c} ${n+1}px)`,s<1)requestAnimationFrame(d);else{t.remove();const e=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",e)}}requestAnimationFrame(d)}})</script><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,processRefs:!0,tags:"ams",packages:{"[+]":["base","ams","amsmath","amssymb","array","bbox","boldsymbol","color","newcommand","noerrors","noundefined","mathtools"]}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},svg:{fontCache:"global"},startup:{ready:function(){MathJax.startup.defaultReady()}}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js id=MathJax-script async></script><script>window.__tikzjax_injected||(window.__tikzjax_injected=!0,fetch("/content.en/docs/.obsidian/plugins/obsidian-tikzjax/main.js").then(e=>e.text()).then(e=>{const t=e.match(/var tikzjax_default = `([\s\S]*?)`;?/);if(t){const n=t[1],e=document.createElement("script");e.id="tikzjax",e.type="text/javascript",e.innerHTML=n,document.head.appendChild(e)}else{const e=document.createElement("script");e.src="https://tikzjax.com/v1/tikzjax.js",e.defer=!0,document.head.appendChild(e)}}).catch(()=>{const e=document.createElement("script");e.src="https://tikzjax.com/v1/tikzjax.js",e.defer=!0,document.head.appendChild(e)}))</script><script>window.processTheoremBlocks=function(){document.querySelectorAll("blockquote").forEach(function(e){const t=e.querySelector("p");if(!t)return;const n=t.getAttribute("data-raw")||t.innerHTML,s=n.replace(/<[^>]*>/g,"").trim();for(const o of["definition","proposition","lemma","theorem","assumption","claim"]){const a=new RegExp(`^\\s*\\[!${o}\\|(\\*|[\\w\\.\\-]+)\\]\\s*`,"i"),i=s.match(a);if(i){console.log(`Found ${o} with label: ${i[1]}`);const c=i[1]!=="*",m=c?i[1]:"",f=n.replace(/<[^>]*>/g,""),p=f.split(/\n/),g=p[0]||"",l=g,d=l.replace(a,"").trim();if(e.classList.contains("math-theorem"))break;const v=Array.from(e.childNodes);e.innerHTML="",e.classList.add("math-theorem",o);const s=document.createElement("div");s.className="theorem-header";const u=o.charAt(0).toUpperCase()+o.slice(1),h=document.createElement("span");if(h.textContent=c?`${u} ${m}`:u,s.appendChild(h),d){const e=document.createElement("span");e.className="theorem-subtitle",e.textContent=` (${d})`,s.appendChild(e)}e.appendChild(s);const r=document.createElement("div");r.className="theorem-content",e.appendChild(r),v.forEach(function(e){let s=e.cloneNode(!0);if(e===t&&s.nodeType===1){const t=n.replace(/<[^>]*>/g,""),e=t.split(/\n/);if(e.length>1){const n=e.slice(1),t=n.join(`
`).trim();if(t)s.innerHTML="",s.appendChild(document.createTextNode(t));else return}else{const e=l.replace(a,"").trim();if(e)s.innerHTML="",s.appendChild(document.createTextNode(e));else return}}r.appendChild(s)});break}}})},document.addEventListener("DOMContentLoaded",function(){try{window.processTheoremBlocks()}catch(e){console.error(e)}})</script><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".copy-button");e.forEach(e=>{const t=e.innerHTML;e.addEventListener("click",function(){const n=this.parentElement.querySelector("pre code");if(!n)return;navigator.clipboard.writeText(n.innerText).then(()=>{e.textContent="Copied",setTimeout(()=>{e.innerHTML=t},1500)}).catch(n=>{console.error("Failed to copy code:",n),e.textContent="Error",setTimeout(()=>{e.innerHTML=t},1500)})})})})</script><script defer src=/notebook/partial-load.min.6b14bff963746e8ce83087045335ec7a6533e1157905e46f88d952cb415b7418.js integrity="sha256-axS/+WN0bozoMIcEUzXsemUz4RV5BeRviNlSy0FbdBg=" crossorigin=anonymous></script><script defer src=/notebook/menu-recursive-close.min.893276da918db977c98771d5746eab05ce5761bc6fa1ca400efe1db9be2ac1f3.js integrity="sha256-iTJ22pGNuXfJh3HVdG6rBc5XYbxvocpADv4dub4qwfM=" crossorigin=anonymous></script></body></html>