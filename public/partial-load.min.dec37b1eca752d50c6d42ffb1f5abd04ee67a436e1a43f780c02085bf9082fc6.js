document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".book-menu a");e.forEach(t=>{t.addEventListener("click",function(t){if(this.hostname!==window.location.hostname||this.getAttribute("href").startsWith("#")||this.getAttribute("target")==="_blank")return;t.preventDefault();const n=this.href;document.body.classList.add("loading"),window.history.pushState({url:n},"",n),fetch(n).then(e=>e.text()).then(t=>{const i=new DOMParser,n=i.parseFromString(t,"text/html"),s=n.querySelector(".book-page");s&&(document.querySelector(".book-page").innerHTML=s.innerHTML);const o=n.querySelector(".book-toc-content");o&&document.querySelector(".book-toc-content")&&(document.querySelector(".book-toc-content").innerHTML=o.innerHTML),document.title=n.title,e.forEach(e=>{e.classList.remove("active")}),this.classList.add("active"),typeof initializeComponents=="function"&&initializeComponents(),document.body.classList.remove("loading")}).catch(e=>{console.error("Error loading page:",e),window.location.href=n})})}),window.addEventListener("popstate",function(e){e.state&&e.state.url&&location.reload()})})