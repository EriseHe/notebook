/* Quarto theme adjustments inspired by the original Hugo Book styling */
:root {
  --page-max-width: 1280px;        /* original centered container width */
  --content-max-width: 1280px;     /* allow content to reach page max if desired */
  --sidebar-bg: #f5f5f7;
  --sidebar-border: #e0e0e5;
  --heading-font: "IBM Plex Serif", "Times New Roman", "PingFang SC", serif;
  --body-font: "SF Pro", "PingFang SC", "Noto Serif", serif;
  --code-font: "JetBrains Mono", "Roboto Mono", ui-monospace, SFMono-Regular, Menlo, monospace;
  scroll-behavior: smooth;
}

body {
  font-family: var(--body-font);
  background-color: #fafafa;
  color: #1e1e24;
  zoom: 0.90; /* Scale down entire page by 10% to fit wider layout */
}

/* Main container accounts for fixed navbar */
#quarto-content {
  padding-top: 56px; /* Just navbar height, no extra margin */
}

/* Smooth scroll behavior for all scrollable elements */
html {
  scroll-behavior: smooth;
}

.quarto-margin-sidebar, .sidebar {
  scroll-behavior: smooth;
}

.quarto-title-block .title {
  font-family: var(--heading-font);
  font-weight: 600;
  letter-spacing: 0.02em;
}

h1, h2, h3, h4, h5, h6 {
  font-family: var(--heading-font);
  color: #0d0d0f;
}

.sidebar {
  background: transparent;
  border-right: none !important; /* Remove vertical divider */
  box-shadow: none !important;   /* Remove inset divider if theme uses it */
  font-size: 0.95rem;
}

.sidebar .nav-link { border-radius: 8px; padding: 0.5rem 0.75rem; transition: background-color .15s ease, color .15s ease, transform .1s ease; }
.sidebar .nav-link:hover { background-color: rgba(0,0,0,0.04); color: #0d0d0f; }
.sidebar .nav-link:active { transform: translateY(1px); }

.sidebar .nav-link.active { background-color: rgba(27,31,35,.08); color: #111827; font-weight: 600; }

#quarto-sidebar { 
  background: transparent; 
  border-right: none !important; 
  box-shadow: none !important; /* Remove vertical divider */
  opacity: 1;
  transition: opacity 0.4s ease-in-out;
  /* Hide scrollbar but keep functionality */
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE/Edge */
}

#quarto-sidebar::-webkit-scrollbar {
  display: none; /* Chrome/Safari/Opera */
}

#quarto-sidebar.sidebar-hidden {
  opacity: 0;
  pointer-events: none;
}

#quarto-sidebar .sidebar-menu-container { padding-right: 0.5rem; }
#quarto-sidebar .sidebar-section { margin-bottom: 0.6rem; }
/* Collapsed by default: hide all nested sections unless explicitly opened by user click */
#quarto-sidebar .collapse {
  display: none !important;
}

#quarto-sidebar .collapse.show {
  display: block !important;
}

/* Hide toggle icons - make folder names clickable to expand */
#quarto-sidebar .sidebar-item-toggle { display: none !important; }

/* Make the entire folder item clickable for accordion behavior */
#quarto-sidebar .sidebar-item { cursor: pointer; }


.sidebar-title {
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.75rem;
  color: #6b7280;
}

/* Special styling for root category items: 理论 and 计算 */
#quarto-sidebar .sidebar-menu-container > ul.list-unstyled > li > .sidebar-item-container > a.sidebar-item-text[href$="/content/notes/理论/index.html"],
#quarto-sidebar .sidebar-menu-container > ul.list-unstyled > li > .sidebar-item-container > a.sidebar-item-text[href$="/content/notes/计算/index.html"] {
  display: block;
  padding: 0.6rem 0.75rem;
  margin: 0.35rem 0.25rem 0.5rem;
  border-radius: 10px;
  background: linear-gradient(135deg, #eef6ff 0%, #f7fbff 100%);
  border: 1px solid #e5eefc;
  font-weight: 700;
  color: #1b4f82;
}
#quarto-sidebar .sidebar-menu-container > ul.list-unstyled > li > .sidebar-item-container > a.sidebar-item-text[href$="/content/notes/理论/index.html"]::before,
#quarto-sidebar .sidebar-menu-container > ul.list-unstyled > li > .sidebar-item-container > a.sidebar-item-text[href$="/content/notes/计算/index.html"]::before {
  content: "";
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: #276fb4;
  margin-right: 8px;
}
#quarto-sidebar .sidebar-menu-container > ul.list-unstyled > li > .sidebar-item-container > a.sidebar-item-text[href$="/content/notes/理论/index.html"]:hover,
#quarto-sidebar .sidebar-menu-container > ul.list-unstyled > li > .sidebar-item-container > a.sidebar-item-text[href$="/content/notes/计算/index.html"]:hover {
  border-color: #c9ddfb;
  box-shadow: 0 4px 14px rgba(39,111,180,0.12);
  transform: translateY(-1px);
}

.page-columns { max-width: var(--page-max-width) !important; margin: 0 auto; }

main.content { 
  padding: 2rem 2rem; 
  max-width: var(--content-max-width) !important;
}

/* Some themes draw the divider on the content column instead of the sidebar */
.page-columns .content,
main.content {
  border-left: none !important;
  box-shadow: none !important;
  max-width: var(--content-max-width) !important;
}

/* Additional selectors to ensure content width is applied */
#quarto-content .content,
.quarto-container > .page-columns > .content,
div.page-columns div.content,
.column-body,
.content.column-body {
  max-width: var(--content-max-width) !important;
}

.page-brand {
  font-family: var(--heading-font);
  font-size: clamp(2.1rem, 2.6vw, 3rem);
  font-weight: 500;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: #1a1a1d;
}

/* ========================================
   NAVBAR STYLING - Modify here for navbar appearance
   ======================================== */
.navbar { 
  position: fixed !important;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1030;
  border-bottom: 1px solid rgba(229, 231, 235, 0.3); 
  background: rgba(255, 255, 255, 0.95); 
  backdrop-filter: blur(10px);
  transition: opacity 0.3s ease, background 0.3s ease, border-color 0.3s ease;
}

/* Transparent state when scrolling down - EVERYTHING fades out */
.navbar.navbar-transparent {
  opacity: 0;
  pointer-events: none; /* Can't click on invisible navbar */
}

/* Disable Quarto's default headroom behavior */
.headroom, .headroom--pinned, .headroom--unpinned { 
  transform: none !important; 
  transition: none !important; 
  position: fixed !important;
}


.navbar .navbar-brand {
  font-family: var(--heading-font);
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

/* ========================================
   CALLOUT ZOOM (double-click to enlarge)
   ======================================== */
.callout,
.math-theorem {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

body.callout-zoom-active {
  overflow: hidden;
}

.callout-zoom-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(15, 18, 24, 0.35);
  backdrop-filter: blur(2px);
  z-index: 1100;
}

.callout.callout-zoomed,
.math-theorem.callout-zoomed {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(1.5);
  transform-origin: center center;
  z-index: 1200;
  max-width: min(90vw, 900px);
  max-height: 85vh;
  overflow: auto;
  box-shadow: 0 18px 50px rgba(15, 18, 24, 0.28);
}

.navbar .nav-link {
  font-weight: 500;
}

/* Navbar search styling */
.navbar .quarto-search { max-width: 340px; }
.navbar .quarto-search .aa-Input, .navbar .quarto-search input[type="search"] {
  border-radius: 9999px;
  padding: 0.5rem 1rem;
  background: #f3f4f6;
  border: 1px solid #e5e7eb;
}
.navbar .quarto-search .aa-Input:focus { background: #fff; box-shadow: 0 0 0 3px rgba(99,102,241,0.25); border-color: #a5b4fc; }

pre code, code {
  font-family: var(--code-font);
  font-size: 0.8rem;
  line-height: 1.4;
}

/* ========================================
   CODE BLOCKS - Unified styling for all fenced code
   Works for both plain fenced blocks and Quarto-highlighted blocks
   ======================================== */
/* Base variables */
:root {
  --code-bg: #f7f7f9;
  --code-border: #e5e7eb;
  --code-accent: #276fb4; /* default if language not mapped below */
}

/* Base style for any pre (plain) and highlighted blocks */
pre,
pre.sourceCode {
  position: relative;
  background: var(--code-bg);
  border-radius: 8px;
  padding: 0.75rem 1rem 1.5rem; /* scaled down padding, extra bottom for copy button */
  border: 1px solid var(--code-border);
  box-shadow: 0 1px 0 rgba(0,0,0,0.02);
  border-left: 3px solid var(--code-accent);
  max-width: 100%;
  overflow-x: auto;
}

/* Small language pill label (shown when we know the language) */
pre.sourceCode::before {
  content: attr(data-lang);
  position: absolute;
  top: 6px;
  right: 8px;
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 0.65rem;
  line-height: 1.1;
  color: #374151;
  background: rgba(0,0,0,0.06);
}

/* Map common languages to accent colors and label text */
pre.sourceCode.bash { --code-accent: #3e4349; }
pre.sourceCode.bash::before { content: "Bash"; }

pre.sourceCode.sh { --code-accent: #3e4349; }
pre.sourceCode.sh::before { content: "Shell"; }

pre.sourceCode.python { --code-accent: #3776ab; }
pre.sourceCode.python::before { content: "Python"; }

pre.sourceCode.julia { --code-accent: #9558b2; }
pre.sourceCode.julia::before { content: "Julia"; }

pre.sourceCode.r { --code-accent: #198ce7; }
pre.sourceCode.r::before { content: "R"; }

pre.sourceCode.js, pre.sourceCode.javascript { --code-accent: #f0db4f; }
pre.sourceCode.js::before, pre.sourceCode.javascript::before { content: "JavaScript"; }

pre.sourceCode.ts, pre.sourceCode.typescript { --code-accent: #3178c6; }
pre.sourceCode.ts::before, pre.sourceCode.typescript::before { content: "TypeScript"; }

pre.sourceCode.yaml, pre.sourceCode.yml { --code-accent: #cb8a00; }
pre.sourceCode.yaml::before, pre.sourceCode.yml::before { content: "YAML"; }

pre.sourceCode.json { --code-accent: #9c27b0; }
pre.sourceCode.json::before { content: "JSON"; }

pre.sourceCode.html { --code-accent: #e34c26; }
pre.sourceCode.html::before { content: "HTML"; }

pre.sourceCode.css { --code-accent: #563d7c; }
pre.sourceCode.css::before { content: "CSS"; }

/* Place the Quarto copy button at right-bottom to avoid label overlap */
.code-copy-button { 
  position: absolute; 
  bottom: 6px; 
  right: 8px; 
  z-index: 2;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
}

/* Ensure the wrapper is the positioning context for the copy button */
.code-copy-outer-scaffold { position: relative; }

/* ========================================
   LISTING PAGES - Beautiful folder index design
   ======================================== */
.quarto-listing {
  margin-top: 2rem;
}

.quarto-listing-default .list {
  display: grid;
  gap: 1.25rem;
  padding: 0;
  list-style: none;
}

/* Ensure listing cards don't squeeze to center */
.quarto-listing-default .quarto-post { 
  display: block; 
  max-width: none; 
}

.quarto-listing-default .list > div,
.quarto-listing-default .quarto-post {
  background: #fafafa !important;
  border: 1px solid #e5e7eb !important;
  border-radius: 8px !important;
  padding: 1.25rem 1.5rem !important;
  transition: all 0.2s ease !important;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04) !important;
}

.quarto-listing-default .list > div:hover,
.quarto-listing-default .quarto-post:hover {
  border-color: #276fb4 !important;
  box-shadow: 0 4px 12px rgba(39, 111, 180, 0.1) !important;
  transform: translateY(-1px) !important;
}

.quarto-listing-default .listing-title {
  font-size: 1.1rem;
  font-weight: 600;
  margin: 0 0 0.5rem 0;
  color: #1f2937;
}

.quarto-listing-default .listing-title a {
  color: #276fb4;
  text-decoration: none;
  transition: color 0.15s ease;
}

.quarto-listing-default .listing-title a:hover {
  color: #1e5a8f;
  text-decoration: underline;
}

.quarto-listing-default .listing-subtitle,
.quarto-listing-default .listing-description {
  font-size: 0.9rem;
  color: #6b7280;
  margin: 0.25rem 0;
  line-height: 1.6;
}

.quarto-listing-default .listing-categories {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 0.75rem;
}

.quarto-listing-default .listing-category {
  background: #e0f2fe;
  color: #0369a1;
  padding: 0.25rem 0.75rem;
  border-radius: 4px;
  font-size: 0.8rem;
  font-weight: 500;
}

/* List layout improvements */
.quarto-listing-default.quarto-listing-cols-1 .list {
  grid-template-columns: 1fr;
}

.quarto-listing-default.quarto-listing-cols-2 .list {
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
}

/* Nested section headings in listings */
.quarto-listing h2 {
  font-size: 1.5rem;
  font-weight: 600;
  color: #111827;
  margin-top: 2.5rem;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #e5e7eb;
}

.quarto-listing h3 {
  font-size: 1.2rem;
  font-weight: 600;
  color: #374151;
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
}

/* ========================================
   TOC CUSTOMIZATION
   ======================================== */
/* Hide ToC title only (localized). Do NOT hide first heading */
#toc-title { display: none !important; }

/* ========================================
   SIDEBAR SPACING - add room before divider
   ======================================== */
@media (min-width: 992px) {
  /* Give breathing space between items/toggles and the vertical divider */
  #quarto-sidebar .sidebar-header,
  #quarto-sidebar .sidebar-menu-container,
  #quarto-sidebar .sidebar-item-container {
    padding-right: 1rem; /* space for toggle icon before the divider */
  }

  /* Extend the left edge and keep the right edge fixed */
  #quarto-sidebar {
    width: 320px;                 /* widen by 40px */
    transform: translateX(-40px); /* shift left by 40px */
  }

  /* Ensure parent containers don't clip the shift */
  #quarto-content, .sidebar-navigation.docked { overflow: visible; }

  /* Increase main content width (override Quarto defaults) */
  .content { max-width: var(--content-max-width) !important; }

  /* First-level folders (direct children of root list): spacing + bold */
  #quarto-sidebar .sidebar-menu-container > ul.list-unstyled > li.sidebar-item-section {
    margin-bottom: 0.5rem;
  }
  #quarto-sidebar .sidebar-menu-container > ul.list-unstyled > li.sidebar-item-section > .sidebar-item-container > a.sidebar-item-text {
    font-weight: 700 !important;
  }

  /* Nested folders (any depth under a section): normal weight */
  #quarto-sidebar ul.sidebar-section .sidebar-item-text {
    font-weight: 500 !important;
  }

  /* Increase indentation for nested levels */
  #quarto-sidebar .sidebar-section.depth1 .sidebar-item-container,
  #quarto-sidebar .sidebar-section.depth1 > li > .sidebar-item-container,
  #quarto-sidebar .sidebar-section.depth1 > li > a.sidebar-item-toggle { padding-left: 0.75rem; }

  #quarto-sidebar .sidebar-section.depth2 .sidebar-item-container,
  #quarto-sidebar .sidebar-section.depth2 > li > .sidebar-item-container,
  #quarto-sidebar .sidebar-section.depth2 > li > a.sidebar-item-toggle { padding-left: 1.5rem; }

  #quarto-sidebar .sidebar-section.depth3 .sidebar-item-container,
  #quarto-sidebar .sidebar-section.depth3 > li > .sidebar-item-container,
  #quarto-sidebar .sidebar-section.depth3 > li > a.sidebar-item-toggle { padding-left: 2.25rem; }
}

/* Ensure Quarto sets language class and we backfill label from class name */
/* The pandoc/quarto HTML already sets classes like pre.sourceCode.python.
   The rules above set the accent color and label via ::before per language. */


blockquote {
  font-style: italic;
  border-left: 3px solid #d1d5db;
  padding-left: 1rem;
  color: #4b5563;
  background-color: rgba(209, 213, 219, 0.15);
}

a {
  color: #276fb4;
}

a:hover {
  color: #1b4f82;
}

.callout {
  border-radius: 12px;
  border: 1px solid rgba(0, 0, 0, 0.04);
}

.table-striped > tbody > tr:nth-of-type(odd) > * {
  --bs-table-bg-type: rgba(0, 0, 0, 0.015);
}

img {
  border-radius: 12px;
}

@media (max-width: 991px) {
  main.content {
    padding: 1.75rem 1.5rem;
  }
}

/* ========================================
   TABLE OF CONTENTS (TOC) STYLING - Right sidebar
   Modify here for TOC appearance
   ======================================== */
/* Use both class and id to ensure override across Quarto versions */
.quarto-margin-sidebar, #quarto-margin-sidebar, aside.margin-sidebar { 
  position: sticky !important; 
  top: 100px !important; /* space for navbar while sticky */
  max-height: calc(100vh - 100px) !important; 
  overflow-y: auto; 
  background: transparent; 
  border-left: none !important; /* remove framework vertical line */
  width: clamp(220px, 22vw, 360px);
  /* Smart right push: on wide screens push to viewport edge, else 0 */
  margin-right: min(calc((100vw - var(--page-max-width)) / -2 + 1rem), 0px) !important;
}

/* remove any residual borders/lines inside the TOC */
#quarto-margin-sidebar nav, 
#quarto-margin-sidebar .nav, 
#quarto-margin-sidebar .toc-actions, 
.quarto-margin-sidebar nav {
  border: transparent !important;
}

/* TOC links styling */
.quarto-margin-sidebar .toc-actions a,
.quarto-margin-sidebar nav a {
  color: inherit;              /* use theme/default text color */
  transition: color 0.15s ease, background-color 0.15s ease;
}

.quarto-margin-sidebar .toc-actions a:hover,
.quarto-margin-sidebar nav a:hover {
  color: #111827;
  background: transparent !important;  /* no hover background for toc */
}

.quarto-margin-sidebar nav a.active {
  color: #276fb4;                               /* blue text like theme */
  background: rgba(0,0,0,0.06) !important;      /* gray active bg */
  font-weight: 600;
}

/* TOC item styling: remove blue left shadow/pill, make items fully transparent */
#quarto-margin-sidebar nav a,
#quarto-margin-sidebar .nav-link,
.quarto-margin-sidebar nav a {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;      /* remove any inset left glow */
  border-radius: 0 !important;      /* remove rounded pill */
}

#quarto-margin-sidebar nav a.active,
#quarto-margin-sidebar .nav .active > .nav-link,
.quarto-margin-sidebar nav a.active {
  border: none !important;
  box-shadow: none !important;
}

/* remove any decorative left bars used by themes */
#quarto-margin-sidebar nav a::before,
#quarto-margin-sidebar .nav-link::before,
.quarto-margin-sidebar nav a::before {
  content: none !important;
  display: none !important;
}

/* ensure no list borders leak through */
#quarto-margin-sidebar li,
.quarto-margin-sidebar li {
  border: none !important;
}

/* ========================================
   LEFT SIDEBAR (MENU) STYLING
   Modify here for menu appearance
   ======================================== */
.sidebar { 
  padding-left: 0.25rem;             /* shift items slightly left */
  background: transparent;
  position: sticky;
  top: 5rem;                         /* reduce default top margin by half */
  max-height: calc(100vh - 140px);
  overflow-y: auto;
  will-change: auto; /* Smooth scrolling performance */
}

/* Slightly widen body column on wide screens */
@media (min-width: 1200px) {
  .page-columns .content { padding-right: 2.25rem; max-width: var(--content-max-width) !important; }
}

/* Force Quarto grid to allocate a wider content track on desktop */
@media (min-width: 992px) {
  /* Left sidebar "docked" layout: increase body-content track max from ~1000px to our var */
  body.docked .page-columns {
    grid-template-columns: [screen-start] 1.5em [screen-start-inset page-start] minmax(50px, 100px) [page-start-inset] 50px [body-start-outset] 50px [body-start] 1.5em [body-content-start] minmax(500px, calc(min(var(--content-max-width), var(--page-max-width)) - 3em)) [body-content-end] 1.5em [body-end] 50px [body-end-outset] minmax(50px, 100px) [page-end-inset] 50px [page-end] 5fr [screen-end-inset] 1.5em [screen-end] !important;
  }

  /* Fullcontent variant */
  body.docked.fullcontent .page-columns {
    grid-template-columns: [screen-start] 1.5em [screen-start-inset page-start] minmax(50px, 100px) [page-start-inset] 50px [body-start-outset] 50px [body-start] 1.5em [body-content-start] minmax(500px, calc(min(var(--content-max-width), var(--page-max-width)) - 3em)) [body-content-end body-end body-end-outset page-end-inset page-end] 5fr [screen-end-inset] 1.5em [screen-end] !important;
  }

  /* Listing pages */
  body.docked.listing .page-columns {
    grid-template-columns: [screen-start] 1.5em [screen-start-inset page-start] minmax(50px, 100px) [page-start-inset] 50px [body-start-outset] 50px [body-start] 1.5em [body-content-start] minmax(500px, calc(min(var(--content-max-width), var(--page-max-width)) - 3em)) [body-content-end] 1.5em [body-end] 50px [body-end-outset] minmax(0px, 200px) [page-end-inset] 50px [page-end] 5fr [screen-end-inset] 1.5em [screen-end] !important;
  }
}

/* ========================================
   TOC ACTIVE/HOVER – FORCE GRAY BG, NO BLUE LEFT SHADOW
   High-specificity rules placed at end to win cascade
   ======================================== */
#quarto-margin-sidebar .nav.nav-pills .nav-link {
  background-color: transparent !important;
  border: 0 !important;
  box-shadow: none !important; /* remove blue inset/left glow */
}

#quarto-margin-sidebar .nav.nav-pills .nav-link:hover {
  background-color: transparent !important; /* no hover background for toc */
  box-shadow: none !important;
}

#quarto-margin-sidebar .nav.nav-pills .nav-link.active,
#quarto-margin-sidebar .nav.nav-pills .show > .nav-link,
#quarto-margin-sidebar .toc-active > .nav-link {
  background-color: rgba(0,0,0,0.06) !important; /* gray active */
  color: #276fb4 !important;                   /* restore blue active text */
  box-shadow: none !important;                 /* remove blue shadow */
  border-left: none !important;
}

#quarto-margin-sidebar .nav.nav-pills .nav-link.active::before,
#quarto-margin-sidebar .nav.nav-pills .nav-link::before {
  content: none !important; /* remove decorative left bar if present */
}

/* Ultra-specific fallback to ensure active item shows gray bg on all markups */
#quarto-margin-sidebar .active,
#quarto-margin-sidebar .active > a,
#quarto-margin-sidebar .nav .active > .nav-link,
#quarto-margin-sidebar .toc-active,
#quarto-margin-sidebar .toc-active > a,
#quarto-margin-sidebar .toc-active > .nav-link {
  background-color: rgba(0,0,0,0.06) !important; /* force gray bg */
  border-radius: 4px !important;
  box-shadow: none !important; /* remove blue shadow */
  border: none !important;
}

/* Hover fallback */
#quarto-margin-sidebar a.nav-link:hover,
#quarto-margin-sidebar .nav-link:hover,
#quarto-margin-sidebar .nav .nav-link:hover {
  background-color: transparent !important;
  box-shadow: none !important;
}

/* Ensure active ToC link is blue regardless of fallbacks */
#quarto-margin-sidebar nav a.nav-link.active,
#quarto-margin-sidebar nav a.active,
#quarto-margin-sidebar #TOC a.nav-link.active {
  color: #3a27b4 !important;
}

/* ========================================
   TOC CONTAINER GRAY BACKGROUND FIX
   Remove any background on the overall ToC panel and title while
   preserving the active item highlight set above.
   ======================================== */
#quarto-margin-sidebar #TOC,
#quarto-margin-sidebar #toc-title,
#quarto-margin-sidebar #TOC ul,
#quarto-margin-sidebar #TOC li {
  background: transparent !important;
}

/* --- Mathematical Callouts (Theorem Blocks) --- */
.math-theorem {
  --theorem-accent: #c81e1e;
  --theorem-accent-rgb: 200, 30, 30;
  --theorem-border: rgba(200, 30, 30, 0.28);
  position: relative;
  margin: 2.25rem 0;
  border-radius: 18px;
  background: #ececed !important; /* modern gray with subtle contrast */
  color: #0f172a !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  overflow: hidden;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  border: 1px solid var(--theorem-border);
}

.math-theorem::before {
  display: none;
}

.math-theorem::after {
  display: none;
}

.math-theorem:hover {
  transform: translateY(-3px);
  box-shadow: 0 32px 60px -36px rgba(15, 23, 42, 0.65);
}

.math-theorem:hover::before {
  opacity: 1;
}

.math-theorem:hover::after {
  opacity: 0.6;
}

.theorem-header {
  position: relative;
  z-index: 1;
  padding: 1.1rem 1.75rem 0.5rem;
  font-family: "Computer Modern", "CMU Serif", "IBM Plex Serif", serif;
  letter-spacing: 0.01em;
}

.theorem-header p {
  margin: 0 !important;
  padding: 0 !important;
}

.theorem-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0; /* no pill padding since badge has no background */
  border-radius: 0;
  font-size: 0.82rem; /* smaller than title for subtle emphasis */
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  font-family: "Computer Modern", "CMU Serif", "IBM Plex Serif", serif;
  background: transparent !important;
  color: var(--theorem-accent);
  border: 1px solid transparent;
  box-shadow: none;
  margin: 0 0.5rem 0 0; /* stick to left; keep small gap before title */
  line-height: 1.05; /* tighten vertical space to reduce header height */
}

.theorem-title {
  display: inline;
  font-weight: 700;
  font-size: 1.06rem;
  font-family: "Computer Modern", "CMU Serif", "IBM Plex Serif", serif;
  color: #172554 !important;
  margin: 0;
}

.theorem-content {
  position: relative;
  z-index: 1;
  padding: 0 1.75rem 1.6rem;
  font-family: "Computer Modern", "CMU Serif", "IBM Plex Serif", serif;
  color: #0f172a !important;
  line-height: 1.62;
}

.theorem-content > :first-child {
  margin-top: 0.25rem;
}

.theorem-content > :last-child {
  margin-bottom: 0;
}

.theorem-content .katex-display {
  margin: 0.75rem 0;
}

.math-theorem.definition {
  --theorem-accent: #2563eb;
  --theorem-accent-rgb: 37, 99, 235;
  --theorem-border: rgba(37, 99, 235, 0.28);
}

.math-theorem.theorem {
  --theorem-accent: #dc2626; /* bright red for theorems */
  --theorem-accent-rgb: 220, 38, 38;
  --theorem-border: rgba(220, 38, 38, 0.28);
}

.math-theorem.lemma {
  --theorem-accent: #0ea5e9;
  --theorem-accent-rgb: 14, 165, 233;
  --theorem-border: rgba(14, 165, 233, 0.28);
}

.math-theorem.proposition {
  --theorem-accent: #7c3aed; /* purple */
  --theorem-accent-rgb: 124, 58, 237;
  --theorem-border: rgba(124, 58, 237, 0.28);
}

.math-theorem.corollary {
  --theorem-accent: #f97316;
  --theorem-accent-rgb: 249, 115, 22;
  --theorem-border: rgba(249, 115, 22, 0.28);
}

.math-theorem.note,
.math-theorem.remark {
  --theorem-accent: #0891b2;
  --theorem-accent-rgb: 8, 145, 178;
  --theorem-border: rgba(8, 145, 178, 0.28);
}

/* Remark: quotation-like display (no card) */
.math-theorem.remark {
  background: transparent !important;
  border: none;
  border-left: 4px solid var(--theorem-accent);
  border-radius: 0;
  box-shadow: none;
  margin: 2rem 0;
}

.math-theorem.remark > p {
  margin: 0;
}

.math-theorem.remark > p .proof-title {
  display: none;
}

.math-theorem.remark:hover {
  transform: none;
  box-shadow: none;
}

.math-theorem.remark .theorem-header {
  padding: 0.6rem 1rem 0.25rem 1.1rem;
}

.math-theorem.remark .theorem-content {
  padding: 0 1rem 0.9rem 1.1rem;
}

.math-theorem.example {
  --theorem-accent: #059669;
  --theorem-accent-rgb: 5, 150, 105;
  --theorem-border: rgba(5, 150, 105, 0.24);
}

.math-theorem.proof {
  --theorem-accent: #4b5563;
  --theorem-accent-rgb: 75, 85, 99;
  --theorem-border: rgba(75, 85, 99, 0.24);
}

.theorem-title:empty {
  display: none;
}
.math-theorem.assumption {
  --theorem-accent: #e11d48;
  --theorem-accent-rgb: 225, 29, 72;
  --theorem-border: rgba(225, 29, 72, 0.28);
}

.math-theorem.claim {
  --theorem-accent: #1d4ed8;
  --theorem-accent-rgb: 29, 78, 216;
  --theorem-border: rgba(29, 78, 216, 0.28);
}
.theorem-title {
  font-style: italic;
}
