---
date: 2026-02-10
---

## 3.1 Error Estimates (A Priori)

For a standard second-order elliptic problem (e.g., Poisson equation $-u'' = f$), the error between the exact solution $u$ and the finite element approximation $u_h$ is bounded by the mesh size $h$.

The central estimate is:
$$
\| u - u_h \|_{H^1} \le C h | u |_{H^2}
$$



> [!remark] remark
> We have **linear convergence** in the $H^1$ norm. If you halve the mesh size $h$, the error is cut in half.


## 3.2 The Stiffness Matrix Assembly

We discretize the domain $\Omega = [a, b]$ into elements using nodes $x_i$:

* **Basis Functions $\varphi_i(x)$**: We use piecewise linear "hat" functions where $\varphi_i(x_j) = \delta_{ij}$ (1 if $i=j$, 0 otherwise).
* **Sparsity**: $\varphi_i$ and $\varphi_j$ only overlap if nodes $i$ and $j$ are neighbors. This results in a **Tridiagonal Matrix**.

$$
A_{ij} = 
\begin{bmatrix} 
\ddots & \ddots & 0 \\
\ddots & \text{diag} & \ddots \\
0 & \ddots & \ddots 
\end{bmatrix}
$$

### 3.2.1 Problem Formulation: Reaction-Diffusion

The notes introduce the equation:
$$
-u'' + \sigma u = f
$$
The weak formulation requires finding $u_h$ such that for all test functions $v_h$:
$$
\underbrace{\int_a^b u' v' \, dx}_{\text{Stiffness Term}} + \underbrace{\sigma \int_a^b u v \, dx}_{\text{Mass Term}} = \int_a^b f v \, dx
$$

## 3.3 Local vs. Global Assembly

To build the matrix $A$, we calculate integrals on each **local element** (interval $[x_i, x_{i+1}]$ of length $h$) and then sum them into the **global matrix**.

### 3.3.1 Local Element Matrix (for one interval)
For a single element of length $h$, the local matrix $A^e$ is a $2\times2$ matrix combining the stiffness and mass terms.

**1. Stiffness Part ($-\frac{d^2}{dx^2}$):**
$$
K^e = \frac{1}{h} \begin{bmatrix} 1 & -1 \\ -1 & 1 \end{bmatrix}
$$

**2. Mass Part ($\sigma$):**
$$
M^e = \frac{\sigma h}{6} \begin{bmatrix} 2 & 1 \\ 1 & 2 \end{bmatrix}
$$

**Total Local Matrix:**
$$
A^e = K^e + M^e
$$

### 0.3.2 Global Assembly

The handwritten notes highlight $A_{11}^*$. This represents a diagonal entry in the global matrix. A node $x_i$ belongs to **two** elements (left and right). Therefore, we sum the contributions:

$$
A_{ii}^{\text{global}} = \underbrace{A_{11}^{\text{left}}}_{\text{from } [x_{i-1}, x_i]} + \underbrace{A_{00}^{\text{right}}}_{\text{from } [x_i, x_{i+1}]}
$$

Explicitly:
$$
A_{ii} = \left( \frac{1}{h} + \frac{\sigma h}{3} \right) + \left( \frac{1}{h} + \frac{\sigma h}{3} \right) = \frac{2}{h} + \frac{2\sigma h}{3}
$$
