<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>03 Numerical Solution of Ordinary Differential Equations – Erise Note</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap-b337f537912f5ab074b938eebad4c5d7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Erise Note</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../content/notes/index.md"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../content/posts/index.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/EriseHe/notebook"> 
<span class="menu-text">GitHub</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../content/notes/理论/偏微分方程/Laplace Equation/index.html">偏微分方程</a></li><li class="breadcrumb-item"><a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/index.html">数值方法</a></li><li class="breadcrumb-item"><a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/03 Numerical Solution of Ordinary Differential Equations.html">常微分方程的数值解</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../../../../index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">偏微分方程</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/Laplace Equation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">拉普拉斯方程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/Wave Equation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">波方程</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/偏微分方程/Heat Equation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">热方程</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/Heat Equation/Heat Equation Solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Heat Equation Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/Heat Equation/The Fourier Series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">傅立叶级数</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数值方法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/01 Mid-Point Method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 Mid-Point Method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/02 Three-Point Backward Differentiation Formula.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02 Three-Point Backward Differentiation Formula</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/03 Numerical Solution of Ordinary Differential Equations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">常微分方程的数值解</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第九章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第九章</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第九章/9.1 Boundary Value Problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.1 边值问题的近似</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第九章/9.2 Finite Difference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.2 有限差分法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第九章/9.3 Advection-Diffusion Equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.3 对流-扩散方程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第九章/9.4 2D Problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.4 4.1 二维（2D）偏微分方程问题</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第九章/Exercise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">习题</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第十章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第十章</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第十章/Finite Element Method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finite Element Method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第十章/Quiz 4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz 4</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第四章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第四章 有限元分析</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/第四章/4.1 有限元.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.1 有限元</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">实分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/实分析/Homework/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Real Analysis II</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/Homework/Homework 10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/Homework/Homework 11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 11</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/Homework/Homework 6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/Homework/Homework 7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/Homework/Homework 8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/Homework/Homework 9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 9</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/实分析/第七章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第七章 逆函数和隐函数定理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第七章/7.1 Inverse Function Theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.1 反函数定理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第七章/7.1.1 Inverse FT (Proof).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.1.1 反函数定理（证明）</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第七章/7.2 Implicit Function Theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.2 隐函数定理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第七章/7.6 Morse Lemma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.6 莫尔斯引理</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/实分析/第九章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第九章</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第九章/9.1 Computing Integrals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">积分计算</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/实分析/第八章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第八章 度量理论</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第八章/8.1 度量理论.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.1 度量理论</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第八章/8.2 Criterion for Integrability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.2 Criterion for Integrability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第八章/8.3 Proof of Lebesgue's Theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.3 Proof of Lebesgue’s Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第八章/8.5 Improper Integral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.5 不定积分</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第八章/8.6 Lebesgue Convergence Theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.6 勒贝格收敛定理</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/实分析/第六章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第六章 可微映射</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第六章/6.4 Sufficient Conditions for Differentiability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.4 可微分性的必要条件</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第六章/6.5 The Chain Rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.5 链式法则</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第六章/6.6 Product Rule and Gradients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.6 乘积法则与梯度</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第六章/6.9 Taylor Higher Dimentions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.9 泰勒公式的高维形式</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/实分析/第十章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第十章</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/实分析/第十章/10.1 Fourier Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10.1 Fourier Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true">
 <span class="menu-text">微分几何笔记</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/微分几何笔记/广义相对论（GR）/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">广义相对论</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/广义相对论（GR）/1. Four-Vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">四维向量</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/广义相对论（GR）/12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/广义相对论（GR）/2. Einstein Summation Convention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Einstein求和约定</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/广义相对论（GR）/3. Index Notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">指标</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/广义相对论（GR）/6. Tensor Equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">张量方程</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">有关曲面的基础概念</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/1. 概述.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. 概述</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/2. 参数化曲线与曲面.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. 参数化曲线与曲面</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/3. tagent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. tagent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/3. 曲面上的切向量.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. 曲面上的切向量</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/4. 第一基本形式.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. 第一基本形式</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/5. 前推，回拉，以及和局部等距.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. 前推，回拉，以及和局部等距</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/6..html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/7..html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/8..html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/微分几何笔记/有关曲面的基础概念/9..html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true">
 <span class="menu-text">拓扑学笔记</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/拓扑学笔记/T-n分离公理.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T-n分离公理</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="true">
 <span class="menu-text">概率机器学习</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/理论/概率机器学习/自回归模型（AR）/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">index</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/概率机器学习/自回归模型（AR）/Autoregressive模型.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Autoregressive模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/概率机器学习/自回归模型（AR）/Recurrent Neural Networks (RNN).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Autoregressive模型 &amp; Recurrent Neural Networks (RNN)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/概率机器学习/自回归模型（AR）/Transformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Transformer</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false">
 <span class="menu-text">强化学习（RL）</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/概率机器学习/强化学习（RL）/Markov奖励&amp;决策过程.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markov奖励&amp;决策过程</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false">
 <span class="menu-text">隐藏变量模型</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-21" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/概率机器学习/隐藏变量模型/GANs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GANs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/概率机器学习/隐藏变量模型/Normalizing Flows (NF).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Normalizing Flows (NF)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/理论/概率机器学习/隐藏变量模型/VAE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">VAE</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="true">
 <span class="menu-text">IllustrateTNG Simulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-22" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/IllustrateTNG Simulation/Viewing Angle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Viewing Angle</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/计算/Julia科学计算笔记/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Julia科学计算笔记</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-23" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/Julia科学计算笔记/0 基本语法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">0 基本语法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/Julia科学计算笔记/I 变量、基本类型和函数.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">I 变量、基本类型和函数</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/Julia科学计算笔记/II ODEs与分子动力学.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">II ODEs与分子动力学</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="true">
 <span class="menu-text">量子力学讲义</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-24" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/波函数存在于在Hilbert空间中.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">波函数存在于Hilbert空间中</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/薛定谔方程的傅立叶变换.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">薛定谔方程的傅立叶变换</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false">
 <span class="menu-text">Lecture</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-25" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/Lecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/第一章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第一章</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-26" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/第一章/1.1 The Wave Function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.1 The Wave Function</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/第四章/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第四章</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-27" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/第四章/4.1 经典氢原子.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.1 经典氢原子</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/第四章/4.2 Hydrogen Atom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">氢原子</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/第四章/4.3 角动量 (Angular Momentum).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.3 角动量 (Angular Momentum)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/第四章/4.4 Spin Spin Spin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.4 Spin Spin Spin</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/notes/计算/量子力学讲义/Lecture/第四章/第四章.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">第四章</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#local-theorem" id="toc-local-theorem" class="nav-link" data-scroll-target="#local-theorem">Local Theorem</a></li>
  <li><a href="#global-theorem" id="toc-global-theorem" class="nav-link" data-scroll-target="#global-theorem">Global Theorem</a></li>
  </ul></li>
  <li><a href="#stability-definitions" id="toc-stability-definitions" class="nav-link" data-scroll-target="#stability-definitions">Stability Definitions</a></li>
  <li><a href="#remark" id="toc-remark" class="nav-link" data-scroll-target="#remark">Remark</a></li>
  <li><a href="#some-simple-examples" id="toc-some-simple-examples" class="nav-link" data-scroll-target="#some-simple-examples">Some Simple Examples</a></li>
  <li><a href="#analysis-of-forward-euler" id="toc-analysis-of-forward-euler" class="nav-link" data-scroll-target="#analysis-of-forward-euler">Analysis of Forward Euler</a></li>
  <li><a href="#convergence-of-forward-euler" id="toc-convergence-of-forward-euler" class="nav-link" data-scroll-target="#convergence-of-forward-euler">Convergence of Forward Euler</a></li>
  <li><a href="#other-one-step-methods" id="toc-other-one-step-methods" class="nav-link" data-scroll-target="#other-one-step-methods">Other One-Step Methods</a>
  <ul class="collapse">
  <li><a href="#crank-nicolson" id="toc-crank-nicolson" class="nav-link" data-scroll-target="#crank-nicolson">Crank-Nicolson</a></li>
  <li><a href="#heun" id="toc-heun" class="nav-link" data-scroll-target="#heun">Heun</a></li>
  <li><a href="#the-concept-of-zero-stability" id="toc-the-concept-of-zero-stability" class="nav-link" data-scroll-target="#the-concept-of-zero-stability">The Concept of Zero-Stability</a></li>
  <li><a href="#the-concept-of-absolute-stability" id="toc-the-concept-of-absolute-stability" class="nav-link" data-scroll-target="#the-concept-of-absolute-stability">The Concept of Absolute Stability</a>
  <ul class="collapse">
  <li><a href="#remark-1" id="toc-remark-1" class="nav-link" data-scroll-target="#remark-1">Remark</a></li>
  </ul></li>
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition">DEFINITION</a></li>
  <li><a href="#another-example-heun" id="toc-another-example-heun" class="nav-link" data-scroll-target="#another-example-heun">Another Example: Heun</a></li>
  <li><a href="#remark-we-found-that-the-explicit-methods-are-conditionally-stable-while-the-implicit-ones-are-unconditionally-stable." id="toc-remark-we-found-that-the-explicit-methods-are-conditionally-stable-while-the-implicit-ones-are-unconditionally-stable." class="nav-link" data-scroll-target="#remark-we-found-that-the-explicit-methods-are-conditionally-stable-while-the-implicit-ones-are-unconditionally-stable.">REMARK: We found that the explicit methods are conditionally stable, while the implicit ones are unconditionally stable.</a></li>
  </ul></li>
  <li><a href="#multistep-methods" id="toc-multistep-methods" class="nav-link" data-scroll-target="#multistep-methods">Multistep Methods</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example:</a></li>
  <li><a href="#bdf-backward-difference-formulas" id="toc-bdf-backward-difference-formulas" class="nav-link" data-scroll-target="#bdf-backward-difference-formulas">BDF (Backward Difference Formulas)</a></li>
  <li><a href="#adams" id="toc-adams" class="nav-link" data-scroll-target="#adams">Adams</a></li>
  <li><a href="#a-rapid-recall-of-difference-equations-theory" id="toc-a-rapid-recall-of-difference-equations-theory" class="nav-link" data-scroll-target="#a-rapid-recall-of-difference-equations-theory">A Rapid Recall of Difference Equations Theory</a></li>
  <li><a href="#zero-stability-definition" id="toc-zero-stability-definition" class="nav-link" data-scroll-target="#zero-stability-definition">Zero-Stability Definition</a></li>
  <li><a href="#analysis-of-multistep-methods" id="toc-analysis-of-multistep-methods" class="nav-link" data-scroll-target="#analysis-of-multistep-methods">Analysis of Multistep Methods</a></li>
  <li><a href="#a-clarification-on-stability-concepts" id="toc-a-clarification-on-stability-concepts" class="nav-link" data-scroll-target="#a-clarification-on-stability-concepts">A Clarification on Stability Concepts</a></li>
  <li><a href="#example-extreme" id="toc-example-extreme" class="nav-link" data-scroll-target="#example-extreme">Example (Extreme)</a></li>
  <li><a href="#predictor-corrector-methods" id="toc-predictor-corrector-methods" class="nav-link" data-scroll-target="#predictor-corrector-methods">Predictor-Corrector Methods</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples:</a></li>
  <li><a href="#runge-kutta-methods" id="toc-runge-kutta-methods" class="nav-link" data-scroll-target="#runge-kutta-methods">Runge-Kutta Methods</a></li>
  <li><a href="#derivation-of-an-explicit-rk-method" id="toc-derivation-of-an-explicit-rk-method" class="nav-link" data-scroll-target="#derivation-of-an-explicit-rk-method">Derivation of an Explicit RK Method</a></li>
  <li><a href="#analysis-of-rk" id="toc-analysis-of-rk" class="nav-link" data-scroll-target="#analysis-of-rk">Analysis of RK</a></li>
  <li><a href="#absolute-stability" id="toc-absolute-stability" class="nav-link" data-scroll-target="#absolute-stability">ABSOLUTE STABILITY</a></li>
  <li><a href="#why-are-rk-so-popular" id="toc-why-are-rk-so-popular" class="nav-link" data-scroll-target="#why-are-rk-so-popular">Why are RK so popular?</a></li>
  <li><a href="#a-final-note-on-stiff-problems" id="toc-a-final-note-on-stiff-problems" class="nav-link" data-scroll-target="#a-final-note-on-stiff-problems">A Final Note on Stiff problems</a></li>
  <li><a href="#exercise-on-lmm" id="toc-exercise-on-lmm" class="nav-link" data-scroll-target="#exercise-on-lmm">EXERCISE on LMM</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../content/notes/理论/偏微分方程/Laplace Equation/index.html">偏微分方程</a></li><li class="breadcrumb-item"><a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/index.html">数值方法</a></li><li class="breadcrumb-item"><a href="../../../../../content/notes/理论/偏微分方程/MATH 352 PDE in Action/03 Numerical Solution of Ordinary Differential Equations.html">常微分方程的数值解</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">常微分方程的数值解</h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The subject of this Chapter is the numerical approximation of the Cauchy problem:</p>
<p><span class="math display">\[(1) \quad \frac{dy}{dt} = f(t,y) \quad \text{in } t &gt; 0 \quad (I.C.)\]</span></p>
<p>with <span class="math display">\[y(0) = y_0 \text{ given}.\]</span></p>
<p>or, more in general, a system:</p>
<p><span class="math display">\[(2) \quad \frac{d\mathbf{y}}{dt} = \mathbf{f}(t,\mathbf{y}) \quad \text{in } t &gt; 0\]</span></p>
<p>with <span class="math display">\[\mathbf{y}(0) = \mathbf{y}_0.\]</span></p>
<p>Let’s recall some basic results on the function <span class="math inline">\(f\)</span>. It is said to be Lipschitz continuous in an interval <span class="math inline">\(I\)</span> if there exists a positive <span class="math inline">\(L &gt; 0\)</span> s.t.</p>
<p><span class="math display">\[|f(t,y_1) - f(t,y_2)| &lt; L |y_1 - y_2|.\]</span></p>
<p>Clearly, if <span class="math inline">\(f\)</span> is differentiable with continuity in <span class="math inline">\(I\)</span>, it is also Lipschitz continuous with <span class="math inline">\(L \leq \max_I \left|\frac{\partial f}{\partial y}\right|\)</span>.</p>
<section id="local-theorem" class="level3">
<h3 class="anchored" data-anchor-id="local-theorem">Local Theorem</h3>
<p>If <span class="math inline">\(f\)</span> is Lipschitz continuous in a range <span class="math inline">\(t \in I_1\)</span> and <span class="math inline">\(y \in I \subseteq \mathbb{R}\)</span>, then <span class="math inline">\(\exists\)</span> an interval <span class="math inline">\(\hat{I} \subseteq I\)</span> where the solution to <span class="math inline">\((1)\)</span> exists and is unique.</p>
</section>
<section id="global-theorem" class="level3">
<h3 class="anchored" data-anchor-id="global-theorem">Global Theorem</h3>
<p>If the <span class="math inline">\(f\)</span> is Lipschitz continuous <span class="math inline">\(\forall t \in I\)</span> and <span class="math inline">\(y \in \mathbb{R}\)</span>, then the solution <span class="math inline">\(\exists\)</span> uniquely in <span class="math inline">\(I\)</span>.</p>
</section>
</section>
<section id="stability-definitions" class="level2">
<h2 class="anchored" data-anchor-id="stability-definitions">Stability Definitions</h2>
<p>From the practical point of view, it is important to consider also the perturbed case:</p>
<p><span class="math display">\[(1_\epsilon): \quad \frac{dy_\epsilon}{dt} = f(t, y_\epsilon) + \delta(t) \quad t \geq 0\]</span></p>
<p><span class="math display">\[y^\epsilon(0) = y_0 + \epsilon\]</span></p>
<p>with <span class="math inline">\(|\delta(t)| \leq \epsilon \quad \forall t \geq 0\)</span></p>
<p>If there exists a finite constant <span class="math inline">\(C\)</span> such that</p>
<p><span class="math display">\[|y - y_\epsilon| &lt; C\epsilon \quad (*)\]</span></p>
<p>then we say that the solution is Lyapunov stable.</p>
<p>In general, <span class="math inline">\(C\)</span> may depend on <span class="math inline">\(t\)</span>, so that <span class="math inline">\((*)\)</span> may hold on finite intervals (and not over the entire <span class="math inline">\([0,\infty)\)</span> axis).</p>
<p>To have a stronger concept, we advocate the ASYMPTOTIC STABILITY:</p>
<p><span class="math display">\[\lim_{t \to \infty} |y(t) - y_\epsilon(t)| = 0.\]</span></p>
<p>From the engineering point of view, this is a central concept, as the theory of control (Automatical Control, Feedback control) relies on this definition.</p>
</section>
<section id="remark" class="level2">
<h2 class="anchored" data-anchor-id="remark">Remark</h2>
<p>The Cauchy problem has a formal (quite useless) solution:</p>
<p><span class="math display">\[y(t) = y_0 + \int_0^t f(\tau, y(\tau))d\tau\]</span></p>
<p>connecting the solution in <span class="math inline">\(t\)</span> with its past.</p>
<p>This is basically an alternative formulation of the problem and, in fact, will be used to formulate possible numerical approximation alternative to the ones based on <span class="math inline">\((1)\)</span>.</p>
</section>
<section id="some-simple-examples" class="level2">
<h2 class="anchored" data-anchor-id="some-simple-examples">Some Simple Examples</h2>
<p>To begin with, we can split the time interval in subintervals, for instance with a uniform reticulation with step <span class="math inline">\(\Delta t\)</span>.</p>
<p>![Time discretization with points at 0, Δt, 2Δt, 3Δt…]</p>
<p>Then, we can use the formula:</p>
<p><span class="math display">\[\frac{dy}{dt}(t_i) \simeq \frac{y(t_{i+1}) - y(t_i)}{\Delta t}\]</span></p>
<p>that we know is accurate with an error scaling with <span class="math inline">\(\Delta t\)</span>. In this way, we have:</p>
<p>[From now on, the approximation of the solution <span class="math inline">\(y(t)\)</span> in <span class="math inline">\(t_i\)</span> will be denoted with <span class="math inline">\(u_i\)</span>]</p>
<p><span class="math display">\[\frac{u_{i+1} - u_i}{\Delta t} = f(t_i, u_i)\]</span></p>
<p>In practice, starting at <span class="math inline">\(t = 0\)</span>: <span class="math display">\[\begin{align}
u_1 &amp;= u_0 + \Delta t \, f(t_0, u_0) \quad \rightsquigarrow \quad (u_0 = y_0) \\
u_2 &amp;= u_1 + \Delta t \, f(t_1, u_1)
\end{align}\]</span></p>
<p>We can easily compute the approximation <span class="math inline">\(u_i\)</span> of <span class="math inline">\(y(t_i)\)</span>.</p>
<p>On the other hand, we could do:</p>
<p><span class="math display">\[\frac{u_i - u_{i-1}}{\Delta t} = f(t_i, u_i)\]</span></p>
<p>leading to:</p>
<p><span class="math display">\[u_1 = u_0 + \Delta t \, f(t_1, u_1) \quad (u_0 = y_0)\]</span></p>
<p>This is not as easy as before: it’s a NONLINEAR (ALGEBRAIC) EQUATION; we know how to solve it (first Chapter), but it is a computational additional cost. Then, similarly, we have:</p>
<p><span class="math display">\[u_2 = u_1 + \Delta t \, f(t_2, u_2)\]</span></p>
<p>We have also another option:</p>
<p><span class="math display">\[\frac{dy}{dt}(t_i) \simeq \frac{u_{i+1} - u_{i-1}}{2\Delta t}\]</span></p>
<p>In this case, the error scales with <span class="math inline">\(O(\Delta t^2)\)</span>. So, in practice we have:</p>
<p><span class="math display">\[u_{i+1} = 2\Delta t \, f(t_i, u_i) + u_{i-1}\]</span></p>
<p>or specifically: <span class="math inline">\(u_2 = 2\Delta t \, f(t_1, u_1) + u_0 \quad (u_0 = y_0)\)</span></p>
<p>I need to know <span class="math inline">\(u_1\)</span>, not just <span class="math inline">\(u_0\)</span>, then we can use the method.</p>
<p>With these three examples, we have already found many possible types of methods:</p>
<p><strong>Implicit vs Explicit</strong> - <strong>Implicit</strong>: Solve a non-linear equation - <strong>Explicit</strong>: No need of solving equations</p>
<p><strong>One Step vs Multistep</strong> - <strong>One Step</strong>: <span class="math inline">\(u_{i+1} = g(\Delta t, u_i)\)</span> - <strong>Multistep</strong>: <span class="math inline">\(u_{i+1} = g(\Delta t, u_i, u_{i-1}, u_{i-2}...)\)</span></p>
<p>At the top of this, we have the problem of the accuracy and - even most importantly- of the CONVERGENCE.</p>
<p>In fact, the basic requirement we need is that the method is convergent:</p>
<p><span class="math display">\[\lim_{\Delta t \to 0} |y(t_i) - u_i| = 0\]</span></p>
<p>Then, if we find that <span class="math inline">\(|y(t_i) - u_i| \sim O(\Delta t^p)\)</span> then the accuracy or the order of the method is <span class="math inline">\(p\)</span>.</p>
<p>Nature (implicit/explicit), Number of steps and most important CONVERGENCE and accuracy (order) are the categories for analyzing and ranking different methods.</p>
<p>Before we embark ourselves in a general analysis, however, let’s focus on a specific case, where important concepts will be highlighted.</p>
</section>
<section id="analysis-of-forward-euler" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-forward-euler">Analysis of Forward Euler</h2>
<p>The method:</p>
<p><span class="math display">\[\frac{u_{i+1} - u_i}{\Delta t} = f(t_i, u_i)\]</span></p>
<p>is called Forward Euler.</p>
<p>Let’s consider it in detail.</p>
<p>To start with, let’s introduce the distinction of “consistency” and truncation error.</p>
<p>If we have the exact solution <span class="math inline">\(y_{ex}(t)\)</span> it is easily realized that</p>
<p><span class="math display">\[\frac{y_{ex}(t_{i+1}) - y_{ex}(t_i)}{\Delta t} \neq f(t_i, y_{ex}(t_i))\]</span></p>
<p>For instance,</p>
<p><span class="math display">\[\frac{dy}{dt} = \lambda y \quad y(0) = 1 \implies y_{ex} = e^{\lambda t}\]</span></p>
<p>then</p>
<p><span class="math display">\[\frac{e^{\lambda(t_i+\Delta t)} - e^{\lambda t_i}}{\Delta t} = e^{\lambda t_i} \frac{e^{\lambda \Delta t} - 1}{\Delta t} \neq \lambda e^{\lambda t_i} \quad (\lambda y(t_i))\]</span></p>
<p>We can be more specific:</p>
<p><span class="math display">\[y_{ex}(t_{i+1}) = y_{ex}(t_i) + \frac{dy_{ex}}{dt}(t_i)\Delta t + \frac{1}{2}\frac{d^2y_{ex}}{dt^2}(t_i)\Delta t^2 + ...\]</span></p>
<p>Now:</p>
<p><span class="math display">\[\frac{y_{ex}(t_{i+1}) - y_{ex}(t_i)}{\Delta t} = \frac{dy_{ex}(t_i)}{dt} + \frac{1}{2}\frac{d^2y_{ex}(t_i)}{dt^2}\Delta t + ...\]</span></p>
<p>This gives us:</p>
<p><span class="math display">\[\frac{y_{ex}(t_{i+1}) - y_{ex}(t_i)}{\Delta t} = f(t_i, y_{ex}(t_i)) + \left[\frac{\Delta t}{2}\frac{d^2y_{ex}}{dt^2}\right]\]</span></p>
<p>Forward Euler <span class="math inline">\(\quad \quad \quad\)</span> Local Truncation Error (LTE)</p>
<p>In some sense, the truncation error is the residual we get when we pretend the exact solution to solve the numerical scheme.</p>
<p>Now, to investigate how the error of Forward Euler works, let’s consider the following picture:</p>
<p>![Error propagation diagram showing exact solution trajectory and numerical approximation]</p>
<p>From the picture it is evident that the error:</p>
<p><span class="math display">\[e_{i+1} = y_{ex}(t_{i+1}) - u_{i+1}\]</span></p>
<p>is the result of two contributions:</p>
<p><span class="math display">\[e_{i+1} = \underbrace{y_{ex}(t_{i+1}) - u^*_{i+1}}_{\text{generated at the local step}} + \underbrace{u^*_{i+1} - u_{i+1}}_{\text{propagated from previous steps}}\]</span></p>
<p>From the previous definition:</p>
<p><span class="math display">\[y_{ex}(t_{i+1}) = y_{ex}(t_i) + \Delta t \, f(t_i, y_{ex}(t_i)) + \Delta t \, \tau_{i+1}\]</span></p>
<p>where <span class="math inline">\(\tau_{i+1} = \frac{\Delta t}{2}\frac{d^2y_{ex}(t_i)}{dt^2}\)</span> is the local TE.</p>
<p><span class="math display">\[u^*_{i+1} = y_{ex}(t_i) + \Delta t \, f(t_i, y_{ex}(t_i))\]</span></p>
<p><span class="math display">\[y_{ex}(t_{i+1}) - u^*_{i+1} = \Delta t \, \tau_i\]</span></p>
<p>Now, let’s focus on the other part.</p>
<p>This second component <span class="math inline">\(u^*_{i+1} - u_{i+1}\)</span> is inherited from the previous errors.</p>
<p><span class="math display">\[u^*_{i+1} = y_{ex}(t_i) + \Delta t \, f(t_i, y_{ex}(t_i))\]</span> <span class="math display">\[u_{i+1} = u_i + \Delta t \, f(t_i, u_i)\]</span></p>
<p>Using the Lipschitz assumption <span class="math inline">\(|f(t,y) - f(t,u)| \leq L |y-u|\)</span> we have:</p>
<p><span class="math display">\[|u^*_{i+1} - u_{i+1}| \leq |e_i| + \Delta t \, L |e_i| = (1 + \Delta t \, L)|e_i|\]</span></p>
<p>where <span class="math inline">\(e_i = y_{ex}(t_i) - u_i\)</span></p>
<p>All together, we have:</p>
<p><span class="math display">\[|e_{i+1}| \leq \Delta t |\tau_i| + (1 + \Delta t \, L)|e_i|\]</span></p>
<p>Now, take <span class="math inline">\(|\tau^*| = \max_i |\tau_i| = \text{GLOBAL TRUNCATION ERROR}\)</span>.</p>
<p>Then:</p>
<p><span class="math display">\[|e_{i+1}| \leq \underbrace{\Delta t |\tau^*|}_{\text{local}} + \underbrace{(1 + \Delta t \, L)}_{\text{propagated}}|e_i|\]</span></p>
<p>Assume that <span class="math inline">\(e_0 = 0\)</span> (no errors on the initial conditions). Then we have:</p>
<p><span class="math display">\[|e_1| \leq \Delta t |\tau^*|\]</span> <span class="math display">\[|e_2| \leq \Delta t |\tau^*| + (1 + \Delta t \, L)|e_1| \leq \Delta t |\tau^*|(1 + (1+\Delta t \, L))\]</span> <span class="math display">\[|e_3| \leq \Delta t |\tau^*| + (1+\Delta t \, L)|e_2| \leq \Delta t |\tau^*|(1 + (1+\Delta t \, L) + (1+\Delta t \, L)^2)\]</span></p>
<p>We infer:</p>
<p><span class="math display">\[|e_K| \leq \Delta t |\tau^*| \sum_{j=0}^{K-1}(1+\Delta t \, L)^j = \Delta t |\tau^*|\frac{(1+\Delta t \, L)^K - 1}{1 - 1 - \Delta t \, L} = \frac{|\tau^*|}{L}((1+\Delta t \, L)^K - 1)\]</span></p>
<p>Notice that:</p>
<p><span class="math display">\[(1 + x)^K \leq \exp(xK)\]</span></p>
<p>So:</p>
<p><span class="math display">\[|e_K| \leq \frac{|\tau^*|}{L}(\exp(LKh) - 1) = \frac{|\tau^*|}{L}(\exp(Lt_K) - 1)\]</span></p>
<p>where <span class="math inline">\(K\Delta t = t_K\)</span></p>
<p>Now, if we want to have a bound on the error in the interval <span class="math inline">\([0,T]\)</span>, we have:</p>
<p><span class="math display">\[|e| \leq \frac{|\tau^*|}{L}(\exp(LT) - 1)\]</span></p>
<p>We have proved the following Theorem:</p>
</section>
<section id="convergence-of-forward-euler" class="level2">
<h2 class="anchored" data-anchor-id="convergence-of-forward-euler">Convergence of Forward Euler</h2>
<p>If the initial data are exact, and <span class="math inline">\(f\)</span> is Lipschitz continuous with respect to the <span class="math inline">\(y\)</span>-argument, with a solution <span class="math inline">\(\in C^2(0,T)\)</span>, then FE converges.</p>
<p>In fact:</p>
<p><span class="math display">\[|\tau^*| = \frac{1}{2}\Delta t \max_i |y^{''}| \xrightarrow{\Delta t \to 0} 0\]</span></p>
<p>and <span class="math inline">\(|e| \leq |\tau^*|\frac{\exp(LT) - 1}{L} \xrightarrow{\Delta t \to 0} 0\)</span> is bounded.</p>
<p><strong>FE is convergent with order 1.</strong></p>
<p>Beyond the Theorem per se (we will generalize it to other methods), it is important to notice that the convergence is the consequences of two peculiarities:</p>
<p><strong>(1)</strong> <span class="math inline">\(\tau^* \xrightarrow{\Delta t \to 0} 0\)</span> the LTE/GTE vanishes as <span class="math inline">\(\Delta t \to 0\)</span>, so locally the error is under control.</p>
<p>This property is called <strong>CONSISTENCY</strong>.</p>
<p><strong>(2)</strong> The factor <span class="math inline">\(\frac{\exp(LT) - 1}{L}\)</span> is independent of <span class="math inline">\(\Delta t\)</span> (or, in general, doesn’t blow up for <span class="math inline">\(\Delta t \to 0\)</span>). This is related to the way the error propagates so it is a “global” property through the constant <span class="math inline">\(L\)</span>.</p>
<p>The control of the error in time is called <strong>STABILITY</strong>.</p>
<p>In some sense, we can say that:</p>
<p><strong>CONVERGENCE = CONSISTENCY + STABILITY</strong></p>
<p>In spite of the intuitive arguments we used here, we will see that this is a good representation of general results (Lax-Richtmyer equivalence Theorem) holding for method using linear combinations of the function <span class="math inline">\(f\)</span> evaluated in the points <span class="math inline">\((t_i, u_i)\)</span>.</p>
</section>
<section id="other-one-step-methods" class="level1">
<h1>Other One-Step Methods</h1>
<p>So far, we have two one-step methods (forward and backward Euler). Let’s see other two. It is instructive to see how they are devised.</p>
<section id="crank-nicolson" class="level2">
<h2 class="anchored" data-anchor-id="crank-nicolson">Crank-Nicolson</h2>
<p>From <span class="math inline">\(y(t) = y_0 + \int_0^t f(\tau, y(\tau))d\tau\)</span> we can organize the following method:</p>
<p>![Timeline showing points <span class="math inline">\(t_0, t_1, t_2, t_3, t_4, t_5, t_6, t_7\)</span>]</p>
<p>Localize: <span class="math inline">\(y(t_{n+1}) = y(t_n) + \int_{t_n}^{t_{n+1}} f(\tau, y(\tau)) d\tau\)</span></p>
<p>Discretize: approximate the integral with the trapezoidal rule:</p>
<p><span class="math display">\[u_{n+1} = u_n + \frac{f(t_{n+1}, u_{n+1}) + f(t_n, u_n)}{2} \Delta t\]</span></p>
<p>This is a Second Order (EXERCISE) one-step implicit method.</p>
</section>
<section id="heun" class="level2">
<h2 class="anchored" data-anchor-id="heun">Heun</h2>
<p>Let’s start from Crank-Nicolson and make it “explicit”.</p>
<p>On the right hand side of CN we set:</p>
<p><span class="math display">\[u_{n+1} \simeq u_n + \Delta t \, f(t_n, u_n) \quad \text{(Explicit Euler)}\]</span></p>
<p>We obtain the scheme:</p>
<p><span class="math display">\[u_{n+1} = u_n + \Delta t \frac{f(t_{n+1}, u_n+\Delta t f(t_n, u_n)) + f(t_n, u_n)}{2}\]</span></p>
<p>This is called Heun. It is One-step, still 2nd order (EXERCISE).</p>
</section>
<section id="the-concept-of-zero-stability" class="level2">
<h2 class="anchored" data-anchor-id="the-concept-of-zero-stability">The Concept of Zero-Stability</h2>
<p>Let’s start applying the concept to one-step methods in the form:</p>
<p><span class="math display">\[u_{n+1} = u_n + \Delta t \, \Phi(u_n, t_n, f_n; \Delta t)\]</span></p>
<p>Let’s consider the perturbed scheme:</p>
<p><span class="math display">\[\begin{cases}
w_{n+1} = w_n + \Delta t (\Phi(z_n, t_n, f(t_n, z_n); \Delta t) + \delta_n) \\
w_0 = y_0 + \delta_0 &amp; \text{with } |\delta_i| \leq \varepsilon
\end{cases}\]</span></p>
<p>We say that the method is zero-stable if for <span class="math inline">\(\Delta t &lt; \Delta t_0\)</span>, there exists a constant <span class="math inline">\(C &gt; 0\)</span> such that</p>
<p><span class="math display">\[|u_n - z_n| \leq C\varepsilon\]</span></p>
<p>for <span class="math inline">\(\varepsilon &gt; 0\)</span> sufficiently small. (<span class="math inline">\(C\)</span> and <span class="math inline">\(\Delta t_0\)</span> depend on problem data, <span class="math inline">\(T_{fin}\)</span>, <span class="math inline">\(f\)</span>).</p>
<p>It is possible to prove the following theorem:</p>
<p><strong>Theorem:</strong> If <span class="math inline">\(\Phi\)</span> is Lipschitz continuous with respect to the dependence on <span class="math inline">\(u_n\)</span> (<span class="math inline">\(\exists \Delta &gt; 0\)</span>: <span class="math inline">\(|\Phi(u_n) - \Phi(z_n)| \leq \Delta |u_n - z_n|\)</span>), then the One-step method is zero-stable.</p>
<p>Lipschitz continuity in this case is enough for zero-stability (and it is generally a consequence of Lipschitz continuity of <span class="math inline">\(f\)</span>).</p>
<p>Then, we have another theorem. It generalizes the theorem for the explicit Euler.</p>
<p><strong>Theorem:</strong> If <span class="math inline">\(\Phi\)</span> is like in the previous theorem, then:</p>
<p><span class="math display">\[|y(t_n) - u_n| \leq \left(|y_0 - u_0| + t_n \, \tau(\Delta t)\right) e^{L t_n}.\]</span></p>
<p>Therefore, if: - <span class="math inline">\(\tau(\Delta t) \to 0\)</span> with <span class="math inline">\(\Delta t\)</span> - <span class="math inline">\(y_0 - u_0 \to 0\)</span> with <span class="math inline">\(\Delta t\)</span></p>
<p>the method is convergent</p>
<p>(and the order is <span class="math inline">\(\Delta t^p\)</span>, with <span class="math inline">\(p = \min(p_1, p_2)\)</span> where: - <span class="math inline">\(\tau(\Delta t) \sim O(\Delta t^{p_1})\)</span> - <span class="math inline">\(y_0 - u_0 \sim O(\Delta t^{p_2})\)</span> (generally <span class="math inline">\(p = p_1\)</span>).</p>
<p>In other terms:</p>
<p>For one-step method (not true for multi-step):</p>
<p><span class="math display">\[\Phi \text{ Lipschitz continuous } \Rightarrow \text{ Method zero-stable} + \text{Consistency} \Rightarrow \text{CONVERGENCE}\]</span></p>
<p><span class="math inline">\(\Rightarrow\)</span> If <span class="math inline">\(\Phi\)</span> is Lipschitz continuous, consistency <span class="math inline">\(\Rightarrow\)</span> convergence.</p>
</section>
<section id="the-concept-of-absolute-stability" class="level2">
<h2 class="anchored" data-anchor-id="the-concept-of-absolute-stability">The Concept of Absolute Stability</h2>
<p>The zero-stability is a property of the numerical scheme, required by the presence of roundoff errors and other possible perturbations.</p>
<p>However, there is another (maybe more engineering) concept of stability related to the nature of the problem to solve.</p>
<p>In simple words, we want that, if a problem is asymptotically stable, the numerical approximation is asymptotically stable too.</p>
<p>Is this happening? Let’s consider the prototype of asymptotically stable problem (Model Problem).</p>
<p>Let’s consider the Cauchy problem:</p>
<p><span class="math display">\[\begin{cases}
\frac{dy}{dt} = \lambda y &amp; t &gt; 0 \\
y(0) = y_0
\end{cases}\]</span></p>
<p>We know that the solution is asymptotically stable for <span class="math inline">\(\lambda &lt; 0\)</span> <span class="math inline">\((y_{ex} = y_0 e^{\lambda t} \xrightarrow{t \to \infty} 0 \text{ for } \lambda &lt; 0)\)</span></p>
<p>In fact: <span class="math inline">\(\frac{dz}{dt} = \lambda z\)</span> with <span class="math inline">\(z(0) = y_0 + \varepsilon \Rightarrow z - y = \varepsilon e^{\lambda t} \xrightarrow{t\to\infty} 0\)</span> for <span class="math inline">\(\lambda &lt; 0\)</span>.</p>
<section id="remark-1" class="level3">
<h3 class="anchored" data-anchor-id="remark-1">Remark</h3>
<p>For a system: <span class="math inline">\(\begin{cases} \frac{d\mathbf{y}}{dt} = A\mathbf{y} &amp; \mathbf{y} \in \mathbb{R}^n \\ \mathbf{y}(0) = \mathbf{y}_0 &amp; A \in \mathbb{R}^{n \times n} \end{cases}\)</span></p>
<p>the asymptotic stability is guaranteed if THE REAL PART OF ALL THE EIGENVALUES is negative.</p>
<p>To be general, from now on we will consider <span class="math inline">\(\lambda \in \mathbb{C}\)</span> also for the scalar case. In particular, the left-plane <span class="math inline">\(\text{Real}(\lambda) &lt; 0\)</span> is the region of the complex plane where the original problem is asymptotically stable.</p>
<section id="question-is-the-solution-of-the-model-problem-with-explicit-euler-asymptotically-vanishing-as-the-exact-solution" class="level4">
<h4 class="anchored" data-anchor-id="question-is-the-solution-of-the-model-problem-with-explicit-euler-asymptotically-vanishing-as-the-exact-solution">Question: is the solution of the model problem with Explicit Euler asymptotically vanishing as the exact solution?</h4>
<p>Notice that the question is not related to the behavior of the solution for <span class="math inline">\(\Delta t \to 0\)</span>, but for <span class="math inline">\(\Delta t\)</span> given and <span class="math inline">\(t \to +\infty\)</span>.</p>
<p>Let’s see: <span class="math display">\[\frac{dy}{dt} = \lambda y \quad \text{EE}: \frac{u_{i+1} - u_i}{\Delta t} = \lambda u_i\]</span></p>
<p><span class="math display">\[u_{i+1} = (1 + \lambda \Delta t) u_i \quad (\text{Re}(\lambda) &lt; 0)\]</span></p>
<p><span class="math display">\[|u_{i+1}| = |1 + \lambda \Delta t| |u_i| \Rightarrow |u_{i+1}| = |1 + \lambda \Delta t|^{i+1} |u_0|\]</span></p>
<p>The solution asymptotically vanishes if <span class="math inline">\(|1 + \lambda \Delta t| &lt; 1\)</span></p>
<p>Intuitively, if <span class="math inline">\(\lambda\)</span> is Real and negative:</p>
<p><span class="math display">\[|1 + \lambda \Delta t| &lt; 1\]</span> <span class="math display">\[\Downarrow\]</span> <span class="math display">\[-1 &lt; 1 + \lambda \Delta t &lt; 1\]</span> <span class="math display">\[\Downarrow\]</span> <span class="math display">\[-2 &lt; \lambda \Delta t &lt; 0\]</span> <span class="math display">\[\Downarrow\]</span> <span class="math display">\[\Delta t &lt; \frac{2}{|\lambda|}\]</span></p>
<p>So, if <span class="math inline">\(\Delta t &gt; \frac{2}{|\lambda|}\)</span> the numerical solution is not stable.</p>
<p>For <span class="math inline">\(\lambda\)</span> complex, we can draw the region of the plane <span class="math inline">\(\lambda \Delta t\)</span> where the solution is stable.</p>
<p>![Complex plane diagram showing unit circle with center at (-1,0)]</p>
<p>Unit circle with center in <span class="math inline">\((-1, 0)\)</span></p>
<p>(In magenta the region of stability of the problem).</p>
<p>So, the method is reproducing the asymptotic behavior of the exact solution ONLY UNDER THE CONDITION THAT:</p>
<p><span class="math display">\[\lambda \Delta t \in \text{Unit Circle centered in } (-1, 0).\]</span></p>
</section>
<section id="what-happens-with-implicit-euler" class="level4">
<h4 class="anchored" data-anchor-id="what-happens-with-implicit-euler">What happens with Implicit Euler?</h4>
<p><span class="math display">\[\frac{1}{|1 - \lambda \Delta t|} &lt; 1 \quad \forall \Delta t,\]</span></p>
<p>so <span class="math inline">\(u^{n+1} \xrightarrow{n \to \infty} 0 \quad \forall \Delta t\)</span></p>
<p>There is a big difference between the two Eulers: one is stable under some conditions, the other is unconditionally stable.</p>
</section>
<section id="what-about-crank-nicolson" class="level4">
<h4 class="anchored" data-anchor-id="what-about-crank-nicolson">What about Crank-Nicolson?</h4>
<p><span class="math display">\[u^{n+1} = u^n + \Delta t \frac{\lambda u^{n+1} + \lambda u^n}{2} \Rightarrow u^{n+1} = \frac{1 + \frac{\Delta t}{2}\lambda}{1 - \frac{\Delta t}{2}\lambda} u^n\]</span></p>
<p>Again, for <span class="math inline">\(\lambda \in \mathbb{C}\)</span> we have:</p>
<p><span class="math display">\[\left|\frac{1 + \frac{\Delta t}{2}\lambda}{1 - \frac{\Delta t}{2}\lambda}\right| &lt; 1 \quad \forall \Delta t\]</span></p>
<p>so also CN is stable with no condition.</p>
</section>
</section>
</section>
<section id="definition" class="level2">
<h2 class="anchored" data-anchor-id="definition">DEFINITION</h2>
<p>A method is said to be ABSOLUTELY STABLE if the solution of the model problem <span class="math inline">\(\frac{dy}{dt} = \lambda y\)</span> vanishes asymptotically when <span class="math inline">\(t \to +\infty\)</span>.</p>
<p>We say that the method is UNCONDITIONALLY ABSOLUTELY STABLE if this happens <span class="math inline">\(\forall \Delta t &gt; 0\)</span>. On the contrary, it is said to be CONDITIONALLY STABLE if we have limitations on <span class="math inline">\(\Delta t\)</span>.</p>
</section>
<section id="another-example-heun" class="level2">
<h2 class="anchored" data-anchor-id="another-example-heun">Another Example: Heun</h2>
<p><span class="math display">\[u^{n+1} = u^n + \frac{\Delta t}{2}(\lambda(u^n + \Delta t \lambda u^n) + \lambda u^n) = \left(1 + \Delta t \lambda + \frac{\Delta t^2 \lambda^2}{2}\right) u^n\]</span></p>
<p>Now, consider the curve <span class="math inline">\(\frac{\Delta t^2 \lambda^2}{2} + \Delta t \lambda + 1\)</span> for <span class="math inline">\(\lambda &lt; 0\)</span></p>
<p>We see that we need:</p>
<p><span class="math display">\[0 &lt; \Delta t &lt; \frac{2}{|\lambda|}\]</span></p>
<p>(as for Explicit Euler).</p>
<p>In the complex plane, the region is slightly larger than for Explicit Euler.</p>
</section>
<section id="remark-we-found-that-the-explicit-methods-are-conditionally-stable-while-the-implicit-ones-are-unconditionally-stable." class="level2">
<h2 class="anchored" data-anchor-id="remark-we-found-that-the-explicit-methods-are-conditionally-stable-while-the-implicit-ones-are-unconditionally-stable.">REMARK: We found that the explicit methods are conditionally stable, while the implicit ones are unconditionally stable.</h2>
<p>In general, we do not have unconditionally stable explicit methods, but we do have implicit methods that are only conditionally stable.</p>
<p>The region of absolute stability is the portion of <span class="math inline">\(\mathbb{C}^-\)</span> for <span class="math inline">\(\lambda \Delta t\)</span> to belong to such that the method is absolutely stable. Unconditional absolute stability (a.k.a A-stability) is when this region is the entire left plane <span class="math inline">\(\mathbb{C}^-\)</span>.</p>
<p>The concept of absolute stability somehow clarifies what are the criteria to select a method for a problem.</p>
<p>In fact, let’s first consider the general case(s):</p>
<ol type="1">
<li><p><span class="math inline">\(\frac{dy}{dt} = f(t,y) \simeq f(t,y_0) + \frac{\partial f}{\partial t}(t-t_0) + \frac{\partial f}{\partial y}(t,y_0)(y-y_0)\)</span></p>
<p>so we can locally take <span class="math inline">\(\lambda \simeq \frac{\partial f}{\partial y}(t,y_0)\)</span></p></li>
<li><p>For a system: <span class="math inline">\(\frac{d\mathbf{y}}{dt} = A \mathbf{y} \Rightarrow \lambda = eig(A)\)</span></p></li>
<li><p><span class="math inline">\(\frac{d\mathbf{y}}{dt} = \mathbf{F}(t,\mathbf{y})\)</span> (nonlinear system)</p>
<p><span class="math inline">\(\Rightarrow \lambda = eig\left(\frac{\partial \mathbf{F}}{\partial \mathbf{y}}(t_0, y_0) \right)\)</span> - Jacobian</p></li>
</ol>
<p>Now, for a general problem, we have:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Nature</th>
<th>Accuracy</th>
<th>Limitations on <span class="math inline">\(\Delta t\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FE</td>
<td>Explicit</td>
<td>1</td>
<td><span class="math inline">\(\Delta t &lt; \frac{2}{|\lambda|}\)</span></td>
</tr>
<tr class="even">
<td>BE</td>
<td>Implicit</td>
<td>1</td>
<td>NO</td>
</tr>
<tr class="odd">
<td>CN</td>
<td>Implicit</td>
<td>2</td>
<td>NO</td>
</tr>
<tr class="even">
<td>H</td>
<td>Explicit</td>
<td>2</td>
<td><span class="math inline">\(\Delta t &lt; \frac{2}{|\lambda|}\)</span></td>
</tr>
</tbody>
</table>
<p>Implicit Methods are more computationally expensive.</p>
<p>In an extreme synthesis:</p>
<p>![Comparison of FE and BE with timeline]</p>
<p>With FE each step is low-cost (Explicit) but we may need to do many for the conditional stability.</p>
<p>With BE each step is more expensive, but we need to do (generally) fewer steps.</p>
<p><span class="math inline">\(\Rightarrow\)</span> The optimal choice is largely problem dependent.</p>
</section>
</section>
<section id="multistep-methods" class="level1">
<h1>Multistep Methods</h1>
<p>The mid-point method is just an example of multi-step methods:</p>
<p><span class="math display">\[u_{n+1} = u_{n-1} + 2\Delta t \, f(t_n, u_n)\]</span></p>
<p>In general, a multistep method with <span class="math inline">\(p\)</span> steps take the form:</p>
<p><span class="math display">\[u_{n+1} - \sum_0^p a_j u_{n-j} = \Delta t \sum_{j=-1}^p b_j f(t_{n-j}, u_{n-j})\]</span></p>
<p>The method is IMPLICIT when <span class="math inline">\(b_{-1} \neq 0\)</span>.</p>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example:</h2>
<p><span class="math display">\[y(t_{n+1}) = y(t_{n-1}) + \int_{t_{n-1}}^{t_{n+1}} f(\tau, y(\tau)) d\tau\]</span></p>
<p><span class="math display">\[\Downarrow \text{ SIMPSON}\]</span></p>
<p><span class="math display">\[u_{n+1} = u_{n-1} + 2\Delta t \frac{f(t_{n+1}, u_{n+1}) + 4f(t_n, u_n) + f(t_{n-1}, u_{n-1})}{6} =\]</span></p>
<p><span class="math display">\[= u_{n-1} + \frac{\Delta t}{3}(f(t_{n+1}, u_{n+1}) + 4f(t_n, u_n) + f(t_{n-1}, u_{n-1}))\]</span></p>
<p><span class="math display">\[\mathbf{a} = \begin{bmatrix} 0 \\ 1 \end{bmatrix} a_0, a_1 \quad \mathbf{b} = \begin{bmatrix} \frac{1}{3} \\ \frac{4}{3} \\ \frac{1}{3} \end{bmatrix} b_{-1}, b_0, b_1\]</span></p>
<p>In general, we have two approaches for deriving a Multi-step methods:</p>
</section>
<section id="bdf-backward-difference-formulas" class="level2">
<h2 class="anchored" data-anchor-id="bdf-backward-difference-formulas">BDF (Backward Difference Formulas)</h2>
<p><span class="math display">\[\frac{dy}{dt}(t_{n+1}) = f(t_{n+1}, u_{n+1})\]</span> <span class="math display">\[\downarrow\]</span> approximate this with a backward finite difference, e.g.,</p>
<p><span class="math display">\[\frac{dy}{dt}(t_{n+1}) \simeq \frac{\frac{3}{2}u_{n+1} - 2u_n + \frac{1}{2}u_{n-1}}{\Delta t}\]</span></p>
<p><span class="math display">\[\Rightarrow u_{n+1} = \frac{4}{3}u_n - \frac{1}{3}u_{n-1} + \Delta t f(t_{n+1}, u_{n+1})\]</span></p>
<p>They are all in the form:</p>
<p><span class="math display">\[\mathbf{b} = \begin{bmatrix} 1 \\ 0 \\ \vdots \\ 0 \end{bmatrix}\]</span></p>
</section>
<section id="adams" class="level2">
<h2 class="anchored" data-anchor-id="adams">Adams</h2>
<p>In this case, we start from:</p>
<p><span class="math display">\[y(t_{n+1}) = y(t_n) + \int_{t_n}^{t_{n+1}} f(\tau, y(\tau)) d\tau\]</span></p>
<p>Now, we replace <span class="math inline">\(f\)</span> with an interpolation:</p>
<ol type="1">
<li>We interpolate <span class="math inline">\(f\)</span> over the nodes: <span class="math inline">\(n-p, n-p+1, ... n\)</span> so to have an explicit method (Adams-Bashforth)</li>
<li>We interpolate <span class="math inline">\(f\)</span> over the nodes: <span class="math inline">\(n-p, n-p+1, ... n, n+1\)</span></li>
</ol>
<p>Adams methods have always:</p>
<p><span class="math display">\[\mathbf{a} = \begin{bmatrix} 1 \\ 0 \\ \vdots \\ 0 \end{bmatrix}\]</span></p>
</section>
<section id="a-rapid-recall-of-difference-equations-theory" class="level2">
<h2 class="anchored" data-anchor-id="a-rapid-recall-of-difference-equations-theory">A Rapid Recall of Difference Equations Theory</h2>
<p>A linear difference equation is an equation in the form:</p>
<p><span class="math display">\[u_{n+p} + a_{n+p-1}u_{n+p-1} + a_{n+p-2}u_{n+p-2} + \ldots + a_0u_n = \varphi_{n+p}\]</span></p>
<p>where the solution is the set <span class="math inline">\(\{u_j\}\)</span> and initial conditions <span class="math inline">\(u_0, u_1, \ldots u_{p-1}\)</span> are given.</p>
<p>The theory on difference equations has several similarities with the theory on differential equations. In particular, the general solution of a linear difference equation is the linear combination of a particular solution of the equation and the general solution of the homogeneous one.</p>
<p>The general solution of the homogeneous takes the form:</p>
<p><span class="math display">\[u_n = \sum_{j=0}^{N}\left(\sum_{s=0}^{m_j-1} V_{js}n^s \right)r_j^n\]</span></p>
<p>where <span class="math inline">\(r_j\)</span> are the roots of:</p>
<p><span class="math display">\[r^p + a_{p-1}r^{p-1} + a_{p-2}r^{p-2} + \ldots + a_0 = 0\]</span></p>
<p>and - <span class="math inline">\(N\)</span> is the number of distinct roots - <span class="math inline">\(m_j\)</span> is the multiplicity of <span class="math inline">\(r_j\)</span></p>
<p>We will see a strong connection between this theory and the analysis of the linear multi-step methods.</p>
<p>In fact, a LMM reads like:</p>
<p><span class="math display">\[u_{n+1} - \sum_{j=0}^p a_j u_{n-j} = \Delta t \sum_{j=-1}^p b_j f_{n-j}\]</span></p>
<p>If we consider the model problem, we are lead to the linear difference equation:</p>
<p><span class="math display">\[u_{n+1} - \sum_{j=0}^p a_j u_{n-j} - \Delta t \lambda \sum_{j=-1}^p b_j u_{n-j} = 0\]</span></p>
<p>so we need to solve exactly a linear difference equation.</p>
<p>More precisely, we still define the LTE as the residual of the exact solution in the numerical scheme:</p>
<p><span class="math display">\[\Delta t \, \tau_{n+1} = y_{ex}(t_{n+1}) - \sum_{j=0}^p a_j y_{ex}(t_{n-j}) - \Delta t \sum_{j=-1}^p b_j \frac{dy_{ex}}{dt}(t_{n-j})\]</span></p>
<p>The method is CONSISTENT when <span class="math inline">\(\tau_{n+1} \xrightarrow{\Delta t \to 0} 0 \quad \forall n\)</span></p>
</section>
<section id="zero-stability-definition" class="level2">
<h2 class="anchored" data-anchor-id="zero-stability-definition">Zero-Stability Definition</h2>
<p>The definition of zero-stability is similar to the one for One-step Methods.</p>
<p>Also, we define:</p>
<p>First characteristic polynomial:</p>
<p><span class="math display">\[\rho(z) = z^{p+1} - \sum_{j=0}^p a_j z^{p-j}\]</span></p>
<p>Second characteristic polynomial:</p>
<p><span class="math display">\[\sigma(z) = b_{-1}z^{p+1} - \sum_{j=0}^p b_j z^{p-j}\]</span></p>
<p>and the polynomial: <span class="math inline">\(\Pi(z) = \rho(z) - \Delta t \lambda \sigma(z)\)</span> (this is the polynomial found for the model problem)</p>
<p>Based on this we define:</p>
<p><strong>Root Condition</strong>: Call <span class="math inline">\(r_i\)</span> the roots of <span class="math inline">\(\rho(z)\)</span>. The polynomial (or the associated LMM) fulfills the root condition when:</p>
<ol type="1">
<li><span class="math inline">\(|r_i| \leq 1 \quad \forall i\)</span></li>
<li>The roots with <span class="math inline">\(|r| = 1\)</span> have multiplicity 1.</li>
</ol>
<p><strong>Strong Root Condition</strong>: In addition to the R.C., only <span class="math inline">\(r_0\)</span> is s.t. <span class="math inline">\(|r_0| = 1\)</span>, all the other roots <span class="math inline">\(|r_j| &lt; 1\)</span> <span class="math inline">\((j &gt; 1, \ldots, p)\)</span>.</p>
<p><strong>Absolute R.C.</strong>: <span class="math inline">\(\exists \Delta t \leq \overline{\Delta t}\)</span> s.t. all the roots <span class="math inline">\(r_j(\Delta t)\)</span> of <span class="math inline">\(\Pi_{\Delta t}(z)\)</span> are s.t. <span class="math inline">\(|r_j(\Delta t)| &lt; 1\)</span>, <span class="math inline">\(j = 0, \ldots, p\)</span>, <span class="math inline">\(\Delta t \leq \overline{\Delta t}\)</span>.</p>
</section>
<section id="analysis-of-multistep-methods" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-multistep-methods">Analysis of Multistep Methods</h2>
<p>We have a sequence of theorems (no proofs):</p>
<ol type="1">
<li><p>A LMM is consistent if and only if:</p>
<p><span class="math display">\[\sum_{j=0}^p a_j = 1 \quad -\sum_{j=0}^p j a_j + \sum_{j=-1}^p b_j = 1\]</span></p>
<p>Also, the method is at least of order <span class="math inline">\(p\)</span> if the solution is <span class="math inline">\(\in C^{p+1}(I)\)</span> and</p>
<p><span class="math display">\[(*)\ \sum_{j=0}^p (j)^k a_j + k \sum_{j=-1}^p (j)^{k-1} b_j = 1 \quad k = 1, 2, \ldots q\]</span></p>
<p><strong>Remark</strong>: The condition <span class="math inline">\(\sum_{j=0}^p a_j = 1\)</span> means that the first characteristic polynomial <span class="math inline">\(\rho(z)\)</span> has at least one root in 1.</p></li>
<li><p>A consistent method is zero-stable if and only if it fulfills the root condition.</p></li>
</ol>
<p>With Theorems (1) + (2) we have the convergence and order analysis.</p>
<ol type="1">
<li><ul>
<li>(2): If the LMM method falls into (1) and (2) with condition (*) (not true for q+1) and the initial conditions (<span class="math inline">\(u_i \to y_{ex}(t_i)\)</span> <span class="math inline">\(i = 0, \ldots, p\)</span>) converge to the exact ones with order <span class="math inline">\(q\)</span>, the resulting method is convergent with order <span class="math inline">\(q\)</span>.</li>
</ul></li>
</ol>
<p><strong>Remark (First Dahlquist Barrier)</strong>: There is no zero-stable <span class="math inline">\(p\)</span>-LMM with order - <span class="math inline">\(&gt; p+1\)</span> for <span class="math inline">\(p\)</span> odd - <span class="math inline">\(&gt; p+2\)</span> for <span class="math inline">\(p\)</span> even</p>
<p>Let’s turn now to the Absolute stability.</p>
<ol start="3" type="1">
<li>The absolute root condition is necessary and sufficient for the absolute stability. In fact, if <span class="math inline">\(\overline{\Delta t} = +\infty\)</span>, the absolute stability is unconditional.</li>
</ol>
<p>The analysis of a LMM is completed by analyzing the coefficients of the method and the roots of the two polynomials <span class="math inline">\(\rho\)</span> and <span class="math inline">\(\Pi\)</span>.</p>
<p>The roots of <span class="math inline">\(\Pi\)</span> can be analyzed numerically (and are tabulated for most of the methods) by Matlab/Python subroutines.</p>
<p>SEE EXAMPLES (NODEPY library in Python, QSS in Matlab)</p>
<p><strong>Remark (Second Dahlquist Barrier)</strong>: There are no explicit LMM absolutely unconditionally stable. There are no LMM absolutely unconditionally stable with order <span class="math inline">\(q &gt; 2\)</span>.</p>
</section>
<section id="a-clarification-on-stability-concepts" class="level2">
<h2 class="anchored" data-anchor-id="a-clarification-on-stability-concepts">A Clarification on Stability Concepts</h2>
<p>To clarify the different stability concepts:</p>
<ol type="1">
<li><p>Zero-stability:</p>
<p><span class="math display">\[|u_j| \leq C_{T_{fin}} (|u_0| + \ldots |u_p|)\]</span></p>
<p>where the <span class="math inline">\(C\)</span> may depend on <span class="math inline">\(T_{fin}\)</span></p></li>
<li><p>Absolute stability:</p>
<p><span class="math display">\[C_{T_{fin}} \xrightarrow{T_{fin} \to \infty} 0\]</span></p></li>
<li><p><span class="math inline">\(C\)</span> is bounded independently of <span class="math inline">\(T_{fin}\)</span></p>
<p>We call this “relative stability”</p></li>
</ol>
<p><span class="math display">\[\text{for a consistent scheme} \quad \text{R.C.} \Leftarrow \text{Strong R.C.} \Leftarrow\text{A.R.C.}\]</span> <span class="math display">\[\text{CONVERGENCE} \Leftarrow \text{Zero-Stability} \Leftarrow \text{Relative Stability} \Leftarrow \text{Absolute Stability}\]</span></p>
</section>
<section id="example-extreme" class="level2">
<h2 class="anchored" data-anchor-id="example-extreme">Example (Extreme)</h2>
<p>Mid-point:</p>
<p><span class="math display">\[u_{n+1} = u_{n-1} + 2\Delta t \, f(t_n, u_n)\]</span></p>
<p><span class="math display">\[a_0 = 0 \quad a_1 = 1 \quad \Rightarrow \rho(z) = z^2 - 1 = 0 \quad \Rightarrow \rho = \pm 1\]</span></p>
<p>R.C.: OK</p>
<p><span class="math display">\[\Pi_{\Delta t}(z) = z^2 - 2\lambda z - 1\]</span></p>
<p>The product of the two roots is always -1, if one root is &lt; 1 in magnitude, the other is &gt; 1.</p>
<p>Unconditionally Absolutely UNSTABLE</p>
</section>
<section id="predictor-corrector-methods" class="level2">
<h2 class="anchored" data-anchor-id="predictor-corrector-methods">Predictor-Corrector Methods</h2>
<p>A clear message from the previous examples is that, in general, explicit methods are less absolutely stable, they are never unconditionally stable and have smaller regions of stability.</p>
<p>However, let’s reconsider implicit methods too.</p>
<p>For instance, let’s consider a generic LMM:</p>
<p><span class="math display">\[u_{n+1} - \sum_{j=0}^p a_j u_{n-j} = b_{-1} \Delta t \, f(t_{n+1}, u_{n+1}) + \Delta t \sum_{j=0}^p b_j f(t_{n-j}, u_{n-j})\]</span></p>
<p>To solve this nonlinear equation, we could use a Newton method but also a fixed-point method and a natural candidate is the following:</p>
<p><span class="math display">\[u_{n+1}^{(m)} = \sum_{j=0}^p a_j u_{n-j} + \Delta t \sum_{j=0}^p b_j f_{n-j} + \Delta t b_{-1} f(t_{n+1}, u_{n+1}^{(m-1)})\]</span></p>
<p>Notice that this method converges if:</p>
<p><span class="math display">\[\left|\Delta t \, b_{-1} \, f'(t_{n+1}, u_{n+1}) \right| &lt; 1\]</span></p>
<p>So we have the condition:</p>
<p><span class="math display">\[\Delta t &lt; \frac{1}{|b_{-1}||f'|}\]</span></p>
<p>Even if the method is unconditionally stable, we may have a condition on <span class="math inline">\(\Delta t\)</span> for the convergence of the fixed-point.</p>
<p>In any case, a good initial condition is required, because with a good <span class="math inline">\(u^{(0)}\)</span> the number of iterations can be reduced: an explicit method can be used to this.</p>
<p>These considerations lead to the design of a new class of methods, Heun being one of the possible examples.</p>
<p>Predictor [P] is an explicit method of order <span class="math inline">\(q_P\)</span></p>
<p>Corrector [C] is an implicit method of order <span class="math inline">\(q_C\)</span></p>
<p>Predictor Corrector method:</p>
<p>P: do one step of P <span class="math inline">\(\Rightarrow u_{n+1}^{(0)}\)</span></p>
<p>E: evaluate <span class="math inline">\(f(t_{n+1}, u_{n+1}^{(0)})\)</span></p>
<p>C: compute <span class="math inline">\(m\)</span> fixed-point iterations of C</p>
<p>Optional: E: compute <span class="math inline">\(f_{n+1} = f(t_{n+1}, u_{n+1}^{(m)})\)</span></p>
<p>These methods go under the name of <span class="math inline">\(\text{PEC}^m\)</span> or <span class="math inline">\(\text{PEC}^m\text{E}\)</span> if the last step is taken.</p>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples:</h2>
<p>P = Adams-Bashforth of order 2 C = Adams-Moulton of order 3 <span class="math inline">\(m = 1\)</span></p>
<p>PEC: <span class="math display">\[\begin{cases}
u_{n+1}^{(0)} = u_n^{(1)} + \frac{\Delta t}{2}(3f_n^{(0)} - f_{n-1}^{(0)}) \\
f_{n+1}^{(0)} = f(t_{n+1}, u_{n+1}^{(0)}) \\
u_{n+1}^{(1)} = u_n^{(1)} + \frac{\Delta t}{12}(5f_{n+1}^{(0)} + 8f_n^{(0)} - f_{n-1}^{(0)})
\end{cases}\]</span></p>
<p>PECE: <span class="math display">\[\begin{cases}
u_{n+1}^{(0)} = u_n^{(1)} + \frac{\Delta t}{2}(3f_n^{(1)} - f_{n-1}^{(1)}) \\
f_{n+1}^{(0)} = f(t_{n+1}, u_{n+1}^{(0)}) \\
u_{n+1}^{(1)} = u_n^{(1)} + \frac{\Delta t}{12}(5f_{n+1}^{(0)} + 8f_n^{(1)} - f_{n-1}^{(1)}) \\
f_{n+1}^{(1)} = f(t_{n+1}, u_{n+1}^{(1)})
\end{cases}\]</span></p>
<p>A natural question is: what is the accuracy of <span class="math inline">\(\text{PEC}^m\)</span> or <span class="math inline">\(\text{PECE}^m\)</span>? What is the region of absolute stability?</p>
<p><strong>Theorem (Accuracy)</strong>: <span class="math inline">\(\text{PECE}\)</span> methods have (under regularity assumptions on the solution) order of accuracy:</p>
<p><span class="math display">\[q_{PC} = min(q_P + m, q_C)\]</span></p>
<p>For the region of absolute stability, in general:</p>
<p><span class="math display">\[\text{Region}(P) \subseteq \text{Region}(\text{PECE}) \subseteq \text{Region}(C)\]</span></p>
<p>and <span class="math inline">\(\text{Region}(\text{PECE}) \xrightarrow{m \to +\infty} \text{Region}(C)\)</span></p>
</section>
<section id="runge-kutta-methods" class="level2">
<h2 class="anchored" data-anchor-id="runge-kutta-methods">Runge-Kutta Methods</h2>
<p>Heun is also an RK method:</p>
<p><span class="math display">\[u_{n+1} = u_n + \Delta t\left(f_n + f(t_{n+1}, u_n + \Delta t f_n)\right)\]</span></p>
<p>This is a 2nd order method but the accuracy is not obtained using more steps, but giving up the linearity of the method.</p>
<p>In general, RK are in the form:</p>
<p><span class="math display">\[u_{n+1} = u_n + \Delta t \, \mathbf{K} \cdot \mathbf{b}\]</span></p>
<p>where <span class="math inline">\(\mathbf{K}, \mathbf{b} \in \mathbb{R}^s\)</span></p>
<p>and <span class="math inline">\([\mathbf{K}]_i = f(t_n + c_i \Delta t, u_n + \Delta t[A\mathbf{K}]_i)\)</span></p>
<p>where <span class="math inline">\([\mathbf{A}\mathbf{K}]_i\)</span> is the <span class="math inline">\(i^{th}\)</span> entry of the vector <span class="math inline">\(\mathbf{A}\mathbf{K}\)</span></p>
<p>The method is characterized by: <span class="math inline">\(s\)</span> (stages), <span class="math inline">\(\mathbf{b}\)</span>, <span class="math inline">\(\mathbf{c}\)</span> and <span class="math inline">\(\mathbf{A} \in \mathbb{R}^{s \times s}\)</span></p>
<p>In particular, the three “ingredients” are generally written as:</p>
<p><span class="math display">\[\frac{\mathbf{c} | \mathbf{A}}{\mathbf{b}^T} \quad \text{(Butcher array)}\]</span></p>
<p>It is assumed that <span class="math inline">\(c_i = \sum_{j=1}^s a_{ij} \quad \forall i = 1, \ldots s\)</span></p>
<p>If <span class="math inline">\(\mathbf{A}\)</span> is such that <span class="math inline">\(a_{ij} = 0 \quad \forall j \geq i\)</span> then:</p>
<p><span class="math display">\[K_i = [\mathbf{K}]_i = f(t_n + \Delta t c_i, u_n + \Delta t \sum_{j &lt; i} a_{ij} K_j)\]</span></p>
<p>so the computation of <span class="math inline">\(K_i\)</span> is immediate. We call this case an explicit RK scheme.</p>
<p>If <span class="math inline">\(a_{ij} = 0 \quad \forall j &gt; i\)</span>, then:</p>
<p><span class="math display">\[K_i = [\mathbf{K}]_i = f(t_n + \Delta t c_i, u_n + \Delta t \sum_{j &lt; i} a_{ij} K_j + \Delta t a_{ii} K_i)\]</span></p>
<p>so we need to solve a non-linear equation to obtain <span class="math inline">\(K_i\)</span>. We call this a semi-implicit method.</p>
<p>In general, computing <span class="math inline">\(\mathbf{K}\)</span> requires the solution of a non-linear system (implicit method).</p>
<p>Clearly, the computational cost increases in the three cases.</p>
</section>
<section id="derivation-of-an-explicit-rk-method" class="level2">
<h2 class="anchored" data-anchor-id="derivation-of-an-explicit-rk-method">Derivation of an Explicit RK Method</h2>
<p>A possible strategy to devise an explicit method is to maximize the order of the LTE with Taylor expansion analysis.</p>
<p>For instance, for <span class="math inline">\(s = 2\)</span>:</p>
<p><span class="math display">\[\begin{pmatrix} 0 &amp; 0 &amp; 0 \\ c_2 &amp; a_{21} &amp; 0 \\ \hline &amp; b_1 &amp; b_2 \end{pmatrix}\]</span></p>
<p>We have three parameters, but we set <span class="math inline">\(a_{21} = c_2\)</span>.</p>
<p><span class="math display">\[u_{n+1} = u_n + \Delta t(b_1 f(t_n, u_n) + b_2 f(t_n + c_2 \Delta t, u_n + \Delta t c_2 f(t_n, u_n)))\]</span></p>
<p><span class="math display">\[y_{ex}(t_n) = y_{ex}(t_n) + \Delta t \frac{dy_{ex}}{dt}(t_n) + \frac{\Delta t^2}{2}\frac{d^2y_{ex}}{dt^2}(t_n) + \frac{\Delta t^3}{3!}\frac{d^3y_{ex}}{dt^3}(t_n) + H.O.T.\]</span></p>
<p><span class="math display">\[f(t_n + c_2 \Delta t, u_n + \Delta t c_2 f(t_n, u_n)) =\]</span></p>
<p><span class="math display">\[= f(t_n, u_n) + \frac{\partial f}{\partial t}(t_n, y_n)c_2 \Delta t + \frac{\partial f}{\partial y}(t_n, y_n)c_2 \Delta t f(t_n, u_n) =\]</span></p>
<p>Notice that: <span class="math display">\[\frac{d^2y}{dt^2} = \frac{df}{dt} = \frac{\partial f}{\partial t} + \frac{\partial f}{dy}\frac{dy}{dt} = \frac{\partial f}{\partial t} + \frac{\partial f}{\partial y}f\]</span></p>
<p><span class="math display">\[\Rightarrow f(t_n, u_n) + c_2 \Delta t \frac{d^2y}{dt^2}(t_n)\]</span></p>
<p>The Taylor expansion applied to the scheme reads:</p>
<p><span class="math display">\[u_{n+1} = u_n + \Delta t(b_1 + b_2)f + c_2 b_2 \Delta t^2 \frac{d^2y}{dt^2}\]</span></p>
<p>We match therefore the first terms of the Taylor expansion for:</p>
<p><span class="math display">\[\begin{align}
b_1 + b_2 &amp;= 1 \\
b_2 c_2 &amp;= \frac{1}{2}
\end{align}\]</span></p>
<p>For <span class="math inline">\(b_2 = \frac{1}{2}\)</span> we obtain the Heun method.</p>
<p>The L.T.E is <span class="math inline">\(\Delta t \, \tau \sim O(\Delta t^3)\)</span></p>
<p>so the method is 2nd order.</p>
<p>Implicit methods can be devised from Gaussian quadratures.</p>
</section>
<section id="analysis-of-rk" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-rk">Analysis of RK</h2>
<p><strong>CONSISTENCY</strong>: As the previous example shows, we need <span class="math inline">\(\sum b_i = 1\)</span>. This is necessary and sufficient for the consistency.</p>
<p><strong>ZERO-STABILITY</strong>: RK are One-Step methods, if <span class="math inline">\(f\)</span> is Lipschitz-Continuous, they are zero-stable.</p>
<p><strong>ORDER</strong>: In general, the order we can obtain depends on the number of stages in a (non-trivial) way:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Explicit RK:</th>
<th>ORDER</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s_{min}\)</span></td>
<td></td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>6</td>
<td>7</td>
<td>9</td>
<td>11</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(s_{min}\)</span> = minimum number of stages to obtain the corresponding order.</p>
</section>
<section id="absolute-stability" class="level2">
<h2 class="anchored" data-anchor-id="absolute-stability">ABSOLUTE STABILITY</h2>
<p>If we write the method for the model problem, we can write:</p>
<p><span class="math display">\[u_{n+1} = \mathcal{R}(\Delta t \lambda) u_n\]</span></p>
<p>The region of absolute stability is, in general, the non-trivial region where <span class="math inline">\(|\mathcal{R}(\Delta t \lambda)| &lt; 1\)</span> (in <span class="math inline">\(\mathbb{C}\)</span>).</p>
</section>
<section id="why-are-rk-so-popular" class="level2">
<h2 class="anchored" data-anchor-id="why-are-rk-so-popular">Why are RK so popular?</h2>
<p>RK are extremely popular, because they can be high order with “only” one-step.</p>
<p>One-step means that: - we do not need high-order approximation of the initial data needed by LMM (the initial condition is enough) - we can easily perform the time-step ADAPTIVITY (much more difficult with LMM).</p>
<p>For the adaptivity, there are smart combinations of RK that obtain the adaptivity (i.e.&nbsp;an error estimate to adapt the step) in an efficient way.</p>
<p>One of the most popular is: RK45 Fehlberg: smart combination of an explicit method of order 4 and an explicit of order 5 to adapt the step.</p>
</section>
<section id="a-final-note-on-stiff-problems" class="level2">
<h2 class="anchored" data-anchor-id="a-final-note-on-stiff-problems">A Final Note on Stiff problems</h2>
<p>Many of the concepts used here can be extended to systems of ODEs:</p>
<p><span class="math display">\[\begin{cases}
\frac{d\mathbf{y}}{dt} = \mathbf{F}(t, \mathbf{y}) \\
\mathbf{y}(0) = \mathbf{y}_0
\end{cases}\]</span></p>
<p>In the case of a linear ODE system:</p>
<p><span class="math display">\[\mathbf{F} = A \, \mathbf{y} \quad \downarrow \quad \text{matrix}\]</span></p>
<p>There is, however, an important concept to clarify.</p>
<p>Consider a simple 2×2 problem:</p>
<p><span class="math display">\[\frac{d\mathbf{y}}{dt} = A\mathbf{y}\]</span></p>
<p>where <span class="math inline">\(A\)</span> has the two eigenvalues: <span class="math inline">\(\begin{cases} \lambda_1 = -10^6 \\ \lambda_2 = -1 \end{cases}\)</span></p>
<p>If we use Explicit Euler:</p>
<p><span class="math display">\[\mathbf{y}^{n+1} = \mathbf{y}^n + \Delta t \, A \mathbf{y}^n\]</span></p>
<p>the region of absolute stability is:</p>
<p><span class="math display">\[\Delta t \leq \min\left(\frac{2}{10^6}, \frac{2}{1}\right) = 2 \cdot 10^{-6}\]</span></p>
<p>The solution, on the other hand, is the linear combination of the two functions:</p>
<p><span class="math display">\[e^{-10^6 t}, e^{-t}\]</span></p>
<p>[Graph showing rapid decay of <span class="math inline">\(e^{-10^6 t}\)</span> vs slower decay of <span class="math inline">\(e^{-t}\)</span>]</p>
<p>To capture the fast dynamics (<span class="math inline">\(\lambda = 10^{-6}\)</span>), that fades away immediately, we need to take <span class="math inline">\(\Delta t \sim 10^{-6}\)</span>!!!</p>
<p>An explicit method is certainly not a good choice here.</p>
<p>In general, we say that a problem is “stiff” when it may require very stringent time-step in a non-efficient way. The name “stiff” originates from the coupling of springs with different stiffness:</p>
<p>[Simple diagram of a mass connected to two springs with different spring constants]</p>
<p>to study the dynamics of the two real balls, one can write an ODE system.</p>
<p>If <span class="math inline">\(K_1 &lt;&lt; K_2\)</span> this is a stiff problem.</p>
</section>
<section id="exercise-on-lmm" class="level2">
<h2 class="anchored" data-anchor-id="exercise-on-lmm">EXERCISE on LMM</h2>
<p>Consider the following family of methods (LMM):</p>
<p><span class="math display">\[u_{n+1} = \alpha u_n + (1-\alpha)u_{n-1} + \Delta t \, \gamma f_{n+1}\]</span></p>
<ol type="1">
<li>Investigate the convergence properties of the method as function of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>.</li>
</ol>
<p><strong>Sol</strong>: For <span class="math inline">\(\alpha \neq 1\)</span>, the method is 2-step. For <span class="math inline">\(\gamma \neq 0\)</span>, the method is implicit.</p>
<p>It’s a LMM with: <span class="math inline">\(\mathbf{a} = \begin{bmatrix} \alpha \\ 1-\alpha \\ 0 \end{bmatrix} \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix}\)</span>, <span class="math inline">\(\mathbf{b} = \begin{bmatrix} \gamma \\ 0 \\ 0 \end{bmatrix} \begin{bmatrix} -1 \\ 0 \\ 1 \end{bmatrix}\)</span></p>
<p>Consistency: <span class="math inline">\(\sum a_j = 1\)</span>: <span class="math inline">\(\alpha + (1-\alpha) = 1\)</span> ✓OK <span class="math inline">\(-\sum j a_j + \sum b_j = 1\)</span>: <span class="math inline">\(0 \cdot \alpha - 1 \cdot (1-\alpha) + \gamma = 1\)</span> <span class="math inline">\(\Rightarrow \gamma = 2 - \alpha\)</span></p>
<p>The methods: <span class="math inline">\(u_{n+1} = \alpha u_n + (1-\alpha)u_{n-1} + \Delta t (2-\alpha)f_{n+1}\)</span> are consistent.</p>
<p>Order: <span class="math inline">\(\sum (j)^2 a_j + 2\sum (-j)^1 b_j = 1\)</span> ? <span class="math inline">\(\Rightarrow (1-\alpha) + 2(2-\alpha) = 1 \Rightarrow \alpha = \frac{4}{3}, \gamma = \frac{2}{3}\)</span></p>
<ol start="2" type="1">
<li>Investigate the absolute stability of the method with order 2.</li>
</ol>
<p>The method: <span class="math inline">\(u_{n+1} = \frac{4}{3}u_n - \frac{1}{3}u_{n-1} + \Delta t \frac{2}{3}f_{n+1}\)</span></p>
<p>is of order 2 (it is, in fact, a BDF of order 2).</p>
<p><span class="math inline">\(\rho(z) = z^2 - \frac{4}{3}z + \frac{1}{3} = 0 \quad r_{1,2} = \frac{\frac{4}{3} \pm \sqrt{\frac{16}{9} - \frac{4}{3}}}{2} = \frac{4 \pm 2}{6} = \frac{2 \pm 1}{3}\)</span></p>
<p>R.C. ✓</p>
<p><span class="math inline">\(\Pi_{\Delta t}(z) = z^2 - \frac{4}{3}z + \frac{1}{3} - \Delta t \lambda \frac{2}{3}z^2 = 0\)</span></p>
<p>Let’s consider <span class="math inline">\(\lambda \in \mathbb{R}^-\)</span>:</p>
<p><span class="math inline">\((3 - \Delta t \lambda 2)z^2 - 4z + 1 = 0\)</span></p>
<p><span class="math inline">\(z^2 - \frac{4z}{3 + 2\Delta t|\lambda|} + \frac{1}{3 + 2\Delta t|\lambda|} = 0\)</span></p>
<p><span class="math inline">\(r_1 \cdot r_2 = \frac{1}{3 + 2\Delta t|\lambda|}\)</span></p>
<p><span class="math inline">\(r_1 = \frac{2 + \sqrt{1 - 2\Delta t|\lambda|}}{3 + 2\Delta t|\lambda|} \xrightarrow{\Delta t \to 0} 1\)</span></p>
<p><span class="math inline">\(|r_1(\Delta t)| &lt; 1 \quad \forall \Delta t &gt; 0\)</span></p>
<p><span class="math inline">\(r_2 = \frac{2 - \sqrt{1 - 2\Delta t|\lambda|}}{3 + 2\Delta t|\lambda|} \xrightarrow{\Delta t \to 0} \frac{1}{3}\)</span></p>
<p><span class="math inline">\(|r_2(\Delta t)| &lt; \frac{1}{3}\)</span></p>
<p>Method unconditionally stable (Verify with Python/Matlab).</p>
<ol start="3" type="1">
<li>Solve <span class="math display">\[\begin{cases}
\frac{dy}{dt} = -(1 + t_g(t))y &amp; t \in [0, 1] \\
y(0) = 1
\end{cases}\]</span></li>
</ol>
<p>with the BDF2 method found and verify your results, knowing that the exact solution is <span class="math inline">\(y_{ex} = e^{-x}\cos(x)\)</span>.</p>
<p>Using MATLAB, the problem is easily solved with the QSS subroutines:</p>
<p>qssstab.m (draws the region of absolute stability) qssmulti.m (solves with a generic LMM)</p>
<p>With Python there are many libraries: <code>SciPy</code>, <code>odeint</code> that uses RK, ode, and allows the selection of BDF methods, but generally with adaptive time step.</p>
<p><code>NODEPY</code> is potentially an excellent library but buggy.</p>
<p>It’s excellent for drawing the stability region (see hmm.py on Canvas)</p>
<p>I have written a simple LMM solver with fixed-point iterations for implicit methods.</p>
<p>Using my-hmm.py you can verify that our method is 2nd order:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>max error</th>
<th><span class="math inline">\(3 \cdot 10^{-4}\)</span></th>
<th><span class="math inline">\(8 \cdot 10^{-5}\)</span></th>
<th><span class="math inline">\(2 \cdot 10^{-5}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\Delta t\)</span></td>
<td>0.05</td>
<td>0.025</td>
<td>0.0125</td>
</tr>
</tbody>
</table>
<p>[Graph showing exact vs numerical solution]</p>
<p>[Stability region diagram showing a circle in the complex plane] Red = Region of Stability</p>


</section>
</section>

</main> <!-- /main -->
<script src="scripts/site-behavior.js"></script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>