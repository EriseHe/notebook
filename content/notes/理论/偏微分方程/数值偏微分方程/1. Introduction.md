# 1 INTRODUCTION

## 1.1 Basic Concept

We think of a **physical problem** as a map that takes **data** to a **solution**, and a **numerical problem** as an approximation of that map (and of the data).

### Physical vs. Numerical Maps (as in the diagram)

- **Physical map** $P$:
  - data $d$ (data space) $\longmapsto$ solution $u$ (solution space)
  - written as $u = P(d)$

- **Numerical map** $N$:
  - approximated data $d_h$ (resolution/mesh parameter $h$) $\longmapsto$ numerical solution $u_h$
  - written as $u_h = N(d_h)$

- **Perturbed numerical map** $N_{\text{perturb}}$:
  - perturbed data $d_h + \delta_h$ $\longmapsto$ perturbed numerical solution $u_h + \varepsilon_h$

So the diagram is comparing:
- $d$ vs. $d_h$ vs. $d_h+\delta_h$ in **data space**
- $u$ vs. $u_h$ vs. $u_h+\varepsilon_h$ in **solution space**
with the mappings $P$, $N$, and $N_{\text{perturb}}$ connecting them.

### Two problems

- **Physical Problem:** Solution $u$ and data $d$  
- **Numerical Problem:** Numerical solution $u_h$ and approximated data $d_h$, where $h$ measures how fine the approximation is

### Key concepts

- **Convergence:** Does $u_h \to u$ when $h \to 0$?
- **Consistency:** Does $N \to P$ when $h \to 0$?
- **Stability:** Does $\varepsilon_h \to 0$ when $\delta_h \to 0$?

---

## 1.2 Functional Analysis

> [!definition|1.2.1] Functional
> A functional is $\mathcal{F}(\cdot): X \to \mathbb{R}$. Let $f(x), g(x) \in X$. A functional is **linear** if
> $$
> \mathcal{F}(\lambda f(x) + \mu g(x)) = \lambda \mathcal{F}(f(x)) + \mu \mathcal{F}(g(x))
> $$

> [!example|1.2.2] A functional
> For example,
> $$
> \int_a^b f(x)\,dx
> $$
> is a functional.

> [!definition|1.2.3] Form
> A form is $a(\cdot,\cdot): X \times X \to \mathbb{R}$, where $f, g \in X$. A form is **bilinear** if
> - $a(\lambda f_1 + \mu f_2, g) = \lambda a(f_1,g) + \mu a(f_2,g)$
> - $a(f, \lambda g_1 + \mu g_2) = \lambda a(f,g_1) + \mu a(f,g_2)$

> [!definition|1.2.4] Space
> A space is a set with operations defined. If $X$ is a space, then
> - $f \in X \Longrightarrow \lambda f \in X$
> - $f,g \in X \Longrightarrow \lambda f + \mu g \in X$

> [!definition|1.2.5] Distance
> A distance is $d(\cdot,\cdot): X \times X \to \mathbb{R}$ such that $\forall\, f,g,w \in X$
> - $d(f,g) = d(g,f)$  **[symmetry]**
> - $d(f,g) \ge 0$ and $d(f,g)=0 \Longleftrightarrow f=g$
> - $d(f,g) \le d(f,w) + d(w,g)$  **[triangle inequality]**
>
> A space with a distance is a **metric space**.

> [!definition|1.2.6] Completeness
> Let $(X,d)$ be a metric space. Let $f_n$ be a sequence in $X$ and $f$ be a candidate limit.
>
> 1. The sequence is **convergent** if $d(f_n,f)\to 0$ as $n\to +\infty$
> 2. The sequence is **Cauchy** if $d(f_n,f_m)\to 0$ as $n,m\to +\infty$
>
> In general, $1 \Longrightarrow 2$, but $2 \not\Longrightarrow 1$. Indeed,
> $$
> d(f_n,f_m) \le d(f_n,f) + d(f,f_m)
> $$
> by triangle inequality.
>
> If in a metric space, $1 \Longleftrightarrow 2$, then the metric space is **complete**.

> [!definition|1.2.7] Norm
> A norm is $\|\cdot\|_X: X \to \mathbb{R}$ such that
> - $\|f\|_X \ge 0$ and $\|f\|_X = 0 \Longleftrightarrow f=0$
> - $\|\lambda f\|_X = \lambda \|f\|_X$
> - $\|f+g\|_X \le \|f\|_X + \|g\|_X$
>
> A space is **normed** if a norm is defined.  
> A normed space is also a metric space:
> $$
> d(f,g) = \|f-g\|_X
> $$

> [!definition|1.2.8] Banach Space
> A Banach space is a complete normed space.

> [!definition|1.2.9] Scalar Product
> $(\cdot,\cdot)_X: X \times X \to \mathbb{R}$ is a symmetric bilinear form such that
> - $(f,g)_X = (g,f)_X$
> - $(f,f)_X \ge 0$ and $(f,f)_X = 0 \Longleftrightarrow f=0$
> - $\left|(f_1,f_2)_X\right| \le (f_1,f_1)_X^{1/2}(f_2,f_2)_X^{1/2}$  **[Cauchy-Schwarz Inequality]**
>
> A scalar product induces a norm:
> $$
> \|f\|_X^2 = (f,f)_X
> $$
> So, a space with a scalar product is automatically normed.

### Example 1.2.10

> [!example|1.2.10] A standard estimate from the scalar product
> $$
> \begin{aligned}
> (f_1+f_2,f_1+f_2)_X
> &= (f_1,f_1)_X + 2(f_1,f_2)_X + (f_2,f_2)_X \\
> &\le \|f_1\|_X^2 + 2\|f_1\|_X\|f_2\|_X + \|f_2\|_X^2 \\
> &= (\|f_1\|_X + \|f_2\|_X)^2
> \end{aligned}
> $$
> (Here the inequality step uses Cauchy–Schwarz on $(f_1,f_2)_X$.) Taking square-roots yields $\|f_1+f_2\|_X \le \|f_1\|_X+\|f_2\|_X$.

> [!definition|1.2.11] Hilbert Space
> A Hilbert space is a Banach space equipped with a scalar product.

> [!definition|1.2.12] Orthogonality
> The angle between two functions is defined as
> $$
> \angle(f_1,f_2):\ \cos(\varphi) = \frac{(f_1,f_2)}{\|f_1\|\|f_2\|} = \frac{(f_1,f_2)}{(f_1,f_1)^{1/2}(f_2,f_2)^{1/2}}
> $$
> Two functions are orthogonal to each other $\Longleftrightarrow (f,g)=0$. We denote $f \perp g$.

### Find the Best Approximation

Let $X_L \subset X$, where $X_L$ is “small.” $X_L$ and $X$ are both Hilbert spaces.

We want to find the best approximation $f_L$ of $f$ in $X_L$. So, we need to find $f_L$ s.t.
$$
(f - f_L, v_L) = 0 \quad \forall\, v_L \in X_L
$$

This is an extension of the Pythagorean Theorem. If $g_L \in X_L$:
$$
\begin{aligned}
\|f-g_L\|^2
&= (f-g_L,f-g_L) \\
&= (f-f_L + f_L-g_L,\ f-f_L + f_L-g_L) \\
&= \|f-f_L\|^2 + 2(f-f_L,f_L-g_L) + \|f_L-g_L\|^2 \\
&= \|f-f_L\|^2 + \underbrace{2(f-f_L,f_L-g_L)}_{=0,\ \text{orthogonality}} + \|f_L-g_L\|^2 \\
&= \|f-f_L\|^2 + \|f_L-g_L\|^2 \\
&\ge \|f-f_L\|^2
\end{aligned}
$$

---

## 1.2.1 Lebesgue Integration

> [!definition|1.2.13] $L^p$ Spaces
> $$
> L^p(a,b) = \left\{\, f:\ (L)\int_a^b f^p\,dx < +\infty \right\}, \quad \text{with } p=1,2,\ldots,\in \mathbb{N}
> $$
> Here, $(L)$ indicates that the integration is done in Lebesgue sense. $L^p(a,b)$ is the collection of functions that can be integrated in interval $(a,b)$ in the Lebesgue sense without blowing up.

These are Banach spaces with the norm
$$
\|f\|_p = \left(\int_a^b |f|^p\,dx\right)^{1/p}
$$

Similarly,
$$
L^\infty(a,b) = \left\{\, f:\ \text{bounded (up to all-measurable intervals) in }(a,b)\right\}
$$
is also a Banach space with norm
$$
\|f\|_\infty = \max_{(a,b)} |f|
$$

Specially, $L^2(a,b)$ or $L^2(\Omega)$ with $\Omega \subset \mathbb{R}$ is a Hilbert space:
$$
\begin{aligned}
(f,g) &= \int_a^b f g\,dx \\
\|f\|_2 &= \left(\int_a^b f^2\,dx\right)^{1/2} = (f,f)^{1/2}
\end{aligned}
$$

> [!definition|1.2.14] Conjugate Spaces
> $L^p$ and $L^q$ are called conjugated spaces if we have the function $f\in L^p(a,b)$ and $g\in L^q(a,b)$ with
> $$
> \frac{1}{p}+\frac{1}{q}=1
> $$
> We then have
> $$
> (L)\int_a^b f g\,dx < +\infty \quad \text{or}\quad f g \in L^1(a,b)
> $$

> [!remark|1.2.14] $L^2$ is conjugate with itself
> We have
> $$
> |(f,g)_{L^2}| \le \|f\|_2\|g\|_2
> $$

---

## 1.2.2 Distributional Derivatives

> [!definition|1.2.15] Dual Spaces
> The set of linear bounded functionals obtained on a space $X$ is per se a functional space, that we call **dual space** and denote as $X'$
> $$
> X' = \left\{\mathcal{F}(f)\ \text{for } f\in X,\ \text{linear and s.t.}\ \|\mathcal{F}(f)\|\le c\|f\|_X\right\}
> $$

> [!theorem|1.2.16] Riesz Representation Theorem
> In $L^2$, the dual of $L^2$ is isometric to $L^2$.  
> *(This means that any linear and continuous functional in $L^2$ corresponds to an element within $L^2$ itself.)*

> [!definition|1.2.17] Support
> The support of a function is where the function $\ne 0$ on the interval or region of the domain of definition. In particular, if the support is closed and bounded region, we say the function has **compact support**.

> [!definition|1.2.18] The Space $\mathcal{D}$
> $$
> \mathcal{D} = \{\text{functions in } C^\infty(\mathbb{R}^n)\ (n\ge 1)\ \text{with compact support}\}
> $$
>
> The dual space of $\mathcal{D}$, $\mathcal{D}'$ is defined in the following notion:
> $$
> \mathcal{D}':\ \langle T,f\rangle_{\mathcal{D}} \in \mathbb{R},\ \text{where } T\in\mathcal{D}'\ \text{is linear and continuous and } f\in\mathcal{D}
> $$
>
> $T$ to be continuous is defined in the following sense: Let $\mathrm{supp}(f_n)\subseteq K$ and $f_n\to f$ and $n\to\infty$. Then, $T$ is continuous if
> $$
> \langle T,f_n\rangle \to \langle T,f\rangle
> $$

> [!example|1.2.19] A distribution coming from a step function
> Let $H(x)$ be the step function
> $$
> H(x)=
> \begin{cases}
> 0 & \text{for } x\le 0 \\
> 1 & \text{for } x>0
> \end{cases}
> $$
> Then
> $$
> \langle T,f\rangle = \int_{-\infty}^{+\infty} H f\,dx = \int_0^{+\infty} f\,dx
> $$
> The functional $\langle T_0,f\rangle = f(0)$ belongs to $\mathcal{D}'$
> $$
> |\langle T_0,f\rangle| \le \max_{x\in\mathbb{R}} |f(x)|
> $$

> [!definition|1.2.20] Distributions
> The objects of $\mathcal{D}'$ are called **distributions** or generalized functions.

> [!theorem|1.2.21] Distributional derivative identity
> $$
> \langle T', f\rangle = -\langle T, f'\rangle
> $$

**Proof 1.** Let $g\in L^2$. Then
$$
\begin{aligned}
\langle g', f\rangle
&= \int_{\mathbb{R}} g' f \\
&= \underbrace{\big[g f\big]_{-\infty}^{+\infty}}_{=0\ \text{since } f\ \text{has compact support}} - \int_{\mathbb{R}} g f' \\
&= -\langle g, f'\rangle
\end{aligned}
$$
Note that $\big[g f\big]_{-\infty}^{+\infty}=0$ because $\lim_{x\to\infty} f=0$, and $f$ has compact support.

> [!example|1.2.22] Differentiating the step function gives the Dirac impulse
> Consider
> $$
> H(x)=
> \begin{cases}
> 0 & \text{for } x\le 0 \\
> 1 & \text{for } x>0
> \end{cases}
> $$
> Then, we can differentiate $H$
> $$
> \begin{aligned}
> \int_{-\infty}^{+\infty} H' f
> &= -\int_{-\infty}^{+\infty} H f' \\
> &= -\int_0^{+\infty} f' \\
> &= -[f]_0^{+\infty} \\
> &= f(0) \\
> &= \langle T_0, f\rangle
> \end{aligned}
> $$
> $T_0$ is called the Dirac-$\delta$ and it is the mathematical description of an impulse. It is not a function in the traditional sense.

> [!definition|1.2.23] Dirac-$\delta$
> Dirac-$\delta$ is the element in $\mathcal{D}'$ such that
> $$
> \langle \delta,f\rangle = f(0)
> $$
> We know that $H'=\delta$.

> [!theorem|1.2.24] Inclusion into $\mathcal{D}'$
> $$
> L^2 \subset \mathcal{D}'
> $$

---

## 1.2.3 Special Spaces

> [!definition|1.2.25] Sobolev Spaces
> Space $H^k(a,b)$ (or $H^k(\Omega)$) is the space of functions $f$ s.t. it belongs to $L^2$ together with all the derivatives up to the order $k$
> $$
> H^k(a,b)=\left\{\, f\ \text{s.t.}\ f,f',\ldots,f^{(k)}\in L^2 = H^0 \right\}
> $$
>
> In multiple dimensions, the derivatives are all the derivatives of order $k$
> $$
> \frac{\partial^{\alpha_1+\alpha_2+\cdots+\alpha_m} f}{\partial x_1^{\alpha_1}\partial x_2^{\alpha_2}\cdots \partial x_m^{\alpha_m}}
> \in L^2
> \quad \text{with}\quad \sum_i \alpha_i = k
> $$
>
> These spaces are called Sobolev spaces. A more generalized definition
> $$
> W^{k,p}=\left\{\, f\ \text{s.t.}\ f,f',\ldots,f^{(k)}\in L^p \right\}
> $$
> So, $H^k = W^{k,2}$.

> [!theorem|1.2.26] Properties of $H^k$
> - $H^k(a,b)$ is a Hilbert space with the scalar product
>   $$
>   (f,g)_{H^k} = \sum_{i=0}^k (f^{(i)},g^{(i)})_{L^2}
>   $$
> - $H^1(a,b)$ has the norm
>   $$
>   \|f\|_{H^1}^2 = \|f\|_{L^2}^2 + \|f'\|_{L^2}^2
>   $$
> - $H^1 \subset L^2$. So,
>   $$
>   \|f\|_{H^1}^2 \ge \|f\|_{L^2}^2
>   $$
> - In general,
>   $$
>   H^{k+1} \subset H^k \subset \cdots \subset L^2
>   $$

> [!definition|1.2.27] Trace Operator
> Trace is an operator that maps a function in $H^k$ to its value of the boundary, and, in general, reduces regularity.
> $$
> \gamma:\ H^k(\Omega)\to H^{k-\frac{1}{2}}(\partial\Omega)
> $$
> is the (continuous) trace operator.

> [!definition|1.2.28] The Space $H_0^1$
> The space $H_0^1(\Omega)$ is the space of $H^1$ functions with null trace on $\partial\Omega$.

> [!theorem|1.2.29] Poincare Inequality
> $\exists\, c>0$ s.t. for $f\in H_0^1(\Omega)$
> $$
> \|f\|_{L^2} \le c\|\nabla f\|_{L^2}
> $$
> Therefore,
> $$
> \begin{aligned}
> \|\nabla f\|_{L^2}^2
> &\le \underbrace{\|f\|_{L^2}^2 + \|\nabla f\|_{L^2}^2}_{\|f\|_{H_0^1}^2}
> \le (1+c^2)\|\nabla f\|_{L^2}^2
> \end{aligned}
> $$
> Hence, in $H_0^1(\Omega)$, the norm of $\nabla f$ in $L^2$ and of_
