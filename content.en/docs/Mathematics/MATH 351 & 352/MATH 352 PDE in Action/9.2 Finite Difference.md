---
title: 有限差分
weight: "9.2"
---

## 2. 有限差分（Finite Difference）

### 2.1 The BVP:
$$
\begin{align}
-\mu\frac{d^2u}{dx^2} &= f, \quad x \in (0,1) \\
u(0) &= u(1) = 0
\end{align}
$$

$$0 = x_0 < x_1 < x_2 < x_3 < \cdots < x_N = 1$$

$$-\mu\frac{d^2u}{dx^2}(x_i) = f(x_i)$$

Use Taylor's formula:
$$
\begin{align}
u(x_{i+1}) &= u(x_i) + \frac{du}{dx}(x_i)\Delta x + \frac{1}{2}\frac{d^2u}{dx^2}(x_i)\Delta x^2 + \cdots \\
u(x_{i-1}) &= u(x_i) - \frac{du}{dx}(x_i)\Delta x + \frac{1}{2}\frac{d^2u}{dx^2}(x_i)\Delta x^2 + \cdots
\end{align}
$$

Then,
$$
\begin{align}
u(x_{i+1}) + u(x_{i-1}) &= 2u(x_i) + \frac{d^2u}{dx^2}(x_i)\Delta x^2 + \frac{1}{12}\frac{d^4u}{dx^4}(x_i)\Delta x^4 + \mathcal{O}(||\Delta x||^6) \\
\frac{d^2u}{dx^2}(x_i)\Delta x^2 &= u(x_{i+1}) + u(x_{i-1}) - 2u(x_i) - \frac{1}{12}\frac{d^4u}{dx^4}(x_i)\Delta x^4 + \mathcal{O}(||\Delta x||^6)
\end{align}
$$

$$\frac{d^2u}{dx^2}(x_i) = \frac{u(x_{i+1}) + u(x_{i-1}) - 2u(x_i)}{\Delta x^2} - \frac{1}{12}\frac{d^4u}{dx^4}(x_i)\Delta x^2 + \mathcal{O}(||\Delta x||^2)$$

So, second order derivative approximation:
$$\frac{d^2u}{dx^2}(x_i) \approx \frac{u(x_{i+1}) + u(x_{i-1}) - 2u(x_i)}{\Delta x^2}$$

Denote $u_i = u(x_i)$ and $f_i = f(x_i)$. Then,
$$-\mu\frac{d^2u}{dx^2}(x_i) = -\mu\frac{u_{i+1} + u_{i-1} - 2u_i}{\Delta x^2} = f_i$$

Then, we form a linear system $Au = f$, where $A$ is given by:

$$A = \frac{\mu}{\Delta x^2}
\begin{bmatrix}
2 & -1 & 0 & & \\
-1 & \ddots & \ddots & & \\
0 & \ddots & \ddots & \ddots & \\
 & & \ddots & \ddots & -1 \\
 & & & -1 & 2
\end{bmatrix}
$$

### 2.2 What is the Accuracy of FD?

1. $Au = f$ is solvable b/c $A$ is positive definite $(x^TAx > 0 \quad \forall x \neq 0)$
2. Since $A$ is symmetric, all eigenvalues of $A$ are real. Further, since $A$ is positive definite, all eigenvalues are positive. So, $A$ is non-singular.
3. $\frac{\lambda_{min}}{\lambda_{max}} \propto \Delta x$
4. $Au = f$. But $Au_{ex} \neq f$.
   $$Au_{ex} = \left[\frac{d^2u}{dx^2}(x_i)\right] + T_i$$
   where $T_i = C(x_i)\Delta x^2$. From previously noted,
   $$C(x_i) = C\frac{d^4u}{dx^4}(x_i)$$

So, one can write: $Au_{ex} = f + T$.

Define $e = u_{ex} - u$. Then, $Ae = T$.

$$e = A^{-1}T$$

$$||e|| = ||A^{-1}T|| \leq ||A^{-1}|| \cdot ||T||$$

So, to have convergence we need:
$$||A^{-1}|| < \infty \quad \text{and} \quad ||T|| \to 0 \quad \text{as} \quad \Delta x \to 0$$

As shown before, $\frac{\lambda_{min}}{\lambda_{max}} \propto \Delta x$, we know $||A^{-1}||$ is bound regardless of $\Delta x$.

Since $||T|| \sim \Delta x^2$, $||T|| \to 0$ as $\Delta x \to 0$. Then, the method is consistent.

Further, we have $||e|| \to 0$ as $\Delta x \to 0$.

So, this method is convergent.
