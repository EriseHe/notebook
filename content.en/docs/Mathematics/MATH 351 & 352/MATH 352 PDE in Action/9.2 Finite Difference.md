---
title: 9.2 有限差分法
weight: "9.2"
---
## 2.1 边值问题（BVP）的有限差分:

> [!claim]
> Consider the Boundary-Value Problem:


> $$
\begin{align}
-\mu\frac{d^2u}{dx^2} &= f, \quad x \in (0,1) \\
u(0) &= u(1) = 0
\end{align}
> $$
> with discrete points: $$0 = x_0 < x_1 <  \cdots < x_{N} = 1\quad\Longrightarrow \quad-\mu\frac{d^2u}{dx^2}(x_i) = f(x_i)$$

## 2.2 推导二阶中心差分近似法

### 2.2.1 Poisson 微分方程

对与任意一个离散的点$x_{i}$，我们首先在网格点 $x_{i+1} = x_i + \Delta x$ 和 $x_{i-1} = x_i - \Delta x$ 处对函数 $u(x)$ 进行泰勒级数展开：

$$
\begin{align}
u(x_{i+1}) &= u(x_i) + \frac{du}{dx}(x_i)\Delta x + \frac{1}{2}\frac{d^2u}{dx^2}(x_i)\Delta x^2 + \cdots \\
u(x_{i-1}) &= u(x_i) - \frac{du}{dx}(x_i)\Delta x + \frac{1}{2}\frac{d^2u}{dx^2}(x_i)\Delta x^2 + \cdots
\end{align}
$$

当我们将这两个方程相加时，由于奇数阶导数项的符号相反，它们会相互抵消：

$$
\begin{align}
u(x_{i+1}) + u(x_{i-1}) &= 2u(x_i) + 2\left(\frac{1}{2}\frac{d^2u}{dx^2}(x_i)\Delta x^2\right) + 2\left(\frac{1}{24}\frac{d^4u}{dx^4}(x_i)\Delta x^4\right) + \mathcal{O}(\Delta x^6) \\
\\
&= 2u(x_i) + \frac{d^2u}{dx^2}(x_i)\Delta x^2 + \frac{1}{12}\frac{d^4u}{dx^4}(x_i)\Delta x^4 + \mathcal{O}(\Delta x^6) 
\end{align}
$$

接着, 我们重新整理方程以分离出二阶导数项（舍去高阶项）

$$\begin{align}
\frac{d^2u}{dx^2}(x_i)\Delta x^2 &= u(x_{i+1}) + u(x_{i-1}) - 2u(x_i) - \frac{1}{12}\frac{d^4u}{dx^4}(x_i)\Delta x^4 + \mathcal{O}(||\Delta x||^6)\\
\frac{d^2u}{dx^2}(x_i) &= \frac{u(x_{i+1}) + u(x_{i-1}) - 2u(x_i)}{\Delta x^2} - \frac{1}{12}\frac{d^4u}{dx^4}(x_i)\Delta x^2 + \mathcal{O}(||\Delta x||^2) \\ 
&\approx \boxed{ \frac{u(x_{i+1}) + u(x_{i-1}) - 2u(x_i)}{\Delta x^2}}
\end{align}$$

记 $u_i = u(x_i)$ 与 $f_i = f(x_i)$. 因此我们得到微分方程

> [!claim|*]
> $$-\mu\frac{d^2u}{dx^2}(x_i) = -\mu\frac{u_{i+1} + u_{i-1} - 2u_i}{\Delta x^2} = f_i$$

> 1. 截断误差（Truncation Error）为 $\mathcal{O}(\Delta x^2)$
> 2. 这证实了该近似是二阶精度 （second-order accuracy）


### 2.2.2 构建线性系统

用这种离散化方法推导出一个线性方程组（linear system）:

$$Au = f$$

where $A$ is given by:

$$A = \frac{\mu}{\Delta x^2}
\begin{bmatrix}
2 & -1 & 0 & & \\
-1 & \ddots & \ddots & & \\
0 & \ddots & \ddots & \ddots & \\
 & & \ddots & \ddots & -1 \\
 & & & -1 & 2
\end{bmatrix}
$$

## 2.3 What is the Accuracy of FD?

### 矩阵A的关键性质 (Key Properties of Matrix A)

从差分离散化得到的matrix $A$有几个重要性质：

1. **正定性 (Positive Definiteness)**：$x^TAx > 0 \quad \forall x \neq 0$ $\Longrightarrow$ solvable。 
2. **对称性 (Symmetry)**：Symmetry $\Longrightarrow \forall \,\lambda \in \mathbb{R}$
3. **特征值性质 (Eigenvalue Properties)**：Non-singular
4. **条件数关系 (Condition Number Relation)**：A的最小特征值与最大特征值之比与Δx成正比，即$$\frac{\lambda_{min}}{\lambda_{max}} \propto \Delta x$$

### 误差

当我们解离散系统（$Au = f$）时，精确解$u_{ex}$与近似解$u$之间存在误差，所以$Au_{ex} \neq f$。



精确关系实际上为：

> [!claim]
> $$Au_{ex} = f + T$$
> where $T_i = C(x_i)\Delta x^2$ is truncation error

其中$C(x_i)$与四阶导数相关：$$C(x_i) = C\frac{d^4u}{dx^4}(x_i)$$

### 误差方程 (Error Equation)

若定义误差$e = u_{ex} - u$，则
$$Ae = T$$

$$\Longrightarrow e = A^{-1}T$$

因此

$$||e|| = ||A^{-1}T|| \leq ||A^{-1}|| \cdot ||T||$$



### 收敛性证明 (Convergence Proof)

为了证明方法收敛，需要满足两个条件：1. 稳定性：**$A^{-1}$有界 (Boundedness of $A^{-1}$)** 2. 一致性：**截断误差趋零 (Truncation Error Tends to Zero)**

> [!lemma|*]
> Conditions to show convergence:
> $$||A^{-1}|| < \infty \quad \text{and} \quad ||T|| \to 0 \quad \text{as} \quad \Delta x \to 0$$

#### 关于 $\|A^{-1}\|$ 的有界性

- 矩阵的条件数定义为：

$$\kappa(A) = \|A\| \cdot \|A^{-1}\|=\frac{\lambda_{max}}{\lambda_{min}}$$

- $\frac{\lambda_{min}}{\lambda_{max}} \propto \Delta x \longrightarrow\kappa(A) \propto \frac{1}{\Delta x}$
- hence, $||A^{-1}||$ is bounded, regardless of $\Delta x$.


#### 关于$T$的一致性

因为截断误差范数$\|T\| \sim \Delta x^2$，所以


$$\|T\| \to 0 \,\,\text{as}\,\, \Delta x \to 0$$


这也意味着：

$$\|e\| \to 0 \,\,\text{as}\,\, \Delta x \to 0$$

- 因此，该有限差分方法是收敛的 (convergent)

> 虽然$\kappa$随 $\Delta x$ 变化，但 $\|A^{-1}\|$ 的增长被 $\|T\|$ 的更快减小所抵消。




### 实际意义？


1. 该有限差分法随着网格间距 (grid spacing) 减小而收敛到精确解
2. 收敛速率 (convergence rate) 是$O(\Delta x^2)$，即二阶精度 (second-order accuracy)
3. 误差主要受控于四阶导数的大小和网格间距的平方
4. 这解释了为什么在实际计算中，当我们将网格间距减半时，误差大约会减小到原来的四分之一

这种数学证明为我们使用有限差分法求解微分方程提供了理论保障，确保了在足够细的网格下，数值解 (numerical solution) 会以可预测的速率接近真实解 (exact solution)。
