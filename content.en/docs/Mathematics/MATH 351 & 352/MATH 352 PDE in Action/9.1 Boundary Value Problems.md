---
title: 9.1 边值问题的近似
weight: "9.1"
---

## 1. 边值问题的近似

### 1.1 Problem Set-up: 固定端点的弦（String with Fixed Endpoints）

我们可以写
$$
\begin{align}
-\frac{d^2u}{dx^2} &= f(x), \quad x \in (0,1) \\
u(0) &= \alpha, \quad \frac{du}{dx}(0) = \beta
\end{align}
$$

记$w = \frac{du}{dx}$，那么 $\frac{dw}{dx} = f(x)$。因此，我们知道
$$\frac{d}{dt} = \begin{bmatrix} 0 & 0 \\ 1 & 0 \end{bmatrix} \begin{bmatrix} w \\ u \end{bmatrix}$$
#### 定义

边值问题（boundary-value problem）的定义为
> [!definition|*]
> $$\begin{align}
-\mu\frac{d^2u}{dx^2} &= f(x), \quad x\in (0,1), \quad \mu > 0 \\
u(0) &= \alpha, \quad u(1) = \beta
\end{align}
> $$
### 1.2 Example: 泊松方程（Poisson Equation）
此类方程的二维形态为：
$$
\begin{align}
-\left(\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}\right) &= f(x,y) \\
u|_{\text{boundary of }\Omega} &= 0
\end{align}
$$
用拉普拉斯算子来表示：
$$
\left(\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}\right) = \Delta u, \quad \text{where }\Delta = \nabla^2 u = \sum_{i=1}^{n} \frac{\partial^2}{\partial x_i^2}$$

所以，广义的泊松方程可以写为
> [!definition]
> A general ($n$-dimentional) poisson equation is written as $$\Delta u = f(\mathbf{x})$$
> where $\mathbf{x}=(x_{1},x_{2},x_{3}\dots x_{n})$.




### 1.3 Back to the String Example: How can we get a BVP?

考虑以下经典力学中很常见的弦的能量**泛函**（energy functional）：

$$J(u) = \frac{1}{2}\int_0^1 \mu\left(\frac{du}{dx}\right)^2 dx - \int_0^1 f \cdot u \, dx \quad \text{(Energy of string)}$$

Boundary condition: $u(0) = u(1) = 0$.

作为自然界的基本趋势中，**最小作用量原理**解释了自然系统倾向于采取能量消耗最小的路径或状态，也就是说，自然会沿着$\min J(u)$的路径发展。

最简单的方法是直接用 欧拉-拉格朗日方程（Euler–Lagrange equation）搞定，但是这毕竟是个数学课，那么我们用最暴力的原始方法解决：

大致思路为：
1. 把 $u$ 加入扰动（perturbation）变成 $u+εv$：

$$u_{\epsilon}(x) = u(x) + \epsilon v(x)$$

2. $J(u+εv)$ 进行显式展开：
$$J(u + \epsilon v) = J(u) + \epsilon \underbrace{\delta J(u; v)}_{\text{一阶变分}} + \frac{1}{2} \epsilon^2 \underbrace{\delta^2 J(u; v)}_{\text{二阶变分}} + \cdots
$$

> 在变分法或力学的语言里：通常是指在能量或作用量（action）等泛函意义下的驻点（stationary point）：也就是对任意“小扰动” $εv$，该函数 $u$ 都使得泛函的一阶变化量为 0。


2. 求导，来找$J$的最小值

$$\lim_{\varepsilon \to 0} \frac{J(u + \varepsilon v) - J(u)}{\varepsilon} = 0, \quad \varepsilon \in \mathbb{R}$$


显然易见：
$$
\begin{align}
&\frac{1}{2}\int_0^1 \mu\left(\frac{du}{dx} + \varepsilon\frac{dv}{dx}\right)^2 dx - \int_0^1 f(u+\varepsilon v) \, dx - \frac{1}{2}\int_0^1 \mu\left(\frac{du}{dx}\right)^2 dx - \int_0^1 f \cdot u \, dx \\
&= \frac{1}{2}\int_0^1 \mu\left(\frac{du}{dx}\right)^2 dx + \frac{1}{2} \cdot 2\varepsilon \int_0^1 \mu \frac{du}{dx} \cdot \frac{dv}{dx} \, dx + \frac{1}{2}\varepsilon^2 \int_0^1 \mu\left(\frac{dv}{dx}\right)^2 dx \\
&\quad - \int_0^1 f \cdot u \, dx - \varepsilon\int_0^1 f \cdot v \, dx - \frac{1}{2}\int_0^1 \mu\left(\frac{du}{dx}\right)^2 dx - \int_0^1 f \cdot u \, dx \\
&= \varepsilon \int_0^1 \mu \frac{du}{dx} \cdot \frac{dv}{dx} \, dx + \frac{1}{2}\varepsilon^2 \int_0^1 \mu\left(\frac{dv}{dx}\right)^2 dx - \varepsilon\int_0^1 f \cdot v \, dx
\end{align}
$$

> 这实际上正是欧拉–拉格朗日方程最早的“原始变分法”推导，也正是 E-L 方程的来龙去脉。只不过 E-L 方程把这个过程“公式化”了，让我们不必每次都展开一大堆项、再分部积分去凑出那个通用形式。

然后
$$\frac{J(u+\varepsilon v) - J(u)}{\varepsilon} = \int_0^1 \mu \frac{du}{dx} \cdot \frac{dv}{dx} \, dx + \frac{1}{2} \varepsilon \int_0^1 \mu\left(\frac{dv}{dx}\right)^2 dx - \int_0^1 f \cdot v \, dx$$

极限为：
$$\lim_{\varepsilon \to 0} \frac{J(u+\varepsilon v) - J(u)}{\varepsilon} = \int_0^1 \mu \frac{du}{dx} \cdot \frac{dv}{dx} \, dx - \int_0^1 f \cdot v \, dx = 0$$

一个“平衡解”（equilibrium solution）。


#### 变分形式或弱形式（Variational/Weak）:

由此我们得到了一个泛函的“变分条件”：
> [!claim|*]
> $$\int_0^1 \mu \frac{du}{dx} \cdot \frac{dv}{dx} \, dx - \int_0^1 f \cdot v \, dx = 0$$

分部积分:
$$
\begin{align}
\int_0^1 \mu \frac{du}{dx} \cdot \frac{dv}{dx} \, dx &= \mu\left[\frac{du}{dx}v\right]_0^1 - \mu\int_0^1 \frac{d^2u}{dx^2} v \, dx \\
&= -\mu\int_0^1 \frac{d^2u}{dx^2} v \, dx
\end{align}
$$

Since $v(0) = v(1) = 0$

$$\frac{d}{dx}\left(\frac{du}{dx}\right) = \frac{d^2u}{dx^2}$$

$$\int \frac{dv}{dx} \, dx = v$$

边界项因为BC而消失，所以弱形式$\rightarrow$**强形式**:
$$-\mu\int_0^1 \frac{d^2u}{dx^2} v \, dx - \int_0^1 f \cdot v \, dx = 0$$

$$-\int_0^1 \left(\mu\frac{d^2u}{dx^2} + f\right) \cdot v \, dx = 0$$

We want it to be true $\forall v$. So, it must be:
$$\mu\frac{d^2u}{dx^2} + f = 0$$



我们得到一个常见的附带边界条件的强形式**常微分方程**(ODE)。

> [!claim|*]
>  We obtain a Boundary Value Problem (BVP):
> $$
\begin{align}
\mu u''(x) +f&= 0 \\
u(0) &= u(1) = 0
\end{align}
> $$




> Assumption: $u$ is at least $C^2$.

### 1.4 两种表述边值问题（BVP）的方式

1. 寻找函数 $u$，使得对所有满足 $v(0) = v(1) = 0$ 的 $v$，均有
   $$
   \int_0^1 \mu \frac{du}{dx} \cdot \frac{dv}{dx} \, dx \;=\; \int_0^1 f \cdot v \, dx
   $$
   
   - $\Rightarrow$ $u$ 只需保证“一阶可微”
   - $\Rightarrow$ 通常采用 **有限元法** (Finite Element)

2. 寻找函数 $u$，使得
   $$
   \begin{aligned}
   -\mu \frac{\partial^2 u}{\partial x^2} &= f, \quad x \in (0,1),\\
   u(0) &= 0,\quad u(1) = 0
   \end{aligned}
   $$
   
   - $\Rightarrow$ $u$ 需要至少“二阶可微”
   - $\Rightarrow$ 通常采用 **有限差分法** (Finite Difference)



