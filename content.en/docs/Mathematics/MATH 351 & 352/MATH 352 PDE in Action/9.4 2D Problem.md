---
title: 9.4 二维问题（2D Problem)
weight: "9.4"
---


$$
\begin{align}
-\mu\Delta u + \vec{\beta} \cdot \nabla u &= f \\
u(\partial\Omega) &= \text{data}
\end{align}
$$

Write it out:
$$
\begin{align}
-\mu\left(\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}\right) + \beta_x\frac{\partial u}{\partial x} + \beta_y\frac{\partial u}{\partial y} &= f(x,y) \\
u(\partial\Omega) &= d
\end{align}
$$

### 4.1 Only Consider Diffusion. Turn off Wind:

To form a system: $(i,j) \to k$.

$Au = b$.

$A$ is symmetric, SPD.

### 4.2 Turn on the Wind. Upwind
With upwind, the pts are not good.

## 5. Parabolic Problems
$$
\begin{align}
\frac{\partial u}{\partial t} - \mu\frac{\partial^2 u}{\partial x^2} &= f, \quad x \in (0,1) \quad 0 < t < T\\
u(0,t) &= u_L(t), \quad u(1,t) = u_R(t) \\
u(x, t=0) &= u_0(x)
\end{align}
$$

Discretization along $x$: semi-discretization: $u_j(t) \approx u(x_j, t)$.
$$\frac{du_j}{dt} - \mu\frac{u_{j+1}(t) - 2u_j(t) + u_{j-1}(t)}{\Delta x^2} = f_j(t) = f(x_j, t)$$

So, we form system $Au = f$.

$$A = \frac{\mu}{\Delta x^2}\text{Triad}(-1, 2, 1), \quad u(t) = \begin{bmatrix} u_1(t) \\ \vdots \\ u_n(t) \end{bmatrix}, \quad f(t) = \begin{bmatrix} f_1(t) \\ \vdots \\ f_n(t) \end{bmatrix}$$

Then, we have a system of ODE:
$$\frac{du}{dt} - Au = f$$

We can now do time discretization and use ODE methods.

1. EE/FE:
   $$u^n = u(t^n), \quad \left.\frac{du}{dt}\right|_{t^n} \approx \frac{u^{n+1} - u^n}{\Delta t} = f^n + Au^n$$
   
   $$u^{n+1} = u^n + \Delta t Au^n + \Delta t f^n = (I + \Delta t A)u^n + \Delta t f^n = (I + \Delta t A)^n u_0 + \Delta t f^n$$

2. IE/BE:
   $$\left.\frac{du}{dt}\right|_{t^n} = \frac{u^n - u^{n-1}}{\Delta t} = f^n + Au^n$$
   
   $$u^n - u^{n-1} = \Delta t f^n + \Delta t Au^n$$
   
   $$u^n - \Delta t Au^n = \Delta t f^n + u^{n-1}$$
   
   $$(I - \Delta t A)u^n = u^{n-1} + \Delta t f^n \quad \leftarrow \text{A linear system to solve}$$

$I - \Delta t A$ is SPD and $A$ is time-independent. So, we may favor direct method (as we can store $A = LU$ and reuse it) over iterative methods.

To discuss stability, set $f = 0$:

1. EE is conditionally stable:
   Let $\lambda_i$ be eigenvalues of $A$.
   
   $$\Delta t < \frac{2}{|\lambda_i|} \quad \text{for stability}$$
   
   Further, $A = \frac{\mu}{\Delta x^2}\text{triad}(1, -2, 1)$, $\rho(A) \sim \frac{c}{\Delta x^2}$. So,
   
   $$\Delta t < \frac{2}{|\lambda_i|} \leq \frac{2}{\rho(A)} = \frac{2}{c}\Delta x^2$$
   
   So, if we decrease $\Delta x$ by 2, to have stability
   
   $$\Delta t_{new} < \frac{2}{c}\left(\frac{\Delta x}{2}\right)^2 = \frac{\Delta t_{old}}{4} \quad \Rightarrow \text{we need finer intervals for time}$$

2. IE is unconditionally stable.

3. Def. ($\theta$ Methods).
   $$\frac{u^{n+1} - u^n}{\Delta t} = \theta Au^{n+1} + (1-\theta)Au^n + \theta f^{n+1} + (1-\theta)f^n, \quad \theta \in [0,1]$$
   
   EE: $\theta = 0 \quad \mathcal{O}(\Delta t) \quad$ explicit $\quad$ conditional stability
   
   IE: $\theta = 1 \quad \mathcal{O}(\Delta t) \quad$ implicit $\quad$ unconditional stability
   
   CN: $\theta = \frac{1}{2} \quad \mathcal{O}(\Delta t^2) \quad$ implicit $\quad$ unconditional stability

Suppose $f = 0$. Then,
$$\frac{u^{n+1} - u^n}{\Delta t} = \theta Au^{n+1} + (1-\theta)Au^n$$

$$u^{n+1} - u^n = \Delta t \theta Au^{n+1} + \Delta t(1-\theta)Au^n$$

$$(I - \Delta t \theta A)u^{n+1} = (I + \Delta t(1-\theta)A)u^n$$

We essentially solve a linear system in each iteration.

### 5.1 Thm (Stability and Order of $\theta$ Methods)
- $\theta$ methods are unconditionally stable for $\theta \geq \frac{1}{2}$. Otherwise, it is conditionally stable for $\theta < \frac{1}{2}$ and the stability condition for parabolic problem is $\Delta t < c\Delta x^2$.
- Meanwhile, the method is order 1 for $\theta \neq \frac{1}{2}$ and order 2 for $\theta = \frac{1}{2}$.
- Although the $\theta$ method is 2nd order in space, the order of error is dominant and determined by the order in time.
- CN is the most vulnerable to lack of regularity and sensitive to non-smoothness.

## 6. Hyperbolic Problems

### 6.1
$
\begin{align}
\frac{\partial u}{\partial t} + \alpha\frac{\partial u}{\partial x} &= 0, \quad \alpha > 0, \text{ constant} \\
u(x,0) &= u_0(x)
\end{align}
$

Exact solution: $u(x,t) = u_0(x - \alpha t)$

### 6.2 Example: Modeling Density of Pollutant
$u$: pollutant, $x$: displacement of boat, $t$: time.

$$
\begin{align}
\frac{du}{dx} &= 0 \quad \text{(i.e, pollutant and boat moves at the same velocity)} \\
\frac{dx}{dt} & = a \quad \text{(i.e., boat moves at velocity of $a$)}
\end{align}

$$

$x(t) = x_0 + at \Rightarrow$ characteristic curves

$u(x,t) = u_0(x-at)$. Solution to $\begin{cases} \frac{dx}{dt} = a \\ x(0) = x_0 \end{cases}$

Consider $u(x(t),t)$: $\frac{du}{dt} = \frac{\partial u}{\partial t} + \frac{\partial u}{\partial x} \cdot \frac{dx}{dt} = \frac{\partial u}{\partial t} + a \cdot \frac{\partial u}{\partial x} = 0$.

### 6.3 Similar Problems:
1. Conservation law
   $\frac{\partial u}{\partial t} + \frac{\partial q(u)}{\partial x} = 0$
   
   $q(u) = v(u) \cdot u$ with $v = v_{max}\left(1 - \frac{u}{u_{max}}\right)$
   
   $\Rightarrow \frac{\partial u}{\partial t} + v_{max}\left(1 - \frac{u}{u_{max}}\right)\frac{\partial u}{\partial x} = 0$. Models the density of traffic.
   
   $= \alpha$, but $\alpha$ is not constant here.

2. Heat equation
   $\frac{\partial^2 u}{\partial t^2} - v^2\frac{\partial^2 u}{\partial x^2} = f$
   
   Define $w_1 = \frac{\partial u}{\partial x}$ and $w_2 = \frac{\partial u}{\partial t}$.
   
   $
   \begin{align}
   \frac{\partial w_1}{\partial t} - v^2\frac{\partial w_2}{\partial x} &= f \\
   \frac{\partial w_2}{\partial t} - \frac{\partial w_1}{\partial x} &= 0 \quad \frac{\partial^2 u}{\partial x \partial t} = \frac{\partial^2 u}{\partial t \partial x}
   \end{align}
   $
   
   Define $w = \begin{bmatrix} w_1 \\ w_2 \end{bmatrix}$, $A = \begin{bmatrix} 0 & -v^2 \\ -1 & 0 \end{bmatrix}$
   
   Then, the original equation becomes a system:
   $\frac{\partial w}{\partial t} + A\frac{\partial w}{\partial x} = 0$
   
   The eigenvalues of $A$: $\lambda_{1,2} = \pm iv$. $\Rightarrow$ Diagonalizable.

Find the numerical solution.

$\frac{\partial u}{\partial t}\bigg|_{t^{n+1}, x_j} = \frac{u_j^{n+1} - u_j^n}{\Delta t}$

$\alpha\frac{\partial u}{\partial x}\bigg|_{t^{n+1}, x_j} = \frac{\alpha}{2} \cdot \frac{u_{j+1}^{n+1} - u_{j-1}^{n+1}}{\Delta t}$

- With BE-C:
  $\frac{u_j^{n+1} - u_j^n}{\Delta t} + \frac{\alpha}{2} \cdot \frac{u_{j+1}^{n+1} - u_{j-1}^{n+1}}{\Delta t} = 0$
  
  $
  \Rightarrow
  \begin{bmatrix}
  \frac{1}{\Delta t} & \frac{\alpha}{2\Delta t} & 0 & 0 & \cdots \\
  -\frac{\alpha}{2\Delta t} & \frac{1}{\Delta t} & \frac{\alpha}{2\Delta t} & 0 & \cdots \\
  & & \ddots & &
  \end{bmatrix}
  $

- With FE-C: unconditionally unstable. NEVER USE IT!
  $\frac{u_j^{n+1} - u_j^n}{\Delta t} + \frac{\alpha}{2} \cdot \frac{u_{j+1}^n - u_{j-1}^n}{\Delta t} = 0$
  
  $\Rightarrow u_j^{n+1} = u_j^n + \frac{\alpha\Delta t}{2\Delta t}(u_{j+1}^n - u_{j-1}^n)$

- With FE-Upwind:
  $\frac{u_j^{n+1} - u_j^n}{\Delta t} + \alpha\frac{u_j^n - u_{j-1}^n}{\Delta x} = 0 \quad \alpha > 0$
  
  $\frac{u_j^{n+1} - u_j^n}{\Delta t} + \alpha\frac{u_{j+1}^n - u_j^n}{\Delta x} = 0 \quad \alpha < 0$
  
  $\frac{u_j^{n+1} - u_j^n}{\Delta t} + \frac{\alpha}{2}\frac{u_{j+1}^n - u_{j-1}^n}{\Delta x} - \frac{|\alpha|\Delta t}{2}\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\Delta x^2} = 0$
  
  Diffusion

- Lax Wendroff: FE-upwind with modified coefficient
  $\frac{u_j^{n+1} - u_j^n}{\Delta t} + \frac{\alpha}{2}\frac{u_{j+1}^n - u_{j-1}^n}{\Delta x} - \frac{\alpha^2\Delta t}{2}\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\Delta x^2} = 0$
  
  $u(x_j, t^{n+1}) = u(x_j, t^n) + \frac{\partial u}{\partial t}\bigg|_{t^n, x_j}(t^{n+1} - t^n) + \frac{1}{2}\frac{\partial^2 u}{\partial t^2}\bigg|_{t^n, x_j}(t^{n+1} - t^n)^2 + \mathcal{O}(||t^{n+1} - t^n||^3)$

$\frac{\partial u}{\partial t} = -\alpha\frac{\partial u}{\partial x}, \quad \frac{\partial^2 u}{\partial x \partial t} = -\alpha\frac{\partial^2 u}{\partial x^2}, \quad \frac{\partial^2 u}{\partial t^2} = \alpha^2\frac{\partial^2 u}{\partial x^2}$

Substitute:
$u_j^{n+1} = u_j^n - \alpha\left(\frac{u_{j+1}^n - u_{j-1}^n}{2\Delta x}\right)\Delta t + \frac{\alpha^2}{2}\left(\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\Delta x^2}\right)\Delta t^2$

Stability: $\left|\frac{\alpha\Delta t}{\Delta x}\right| \leq 1$