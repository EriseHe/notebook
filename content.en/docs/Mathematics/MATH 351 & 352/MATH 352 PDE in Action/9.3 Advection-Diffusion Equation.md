---
title: 对流-扩散方程
weight: "9.3"
---

### 3.1 对流-扩散方程
$$
\begin{align}
-\mu\frac{\partial^2 u}{\partial x^2} + \beta\frac{\partial u}{\partial x} &= f \\
\text{diffusion} \quad & \text{advection}
\end{align}
$$

$$u(0) = u_L, \quad u(1) = u_R$$

Discretization:

By Taylor's Expansion:
$$u(x_{j+1}) = u(x_j) + \frac{\partial u}{\partial x}(x_j)\Delta x + \frac{1}{2}\frac{\partial^2 u}{\partial x^2}(x_j)\Delta x^2 - \frac{1}{6}\frac{\partial^3 u}{\partial x^3}(x_j)\Delta x^3 + \frac{1}{12}\frac{\partial^4 u}{\partial x^4}(x_j)\Delta x^4 + \mathcal{O}(||x||^5)$$

$$\frac{\partial u}{\partial x}(x_j)\Delta x = u(x_{j+1}) - u(x_j) + \frac{1}{2}\frac{\partial^2 u}{\partial x^2}(x_j)\Delta x^2$$

$$\frac{\partial u}{\partial x}(x_j) = \frac{u_{j+1} - u_j}{\Delta x} + \frac{1}{2}\frac{\partial^2 u}{\partial x^2}(x_j)\Delta x$$

Can we do better?

$$u(x_{j-1}) = u(x_j) - \frac{\partial u}{\partial x}(x_j)\Delta x + \frac{1}{2}\frac{\partial^2 u}{\partial x^2}(x_j)\Delta x^2 - \frac{1}{6}\frac{\partial^3 u}{\partial x^3}(x_j)\Delta x^3 + \frac{1}{12}\frac{\partial^4 u}{\partial x^4}(x_j)\Delta x^4 + \mathcal{O}(||x||^5)$$

(1) - (2):
$$u(x_{j+1}) - u(x_{j-1}) = 2\frac{\partial u}{\partial x}(x_j)\Delta x + \frac{1}{3}\frac{\partial^3 u}{\partial x^3}(x_j)\Delta x^3 + \mathcal{O}(||\Delta x||^5)$$

Then,
$$\frac{\partial u}{\partial x}(x_j) = \frac{u(x_{j+1}) - u(x_{j-1})}{2\Delta x} - \frac{1}{6}\frac{\partial^3 u}{\partial x^3}(x_j)\Delta x^2 + \mathcal{O}\left(\frac{||\Delta x||^4}{2}\right)$$

Final numerical solution:
$$-\mu\frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2} + \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} = f_j$$

$$\sim \mathcal{O}(\Delta x^2)$$

### 3.2 例子
$$
\begin{align}
-\mu\frac{\partial^2 u}{\partial x^2} + \beta\frac{\partial u}{\partial x} &= 0 \\
u(0) &= 0 \\
u(a) &= 1
\end{align}
$$

$$u_{ex} = \frac{e^{\frac{\beta}{\mu}x} - 1}{e^{\frac{\beta}{\mu}} - 1}$$

$$\frac{|\beta|}{\mu} >> 1 : \text{convection dominated problem}$$

Numerical experiment shows that when $|\beta|$ is large, the numerical solution will not be consistent anymore. What's wrong?

#### Mathematical Explanation:
$$-\mu\frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2} + \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} = 0$$

$$\left(-\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)u_{i+1} + \left(\frac{2\mu}{\Delta x^2}\right)u_i - \left(\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)u_{i-1} = 0$$

Difference equation: guess solution: $u_j = C\rho^j$.

Then,
$$\left(-\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)C\rho^{j+1} + \left(\frac{2\mu}{\Delta x^2}\right)C\rho^j - \left(\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)C\rho^{j-1} = 0$$

$$\left(-\frac{\mu}{\Delta x^2} + \frac{\beta}{\Delta x}\right)\rho^2 + \left(\frac{2\mu}{\Delta x^2}\right)\rho - \left(\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right) = 0$$

We can find $\rho_1$ and $\rho_2$ from this equation. Then,
$$u_j = C_1\rho_1 + C_2\rho_2 \quad \text{linear combination}$$

Note $\rho_1, \rho_2$ are solutions.

$$\rho_1\rho_2 = \frac{-\left(\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)}{\left(-\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)} = \frac{1 + \frac{\beta\Delta x}{2\mu}}{1 - \frac{\beta\Delta x}{2\mu}}$$

Péclet, Pe:

If $\frac{|\beta|\Delta x}{2\mu} > 1$, $\rho_1\rho_2 < 0$, and then we have oscillating solutions.

### 3.3 Another Method: Upwind Method

Information flow

Our previous computation relies on symmetry. However, there is a clear physical information flow. So, this problem is asymmetric in reality. We don't want as fancy as $\sim \mathcal{O}(\Delta x^2)$ solutions, but we can use a $\sim \mathcal{O}(\Delta x)$ method.

$$\beta\frac{\partial u}{\partial x} \approx \beta\frac{u_i - u_{i-1}}{\Delta x} \quad (\beta > 0) \quad \text{(upwind)}$$

Now, let's show (upwind) is stable.

$$\beta\frac{u_i - u_{i-1}}{\Delta x} = \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} - \beta\frac{u_{i+1}}{2\Delta x} - \beta\frac{2u_i}{2\Delta x} + \beta\frac{u_{i-1}}{2\Delta x}$$

$$= \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} - \frac{\beta\Delta x}{2} \cdot \frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2}$$

Central mean $\quad$ Approx. of 2nd derivative

So, we can consider the equation:
$$-\left(\mu + \frac{|\beta|\Delta x}{2}\right)\frac{\partial^2 u}{\partial x^2} + \beta\frac{\partial u}{\partial x} = 0$$

Apply a central approximation:
$$-\mu\frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2} + \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} = 0$$

Upwind solution of the original problem.

Central (Perturbed) = Upwind (Original).

Recall Péclet: $Pe = \frac{|\beta|\Delta x}{2\mu}$. Then, $\mu^* = \mu(1 + Pe)$.

Péclet of this perturbed system:
$$Pe^* = \frac{|\beta|\Delta x}{2\mu^*} = \frac{|\beta|\Delta x}{2\mu(1+Pe)} = \frac{Pe}{1+Pe} < 1 \quad \forall |\beta| \text{ and } \Delta x$$

So, this upwind method is always stable.

Consistency: when $\Delta x \to 0$, $\mu^* \to \mu$.

For the perturbed system, we have a 2nd order approach, but with the original problem, it is only a 1st order method.

### 3.4 Design a Better Method
$$\mu^{smart} = \mu(1 + \Phi(Pe))$$

s.t.
1. $\Phi(Pe) \to 0 \quad \text{as} \quad \Delta x \to 0$
2. $Pe^{smart} = \frac{|\beta|\Delta x}{2\mu^{smart}} < 1$

Our upwind method takes $\Phi(Pe) = Pe \sim \mathcal{O}(\Delta x)$. But can we take some $\Phi(Pe) \sim \mathcal{O}(\Delta x^2)$?

$\Rightarrow$ Scharfetter-Gummel Method: $\Phi(Pe) = Pe - 1 + \frac{2Pe}{e^{2Pe} - 1}$

$\Phi(Pe) \uparrow$

$\Phi(Pe) = Pe$

$\Phi(Pe) \sim \mathcal{O}(\Delta x)$

The worst case order of Scharfetter-Gummel is $\sim \mathcal{O}(\Delta x^2)$.

Scharfetter-Gummel is also a special $\Phi(Pe)$ that produces exact solutions.
