---
title: 积分计算
---

# Chapter 9: Computing Integrals

## 9.1.1 Introduction
In practice, how do we compute integral $\int_A f(x)dx$?

* In $\mathbb{R}^1$ (one-dimensional space): 
  $$\int_a^b f(x)dx = F(x)|_a^b = F(b) - F(a)$$
	* **FTC** (Fundamental Theorem of Calculus)

* In $\mathbb{R}^n$ (n-dimensional space): 
  * Reduce to $\mathbb{R}^1$ case by Fubini's Theorem
  * Change of Variables (Substitution) first

## 9.1.2 Fubini's Theorem

### 1. Statement of Main Result

**Theorem 1**: Let $A = \{(x,y): a \leq x \leq b, c \leq y \leq d\}$ be a rectangle in $\mathbb{R}^2$ and $f: A \to \mathbb{R}$ be integrable. Suppose, for each $x \in [a,b]$, the following integral exists:
$$g(x) = \int_c^d f(x,y)dy$$

Then $g(x)$ is integrable on $[a,b]$ and 
$\int_A f = \int_a^b \left(\int_c^d f(x,y)dy\right)dx = \int_a^b g(x)dx$

## 9.1.3 Corollaries

**Corollary 1**: If $f: A \to \mathbb{R}$ is continuous, then
$$\int_A f = \int_a^b \left(\int_c^d f(x,y)dy\right)dx = \int_c^d \left(\int_a^b f(x,y)dx\right)dy$$

This shows the symmetry of the double integral - we can integrate first with respect to $y$ and then with respect to $x$, or vice versa.

**Corollary 2**: Let $A$ be a region given by
$A = {(x,y): a \leq x \leq b, \varphi(x) \leq y \leq \psi(x)}$
where $\varphi(x)$ and $\psi(x)$ are continuous functions.
If $f: A \to \mathbb{R}$ is continuous, then
$\int_A f = \int_a^b \left(\int_{\varphi(x)}^{\psi(x)} f(x,y)dy\right)dx$

[Note: The image shows a graphical representation of region $A$ bounded by $y = \varphi(x)$ below and $y = \psi(x)$ above, with $x$ ranging from $a$ to $b$.]


### Remarks

Roles of $x$ and $y$ can be interchanged
Results true in higher dimensions

Let $C = A \times B \subset \mathbb{R}^{n+m}$
where $A \subset \mathbb{R}^n$, $B \subset \mathbb{R}^m$
[The image shows a diagram of the Cartesian product $A \times B$ as a rectangle in a coordinate system with axes labeled $\mathbb{R}^n$ and $\mathbb{R}^m$]
Then:
$\int_{A \times B} f = \int_A \left(\int_B f(x,y)dy\right)dx$


## 9.1.4 Example: Computing a Double Integral

### Problem
Compute $\int_A (x+y) \, dxdy$

Where $A$ is a triangle in the first quadrant bounded by the lines:
- $x = 0$ 
- $y = 0$
- $x + y = 1$

### Solution

Using Fubini's Theorem, we can compute this double integral as an iterated integral:

$$\int_A (x+y) \, dxdy = \int_0^1 \left(\int_0^{1-x} (x+y) \, dy\right) \, dx$$

First, we evaluate the inner integral with respect to $y$:

$$\int_0^{1-x} (x+y) \, dy = \left[xy + \frac{y^2}{2}\right]_{y=0}^{y=1-x}$$

$$= x(1-x) + \frac{(1-x)^2}{2} - \left(0 + 0\right)$$

$$= x - x^2 + \frac{1 - 2x + x^2}{2}$$

$$= x - x^2 + \frac{1}{2} - x + \frac{x^2}{2}$$

$$= \frac{1}{2} - \frac{x^2}{2}$$

Now we evaluate the outer integral with respect to $x$:

$$\int_0^1 \left(\frac{1}{2} - \frac{x^2}{2}\right) \, dx = \frac{1}{2}\int_0^1 (1 - x^2) \, dx$$

$$= \frac{1}{2}\left[x - \frac{x^3}{3}\right]_0^1$$

$$= \frac{1}{2}\left(1 - \frac{1}{3} - 0\right)$$

$$= \frac{1}{2} \cdot \frac{2}{3} = \frac{1}{3}$$

Therefore, $\int_A (x+y) \, dxdy = \frac{1}{3}$

**Note:** The calculation in the original blackboard image showed a final result of $\frac{1}{2}$, but the correct answer is $\frac{1}{3}$ as demonstrated in the steps above.

---

## 9.1.5 Proof of Theorem 1

I'll write out a concise proof for just the part shown in the image:

## 3. Proof of Theorem 1

Let $g(x) = \int_c^d f(x,y)dy$

We need to show:
1. $g$ is integrable on $[a,b]$
2. $\int_a^b g(x)dx = \int_A f$

We will compare upper and lower sums of $f$ and $g$.

Fix any partition $P_A$ of $A$. We can write $P_A = \{S_{ij}\}$ where $S_{ij} = V_i \times W_j$ represents rectangular cells in the partition.

Then $P_A$ induces:
- A partition of $[a,b]$: $P_{[a,b]} = \{V_i\}$
- A partition of $[c,d]$: $P_{[c,d]} = \{W_j\}$

For each cell $S_{ij}$, we define:
- $M_{ij} = \sup\{f(x,y): (x,y) \in S_{ij}\}$
- $m_{ij} = \inf\{f(x,y): (x,y) \in S_{ij}\}$

The upper and lower sums for $f$ over partition $P_A$ are:
- $U(f, P_A) = \sum_{i,j} M_{ij}|V_i||W_j|$
- $L(f, P_A) = \sum_{i,j} m_{ij}|V_i||W_j|$

When we consider the integrable function $g(x)$, we can establish that:
$L(f, P_A) \leq \int_a^b g(x)dx \leq U(f, P_A)$

As we refine the partition, the upper and lower sums converge, proving that $g$ is integrable on $[a,b]$ and that $\int_a^b g(x)dx = \int_A f$.

I'll continue the proof based on the additional image:

I'll rewrite the proof using proper display math formatting with `$$` delimiters:

Next, examine the lower sum $L(f, P_A)$:

$$L(f, P_A) = \sum_{i,j} m_{ij}(f) \cdot V(S_{ij})$$

$$= \sum_{i,j} m_{ij}(f) \cdot V(V_i) \cdot V(W_j)$$

Where $m_{ij}(f) = \inf\{f(x,y): (x,y) \in S_{ij}\}$

**Key Observation**: 
$$\inf\{f(x,y): (x,y) \in V_i \times W_j\} \leq \inf\{f(x,y): y \in W_j\} \text{ for all } x \in V_i$$
$$= m_j(f, x)$$

Then for any $x \in [a,b]$, we have:
$$\sum_j m_j(f) \cdot V(W_j) \leq \sum_j m_j(f,x) \cdot V(W_j)$$

This is the lower sum of $f(x,y)$ in the variable $y$ with partition $P_{[c,d]}$:
$$= L(f(x,·), P_{[c,d]})$$
$$\leq \int_c^d f(x,y)dy = g(x) \text{ for all } x$$

Thus:
$$\sum_i \left(\sum_j m_j(f) \cdot V(W_j)\right) \cdot V(V_i) \leq \sum_i \inf(g(x)) \cdot V(V_i)$$

i.e., 
$$\sum_{i,j} m_{ij}(f) \cdot V(W_j) \cdot V(V_i) \leq \sum_i (\inf g(x)) \cdot V(V_i)$$

Therefore: 
$$L(f, P_A) \leq L(g, P_{[a,b]})$$

Similarly, we have:

$$U(f, P_A) \geq U(g, P_{[a,b]})$$

Thus we have:

$$L(f, P_A) \leq L(g, P_{[a,b]}) \leq U(g, P_{[a,b]}) \leq U(f, P_A)$$

By Riemann's criterion, if $f$ is integrable on $A$, then:
1. $g$ is integrable on $[a,b]$, and
2. $$\int_A f = \int_a^b g(x)dx$$

This completes the proof of Fubini's Theorem, showing that we can compute a double integral by first integrating with respect to one variable and then with respect to the other.