---
title: 9.3 对流-扩散方程
weight: "9.3"
---

## 3.1 对流-扩散方程

对流-扩散方程是一种描述物质或热量在流体中同时受到对流（也称为平流）和扩散作用影响的偏微分方程。这个方程在流体力学、传热学和物质传输等领域有广泛应用。

$$
\begin{align}
-\mu\frac{\partial^2 u}{\partial x^2} + \beta\frac{\partial u}{\partial x} &= f \\
\text{diffusion} \quad & \text{advection}
\end{align}
$$

$$u(0) = u_L, \quad u(1) = u_R$$

### 3.1.1 离散化过程：

#### 一阶导数：对流项 （Advection）
##### 泰勒展开（向前）

$$
\begin{align}


u(x_{j+1})  & = u(x_j) + \frac{\partial u}{\partial x}(x_j)\Delta x + \frac{1}{2}\frac{\partial^2 u}{\partial x^2}(x_j)\Delta x^2  \\ 
&\quad\quad\quad\quad-\frac{1}{6}\frac{\partial^3 u}{\partial x^3}(x_j)\Delta x^3 + \frac{1}{12}\frac{\partial^4 u}{\partial x^4}(x_j)\Delta x^4 + \mathcal{O}(||x||^5)\\
\frac{\partial u}{\partial x}(x_j)\Delta x  & = u(x_{j+1}) - u(x_j) + \frac{1}{2}\frac{\partial^2 u}{\partial x^2}(x_j)\Delta x^2\\
\frac{\partial u}{\partial x}(x_j)  & = \frac{u_{j+1} - u_j}{\Delta x} + \frac{1}{2}\frac{\partial^2 u}{\partial x^2}(x_j)\Delta x
\end{align}$$

##### 泰勒展开（向后）

$$u(x_{j-1}) = u(x_j) - \frac{\partial u}{\partial x}(x_j)\Delta x + \frac{1}{2}\frac{\partial^2 u}{\partial x^2}(x_j)\Delta x^2 - \frac{1}{6}\frac{\partial^3 u}{\partial x^3}(x_j)\Delta x^3 + \frac{1}{12}\frac{\partial^4 u}{\partial x^4}(x_j)\Delta x^4 + \mathcal{O}(||x||^5)$$

我们取(forward) - (backward)两者差值

$$u(x_{j+1}) - u(x_{j-1}) = 2\frac{\partial u}{\partial x}(x_j)\Delta x + \frac{1}{3}\frac{\partial^3 u}{\partial x^3}(x_j)\Delta x^3 + \mathcal{O}(||\Delta x||^5)$$

接着

$$\frac{\partial u}{\partial x}(x_j) = \frac{u(x_{j+1}) - u(x_{j-1})}{2\Delta x} - \frac{1}{6}\frac{\partial^3 u}{\partial x^3}(x_j)\Delta x^2 + \mathcal{O}\left(\frac{||\Delta x||^4}{2}\right)$$



#### 二阶导数：扩散项（Diffusion）

这都还不会吗？退群吧。


#### 对流-扩散离散方程

> [!claim|*]
> Final numerical solution:
> $$-\mu\frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2} + \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} = f_j$$
> with second-order accuracy: $$\sim \mathcal{O}(\Delta x^2)$$



## 3.2 例子：精确解与数值解在对流主导问题中的差异

我们现在考虑一个特殊情况的对流-扩散方程，其中源项（Source Term）为零，具有以下边界条件：

$$
\begin{align}
-\mu\frac{\partial^2 u}{\partial x^2} + \beta\frac{\partial u}{\partial x} &= 0 \\
u(0) &= 0 \\
u(a) &= 1
\end{align}
$$

### 3.2.1 精确解

这个方程的精确解是：

$$u_{ex} = \frac{e^{\frac{\beta}{\mu}x} - 1}{e^{\frac{\beta}{\mu}a} - 1}$$

这个解的特点是：当比值 $\frac{|\beta|}{\mu} \gg 1$ 时（即advection远大于diffusion），解在边界 $x=a$ 附近会形成一个陡峭的边界层。这被称为**"对流主导问题"（advection-dominated problem）**。

在对流主导的情况下，解在大部分区域接近于0，只在接近 $x=a$ 的小区域内快速上升到1。这对数值方法的解法是很大的麻烦。

### 3.2.2 数值解

当我们使用标准的中心差分（central difference）方法离散化这个方程时：

$$-\mu\frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2} + \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} = 0$$

重新整理这个方程：

$$\left(-\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)u_{i+1} + \left(\frac{2\mu}{\Delta x^2}\right)u_i - \left(\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)u_{i-1} = 0$$

数值实验表明，当 $|\beta|$ 较大时，数值解会出现**不一致，非物理的振荡**。为什么呢？

#### 数学解释

为了理解这一现象，我们可以对差分方程进行深入分析。我们假设差分方程的解具有形式 $u_j = C\rho^j$，其中 $C$ 是常数，$\rho$ 是待定参数。将这个假设代入到差分方程中：

$$\left(-\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)C\rho^{j+1} + \left(\frac{2\mu}{\Delta x^2}\right)C\rho^j - \left(\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)C\rho^{j-1} = 0$$

消去 $C$ 并整理：

$$\left(-\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)\rho^2 + \left(\frac{2\mu}{\Delta x^2}\right)\rho - \left(\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right) = 0$$

这是关于 $\rho$ 的二次方程，它有两个解 $\rho_1$ 和 $\rho_2$。差分方程的一般解是这两个特解的线性组合：

$$u_j = C_1\rho_1^j + C_2\rho_2^j$$

其中 $C_1$ 和 $C_2$ 是由边界条件确定的常数。

#### 振荡解的条件

根据二次方程的性质，两个根的乘积等于常数项与二次项系数的比值：

$$\rho_1\rho_2 = \frac{-\left(\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)}{\left(-\frac{\mu}{\Delta x^2} + \frac{\beta}{2\Delta x}\right)} = \frac{1 + \frac{\beta\Delta x}{2\mu}}{1 - \frac{\beta\Delta x}{2\mu}}$$

这里引入了一个重要的无量纲参数，称为网格佩克莱数（Grid Péclet number）：

$$\text{Pe} = \frac{|\beta|\Delta x}{2\mu}$$

佩克莱数表示对流传输与扩散传输的相对强度。

当 $\text{Pe} > 1$（即 $\frac{|\beta|\Delta x}{2\mu} > 1$）时，我们有 $\rho_1\rho_2 < 0$，这意味着两个根一正一负。当一个解包含负的幂时，会导致解在空间上呈现振荡特性，这与物理直觉相违背，因为扩散过程应该是平滑的。

### 物理解释与改进方法

#### 为什么会出现振荡？

物理角度看：信息主要沿着流动方向传播。Central Difference 方法对上游和下游的信息给予**相同权重**，所以对流主导的情况下不合适，除非极细的网格才能准确解析。即使数值方法在数学上具有二阶精度，其准确度依旧是要取决于特定的物理问题中。理解数值方法的稳定性条件才可以选择合适的求解策略。

#### 解决方案？

1. **网格细化**：最直接的方法是减小 $\Delta x$，使 $\text{Pe} < 1$。但这会大大增加计算成本。

2. **迎风方法**：（详细见下文）使用偏向上游的差分格式，如前向或后向差分，取决于 $\beta$ 的符号。例如，当 $\beta > 0$ 时，可以使用：
   $$\frac{\partial u}{\partial x}(x_j) \approx \frac{u_j - u_{j-1}}{\Delta x}$$ 
3. **人工扩散**：增加一个数值扩散项，使有效的佩克莱数小于1。

4. **高阶格式**：使用更高阶的差分格式，如QUICK、TVD或ENO/WENO方案，这些方法可以更好地捕捉强梯度区域。


## 3.3  另一种方法：迎风法（Upwind Method）

### 3.3.1 信息流动分析 (Information Flow)

就像刚刚的对流主导问题，现实中经常存在明确的物理信息流动方向，使得这个问题本质上是**非对称的**。



对于对流项（advection），当流动方向已知时
> [!assumption|*]
>  $\beta > 0$，meaning that the information flows from left to right.

我们可以使用式子：

> [!claim|*]
> $$\beta\frac{\partial u}{\partial x} \approx \beta\frac{u_i - u_{i-1}}{\Delta x} \quad (\beta > 0) \quad \text{(upwind)}$$

这种差分格式考虑了信息流动的方向，使用"上游"的节点来计算导数，而不是像中心差分那样平等对待上下游节点（注意这个只有*一阶精度*）。

### 3.3.2 迎风法的稳定性分析 (Stability Analysis)

接下来，我们来证明迎风方法是稳定的。将迎风差分重写为：

$$\beta\frac{u_i - u_{i-1}}{\Delta x} = \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} - \beta\frac{u_{i+1}}{2\Delta x} - \beta\frac{2u_i}{2\Delta x} + \beta\frac{u_{i-1}}{2\Delta x}$$

整理一下上式：

$$= \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} - \frac{\beta\Delta x}{2} \cdot \frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2}$$

这个表达式可以分解为两项：
- 中心差分项 (Central mean): $\beta\frac{u_{i+1} - u_{i-1}}{2\Delta x}$
- 二阶导数近似项 (Approximation of 2nd derivative): $-\frac{\beta\Delta x}{2} \cdot \frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2}$

这说明迎风方法等价于对原始方程进行中心差分，但增加了一个额外的扩散项（人工扩散，artificial diffusion）。

### 等价表述：扰动方程 (Perturbed Equation)

因此，我们可以将原始问题的迎风方法看作是下面这个扰动方程的中心差分解法：

$$-\left(\mu + \frac{|\beta|\Delta x}{2}\right)\frac{\partial^2 u}{\partial x^2} + \beta\frac{\partial u}{\partial x} = 0$$

对这个扰动方程应用中心差分近似：

$$-\mu\frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2} + \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} = 0$$

这正是原始问题的迎风解法。换句话说：
- 对扰动问题使用中心差分 (Central for Perturbed) = 对原始问题使用迎风差分 (Upwind for Original)

> [!claim|*]
> $$\text{Central (Perturbed) }= \text{Upwind (Original)}$$


这个等价关系揭示了迎风法的本质：它隐含地向原始方程中添加了一个**数值扩散项**。这个额外的扩散项是迎风法能够抑制数值振荡的关键原因。



### 佩克莱数分析 (Péclet Number Analysis)

回顾一下佩克莱数的定义：$\text{Pe} = \frac{|\beta|\Delta x}{2\mu}$。

对于扰动系统，扩散系数变为 $\mu^* = \mu + \frac{|\beta|\Delta x}{2} = \mu(1 + \text{Pe})$。

扰动系统的佩克莱数为：

$$\text{Pe}^* = \frac{|\beta|\Delta x}{2\mu^*} = \frac{|\beta|\Delta x}{2\mu(1+\text{Pe})} = \frac{\text{Pe}}{1+\text{Pe}} < 1 \quad \forall |\beta| \text{ 和 } \Delta x$$

这表明无论 $|\beta|$ 和 $\Delta x$ 的值如何，扰动系统的佩克莱数永远小于1，因此迎风方法始终是稳定的。

### 一致性分析 (Consistency Analysis)

当 $\Delta x \to 0$ 时，$\mu^* \to \mu$，扰动方程趋近于原始方程，这保证了方法的一致性。

对于扰动系统，我们使用了二阶精度的中心差分方法，但对于原始问题，由于引入了人工扩散项，它只是一阶精度的方法。

## 详细解释与物理意义

迎风方法的核心思想是考虑物理信息的传播方向。在流体流动中，当某点的特性（如温度、浓度）受到上游点的影响更大时，迎风方法使用上游点来计算导数，从而更好地反映物理现实。

从数值分析的角度看，迎风方法引入了"人工扩散"(artificial diffusion)，增强了数值方法的稳定性。这种人工扩散恰好能够抵消中心差分在高佩克莱数情况下产生的数值振荡。

然而，这种稳定性是以精度为代价的——迎风方法的精度降低到一阶（误差与 $\Delta x$ 成正比），而中心差分是二阶精度（误差与 $\Delta x^2$ 成正比）。这在数值方法中是一个常见的权衡：更高的稳定性往往伴随着更低的精度。

在对流主导的问题中，稳定性通常比高精度更重要，因为不稳定的解会产生严重的非物理振荡，使结果完全无用。因此，对于高佩克莱数流动，迎风方法尽管精度较低，但往往是更实用的选择。

更高阶的方法，如TVD (Total Variation Diminishing)、ENO (Essentially Non-Oscillatory) 和 WENO (Weighted Essentially Non-Oscillatory) 方案，试图在保持稳定性的同时提高精度，但它们的实现更为复杂。






Our previous computation relies on symmetry. However, there is a clear physical information flow. So, this problem is asymmetric in reality. We don't want as fancy as $\sim \mathcal{O}(\Delta x^2)$ solutions, but we can use a $\sim \mathcal{O}(\Delta x)$ method.

$$\beta\frac{\partial u}{\partial x} \approx \beta\frac{u_i - u_{i-1}}{\Delta x} \quad (\beta > 0) \quad \text{(upwind)}$$

Now, let's show (upwind) is stable.

$$\beta\frac{u_i - u_{i-1}}{\Delta x} = \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} - \beta\frac{u_{i+1}}{2\Delta x} - \beta\frac{2u_i}{2\Delta x} + \beta\frac{u_{i-1}}{2\Delta x}$$

$$= \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} - \frac{\beta\Delta x}{2} \cdot \frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2}$$

Central mean $\quad$ Approx. of 2nd derivative

So, we can consider the equation:
$$-\left(\mu + \frac{|\beta|\Delta x}{2}\right)\frac{\partial^2 u}{\partial x^2} + \beta\frac{\partial u}{\partial x} = 0$$

Apply a central approximation:
$$-\mu\frac{u_{i+1} - 2u_i + u_{i-1}}{\Delta x^2} + \beta\frac{u_{i+1} - u_{i-1}}{2\Delta x} = 0$$

Upwind solution of the original problem.



Recall Péclet: $Pe = \frac{|\beta|\Delta x}{2\mu}$. Then, $\mu^* = \mu(1 + Pe)$.

Péclet of this perturbed system:
$$Pe^* = \frac{|\beta|\Delta x}{2\mu^*} = \frac{|\beta|\Delta x}{2\mu(1+Pe)} = \frac{Pe}{1+Pe} < 1 \quad \forall |\beta| \text{ and } \Delta x$$

So, this upwind method is always stable.

Consistency: when $\Delta x \to 0$, $\mu^* \to \mu$.

For the perturbed system, we have a 2nd order approach, but with the original problem, it is only a 1st order method.

### 3.4 Design a Better Method
$$\mu^{smart} = \mu(1 + \Phi(Pe))$$

s.t.
1. $\Phi(Pe) \to 0 \quad \text{as} \quad \Delta x \to 0$
2. $Pe^{smart} = \frac{|\beta|\Delta x}{2\mu^{smart}} < 1$

Our upwind method takes $\Phi(Pe) = Pe \sim \mathcal{O}(\Delta x)$. But can we take some $\Phi(Pe) \sim \mathcal{O}(\Delta x^2)$?

$\Rightarrow$ Scharfetter-Gummel Method: $\Phi(Pe) = Pe - 1 + \frac{2Pe}{e^{2Pe} - 1}$

$\Phi(Pe) \uparrow$

$\Phi(Pe) = Pe$

$\Phi(Pe) \sim \mathcal{O}(\Delta x)$

The worst case order of Scharfetter-Gummel is $\sim \mathcal{O}(\Delta x^2)$.

Scharfetter-Gummel is also a special $\Phi(Pe)$ that produces exact solutions.
